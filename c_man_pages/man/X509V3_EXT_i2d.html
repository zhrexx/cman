<!-- Creator     : groff version 1.23.0 -->
<!-- CreationDate: Sat Apr  5 20:53:10 2025 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">

<html>
<head>
<meta content="groff -Thtml, see www.gnu.org" name="generator"/>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<meta content="text/css" name="Content-Style"/>
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title>X509V3_GET_D2I</title>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/><style>
            :root {
                --primary-color: #3498db;
                --background-color: #f9f9f9;
                --text-color: #333;
                --code-bg: #f0f0f0;
                --header-color: #2c3e50;
                --link-color: #2980b9;
            }
            body {
                font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
                line-height: 1.6;
                color: var(--text-color);
                background-color: var(--background-color);
                max-width: 900px;
                margin: 0 auto;
                padding: 2rem;
            }
            h1, h2, h3, h4 {
                color: var(--header-color);
            }
            h1 {
                border-bottom: 2px solid var(--primary-color);
                padding-bottom: 0.5rem;
            }
            pre {
                background-color: var(--code-bg);
                padding: 1rem;
                border-radius: 4px;
                overflow-x: auto;
            }
            a {
                color: var(--link-color);
                text-decoration: none;
            }
            a:hover {
                text-decoration: underline;
            }
            .man-navigation {
                background-color: #fff;
                border-bottom: 1px solid #ddd;
                padding: 0.5rem 0;
                position: sticky;
                top: 0;
                z-index: 100;
            }
            .section {
                margin-top: 2rem;
            }
            @media (prefers-color-scheme: dark) {
                :root {
                    --primary-color: #3498db;
                    --background-color: #222;
                    --text-color: #f0f0f0;
                    --code-bg: #333;
                    --header-color: #3498db;
                    --link-color: #5dade2;
                }
            }
            .back-to-index {
                display: inline-block;
                margin: 1rem 0;
                padding: 0.5rem 1rem;
                background-color: var(--primary-color);
                color: white;
                border-radius: 4px;
                text-decoration: none;
            }
            .back-to-index:hover {
                background-color: var(--link-color);
                text-decoration: none;
            }
        </style></head>
<body><div><a class="back-to-index" href="../index.html">← Back to Index</a></div>
<h1 align="center">X509V3_GET_D2I</h1>
<a href="#NAME">NAME</a><br/>
<a href="#SYNOPSIS">SYNOPSIS</a><br/>
<a href="#DESCRIPTION">DESCRIPTION</a><br/>
<a href="#NOTES">NOTES</a><br/>
<a href="#SUPPORTED EXTENSIONS">SUPPORTED EXTENSIONS</a><br/>
<a href="#PKIX Certificate Extensions">PKIX Certificate Extensions</a><br/>
<a href="#Netscape Certificate Extensions">Netscape Certificate Extensions</a><br/>
<a href="#Miscellaneous Certificate Extensions">Miscellaneous Certificate Extensions</a><br/>
<a href="#PKIX CRL Extensions">PKIX CRL Extensions</a><br/>
<a href="#OCSP Extensions">OCSP Extensions</a><br/>
<a href="#Certificate Transparency Extensions">Certificate Transparency Extensions</a><br/>
<a href="#RETURN VALUES">RETURN VALUES</a><br/>
<a href="#SEE ALSO">SEE ALSO</a><br/>
<a href="#COPYRIGHT">COPYRIGHT</a><br/>
<hr/>
<h2>NAME
<a name="NAME"></a>
</h2>
<p style="margin-left:9%; margin-top: 1em">X509V3_get_d2i,
X509V3_add1_i2d, X509V3_EXT_d2i, X509V3_EXT_i2d,
X509_get_ext_d2i, X509_add1_ext_i2d, X509_CRL_get_ext_d2i,
X509_CRL_add1_ext_i2d, X509_REVOKED_get_ext_d2i,
X509_REVOKED_add1_ext_i2d, X509_get0_extensions,
X509_CRL_get0_extensions, X509_REVOKED_get0_extensions
− X509 extension decode and encode functions</p>
<h2>SYNOPSIS
<a name="SYNOPSIS"></a>
</h2>
<p style="margin-left:9%; margin-top: 1em">#include
&lt;openssl/x509v3.h&gt; <br/>
void *X509V3_get_d2i(const STACK_OF(X509_EXTENSION) *x, int
nid, int *crit, <br/>
int *idx); <br/>
int X509V3_add1_i2d(STACK_OF(X509_EXTENSION) **x, int nid,
void *value, <br/>
int crit, unsigned long flags); <br/>
void *X509V3_EXT_d2i(X509_EXTENSION *ext); <br/>
X509_EXTENSION *X509V3_EXT_i2d(int ext_nid, int crit, void
*ext_struc); <br/>
void *X509_get_ext_d2i(const X509 *x, int nid, int *crit,
int *idx); <br/>
int X509_add1_ext_i2d(X509 *x, int nid, void *value, int
crit, <br/>
unsigned long flags); <br/>
void *X509_CRL_get_ext_d2i(const X509_CRL *crl, int nid, int
*crit, int *idx); <br/>
int X509_CRL_add1_ext_i2d(X509_CRL *crl, int nid, void
*value, int crit, <br/>
unsigned long flags); <br/>
void *X509_REVOKED_get_ext_d2i(const X509_REVOKED *r, int
nid, int *crit, int *idx); <br/>
int X509_REVOKED_add1_ext_i2d(X509_REVOKED *r, int nid, void
*value, int crit, <br/>
unsigned long flags); <br/>
const STACK_OF(X509_EXTENSION) *X509_get0_extensions(const
X509 *x); <br/>
const STACK_OF(X509_EXTENSION)
*X509_CRL_get0_extensions(const X509_CRL *crl); <br/>
const STACK_OF(X509_EXTENSION)
*X509_REVOKED_get0_extensions(const X509_REVOKED *r);</p>
<h2>DESCRIPTION
<a name="DESCRIPTION"></a>
</h2>
<p style="margin-left:9%; margin-top: 1em"><b>X509V3_get_d2i()</b>
looks for an extension with OID <i>nid</i> in the extensions
<i>x</i> and, if found, decodes it. If <i>idx</i> is NULL
then only one occurrence of an extension is permissible,
otherwise the first extension after index <i>*idx</i> is
returned and <i>*idx</i> updated to the location of the
extension. If <i>crit</i> is not NULL then <i>*crit</i> is
set to a status value: −2 if the extension occurs
multiple times (this is only returned if <i>idx</i> is
NULL), −1 if the extension could not be found, 0 if
the extension is found and is not critical and 1 if
critical. A pointer to an extension specific structure or
NULL is returned.</p>
<p style="margin-left:9%; margin-top: 1em"><b>X509V3_add1_i2d()</b>
adds extension <i>value</i> to STACK <i>*x</i> (allocating a
new STACK if necessary) using OID <i>nid</i> and criticality
<i>crit</i> according to <i>flags</i>.</p>
<p style="margin-left:9%; margin-top: 1em"><b>X509V3_EXT_d2i()</b>
attempts to decode the ASN.1 data contained in extension
<i>ext</i> and returns a pointer to an extension specific
structure or NULL if the extension could not be decoded
(invalid syntax or not supported).</p>
<p style="margin-left:9%; margin-top: 1em"><b>X509V3_EXT_i2d()</b>
encodes the extension specific structure <i>ext_struc</i>
with OID <i>ext_nid</i> and criticality <i>crit</i>.</p>
<p style="margin-left:9%; margin-top: 1em"><b>X509_get_ext_d2i()</b>
and <b>X509_add1_ext_i2d()</b> operate on the extensions of
certificate <i>x</i>. They are otherwise identical to
<b>X509V3_get_d2i()</b> and <b>X509V3_add1_i2d()</b>.</p>
<p style="margin-left:9%; margin-top: 1em"><b>X509_CRL_get_ext_d2i()</b>
and <b>X509_CRL_add1_ext_i2d()</b> operate on the extensions
of CRL <i>crl</i>. They are otherwise identical to
<b>X509V3_get_d2i()</b> and <b>X509V3_add1_i2d()</b>.</p>
<p style="margin-left:9%; margin-top: 1em"><b>X509_REVOKED_get_ext_d2i()</b>
and <b>X509_REVOKED_add1_ext_i2d()</b> operate on the
extensions of <b>X509_REVOKED</b> structure <i>r</i> (i.e
for CRL entry extensions). They are otherwise identical to
<b>X509V3_get_d2i()</b> and <b>X509V3_add1_i2d()</b>.</p>
<p style="margin-left:9%; margin-top: 1em"><b>X509_get0_extensions()</b>,
<b>X509_CRL_get0_extensions()</b> and
<b>X509_REVOKED_get0_extensions()</b> return a STACK of all
the extensions of a certificate, a CRL or a CRL entry
respectively.</p>
<h2>NOTES
<a name="NOTES"></a>
</h2>
<p style="margin-left:9%; margin-top: 1em">In almost all
cases an extension can occur at most once and multiple
occurrences is an error. Therefore, the <i>idx</i> parameter
is usually NULL.</p>
<p style="margin-left:9%; margin-top: 1em">The <i>flags</i>
parameter may be one of the following values.</p>
<p style="margin-left:9%; margin-top: 1em"><b>X509V3_ADD_DEFAULT</b>
appends a new extension only if the extension does not
exist. An error is returned if the extension exists.</p>
<p style="margin-left:9%; margin-top: 1em"><b>X509V3_ADD_APPEND</b>
appends a new extension, ignoring whether the extension
exists.</p>
<p style="margin-left:9%; margin-top: 1em"><b>X509V3_ADD_REPLACE</b>
replaces an existing extension. If the extension does not
exist, appends a new extension.</p>
<p style="margin-left:9%; margin-top: 1em"><b>X509V3_ADD_REPLACE_EXISTING</b>
replaces an existing extension. If the extension does not
exist, returns an error.</p>
<p style="margin-left:9%; margin-top: 1em"><b>X509V3_ADD_KEEP_EXISTING</b>
appends a new extension only if the extension does not
exist. An error is <b>not</b> returned if the extension
exists.</p>
<p style="margin-left:9%; margin-top: 1em"><b>X509V3_ADD_DELETE</b>
deletes and frees an existing extension. If the extension
does not exist, returns an error. No new extension is
added.</p>
<p style="margin-left:9%; margin-top: 1em">If
<b>X509V3_ADD_SILENT</b> is bitwise ORed with <i>flags</i>:
any error returned will not be added to the error queue.</p>
<p style="margin-left:9%; margin-top: 1em">The function
<b>X509V3_get_d2i()</b> and its variants will return NULL if
the extension is not found, occurs multiple times or cannot
be decoded. It is possible to determine the precise reason
by checking the value of <i>*crit</i>. The returned pointer
must be explicitly freed.</p>
<p style="margin-left:9%; margin-top: 1em">The function
<b>X509V3_add1_i2d()</b> and its variants allocate
<b>X509_EXTENSION</b> objects on STACK <i>*x</i> depending
on <i>flags</i>. The <b>X509_EXTENSION</b> objects must be
explicitly freed using <b>X509_EXTENSION_free()</b>.</p>
<h2>SUPPORTED EXTENSIONS
<a name="SUPPORTED EXTENSIONS"></a>
</h2>
<p style="margin-left:9%; margin-top: 1em">The following
sections contain a list of all supported extensions
including their name and NID.</p>
<h3>PKIX Certificate Extensions
<a name="PKIX Certificate Extensions"></a>
</h3>
<p style="margin-left:9%; margin-top: 1em">The following
certificate extensions are defined in PKIX standards such as
RFC5280.</p>
<p style="margin-left:9%; margin-top: 1em">Basic
Constraints NID_basic_constraints <br/>
Key Usage NID_key_usage <br/>
Extended Key Usage NID_ext_key_usage <br/>
Subject Key Identifier NID_subject_key_identifier <br/>
Authority Key Identifier NID_authority_key_identifier <br/>
Private Key Usage Period NID_private_key_usage_period <br/>
Subject Alternative Name NID_subject_alt_name <br/>
Issuer Alternative Name NID_issuer_alt_name <br/>
Authority Information Access NID_info_access <br/>
Subject Information Access NID_sinfo_access <br/>
Name Constraints NID_name_constraints <br/>
Certificate Policies NID_certificate_policies <br/>
Policy Mappings NID_policy_mappings <br/>
Policy Constraints NID_policy_constraints <br/>
Inhibit Any Policy NID_inhibit_any_policy <br/>
TLS Feature NID_tlsfeature</p>
<h3>Netscape Certificate Extensions
<a name="Netscape Certificate Extensions"></a>
</h3>
<p style="margin-left:9%; margin-top: 1em">The following
are (largely obsolete) Netscape certificate extensions.</p>
<p style="margin-left:9%; margin-top: 1em">Netscape Cert
Type NID_netscape_cert_type <br/>
Netscape Base Url NID_netscape_base_url <br/>
Netscape Revocation Url NID_netscape_revocation_url <br/>
Netscape CA Revocation Url NID_netscape_ca_revocation_url
<br/>
Netscape Renewal Url NID_netscape_renewal_url <br/>
Netscape CA Policy Url NID_netscape_ca_policy_url <br/>
Netscape SSL Server Name NID_netscape_ssl_server_name <br/>
Netscape Comment NID_netscape_comment</p>
<h3>Miscellaneous Certificate Extensions
<a name="Miscellaneous Certificate Extensions"></a>
</h3>
<p style="margin-left:9%; margin-top: 1em">Strong Extranet
ID NID_sxnet <br/>
Proxy Certificate Information NID_proxyCertInfo</p>
<h3>PKIX CRL Extensions
<a name="PKIX CRL Extensions"></a>
</h3>
<p style="margin-left:9%; margin-top: 1em">The following
are CRL extensions from PKIX standards such as RFC5280.</p>
<p style="margin-left:9%; margin-top: 1em">CRL Number
NID_crl_number <br/>
CRL Distribution Points NID_crl_distribution_points <br/>
Delta CRL Indicator NID_delta_crl <br/>
Freshest CRL NID_freshest_crl <br/>
Invalidity Date NID_invalidity_date <br/>
Issuing Distribution Point
NID_issuing_distribution_point</p>
<p style="margin-left:9%; margin-top: 1em">The following
are CRL entry extensions from PKIX standards such as
RFC5280.</p>
<p style="margin-left:9%; margin-top: 1em">CRL Reason Code
NID_crl_reason <br/>
Certificate Issuer NID_certificate_issuer</p>
<h3>OCSP Extensions
<a name="OCSP Extensions"></a>
</h3>
<p style="margin-left:9%; margin-top: 1em">OCSP Nonce
NID_id_pkix_OCSP_Nonce <br/>
OCSP CRL ID NID_id_pkix_OCSP_CrlID <br/>
Acceptable OCSP Responses
NID_id_pkix_OCSP_acceptableResponses <br/>
OCSP No Check NID_id_pkix_OCSP_noCheck <br/>
OCSP Archive Cutoff NID_id_pkix_OCSP_archiveCutoff <br/>
OCSP Service Locator NID_id_pkix_OCSP_serviceLocator <br/>
Hold Instruction Code NID_hold_instruction_code</p>
<h3>Certificate Transparency Extensions
<a name="Certificate Transparency Extensions"></a>
</h3>
<p style="margin-left:9%; margin-top: 1em">The following
extensions are used by certificate transparency, RFC6962</p>
<p style="margin-left:9%; margin-top: 1em">CT
Precertificate SCTs NID_ct_precert_scts <br/>
CT Certificate SCTs NID_ct_cert_scts</p>
<h2>RETURN VALUES
<a name="RETURN VALUES"></a>
</h2>
<p style="margin-left:9%; margin-top: 1em"><b>X509V3_get_d2i()</b>,
its variants, and <b>X509V3_EXT_d2i()</b> return a pointer
to an extension specific structure or NULL if an error
occurs.</p>
<p style="margin-left:9%; margin-top: 1em"><b>X509V3_add1_i2d()</b>
and its variants return 1 if the operation is successful and
0 if it fails due to a non−fatal error (extension not
found, already exists, cannot be encoded) or −1 due to
a fatal error such as a memory allocation failure.</p>
<p style="margin-left:9%; margin-top: 1em"><b>X509V3_EXT_i2d()</b>
returns a pointer to an <b>X509_EXTENSION</b> structure or
NULL if an error occurs.</p>
<p style="margin-left:9%; margin-top: 1em"><b>X509_get0_extensions()</b>,
<b>X509_CRL_get0_extensions()</b> and
<b>X509_REVOKED_get0_extensions()</b> return a stack of
extensions. They return NULL if no extensions are
present.</p>
<h2>SEE ALSO
<a name="SEE ALSO"></a>
</h2>
<p style="margin-left:9%; margin-top: 1em"><b>d2i_X509</b>(3),
<b>ERR_get_error</b>(3), <b>X509_CRL_get0_by_serial</b>(3),
<b>X509_get0_signature</b>(3), <b>X509_get_ext_d2i</b>(3),
<b>X509_get_extension_flags</b>(3),
<b>X509_get_pubkey</b>(3), <b>X509_get_subject_name</b>(3),
<b>X509_get_version</b>(3),
<b>X509_NAME_add_entry_by_txt</b>(3),
<b>X509_NAME_ENTRY_get_object</b>(3),
<b>X509_NAME_get_index_by_NID</b>(3),
<b>X509_NAME_print_ex</b>(3), <b>X509_new</b>(3),
<b>X509_sign</b>(3), <b>X509_verify_cert</b>(3)</p>
<h2>COPYRIGHT
<a name="COPYRIGHT"></a>
</h2>
<p style="margin-left:9%; margin-top: 1em">Copyright
2015−2024 The OpenSSL Project Authors. All Rights
Reserved.</p>
<p style="margin-left:9%; margin-top: 1em">Licensed under
the Apache License 2.0 (the "License"). You may
not use this file except in compliance with the License. You
can obtain a copy in the file LICENSE in the source
distribution or at
&lt;https://www.openssl.org/source/license.html&gt;.</p>
<hr/>
</body>
</html>
