<!-- Creator     : groff version 1.23.0 -->
<!-- CreationDate: Sat Apr  5 20:43:51 2025 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">

<html>
<head>
<meta content="groff -Thtml, see www.gnu.org" name="generator"/>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<meta content="text/css" name="Content-Style"/>
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title>getcon</title>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/><style>
            :root {
                --primary-color: #3498db;
                --background-color: #f9f9f9;
                --text-color: #333;
                --code-bg: #f0f0f0;
                --header-color: #2c3e50;
                --link-color: #2980b9;
            }
            body {
                font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
                line-height: 1.6;
                color: var(--text-color);
                background-color: var(--background-color);
                max-width: 900px;
                margin: 0 auto;
                padding: 2rem;
            }
            h1, h2, h3, h4 {
                color: var(--header-color);
            }
            h1 {
                border-bottom: 2px solid var(--primary-color);
                padding-bottom: 0.5rem;
            }
            pre {
                background-color: var(--code-bg);
                padding: 1rem;
                border-radius: 4px;
                overflow-x: auto;
            }
            a {
                color: var(--link-color);
                text-decoration: none;
            }
            a:hover {
                text-decoration: underline;
            }
            .man-navigation {
                background-color: #fff;
                border-bottom: 1px solid #ddd;
                padding: 0.5rem 0;
                position: sticky;
                top: 0;
                z-index: 100;
            }
            .section {
                margin-top: 2rem;
            }
            @media (prefers-color-scheme: dark) {
                :root {
                    --primary-color: #3498db;
                    --background-color: #222;
                    --text-color: #f0f0f0;
                    --code-bg: #333;
                    --header-color: #3498db;
                    --link-color: #5dade2;
                }
            }
            .back-to-index {
                display: inline-block;
                margin: 1rem 0;
                padding: 0.5rem 1rem;
                background-color: var(--primary-color);
                color: white;
                border-radius: 4px;
                text-decoration: none;
            }
            .back-to-index:hover {
                background-color: var(--link-color);
                text-decoration: none;
            }
        </style></head>
<body><div><a class="back-to-index" href="../index.html">← Back to Index</a></div>
<h1 align="center">getcon</h1>
<a href="#NAME">NAME</a><br/>
<a href="#SYNOPSIS">SYNOPSIS</a><br/>
<a href="#DESCRIPTION">DESCRIPTION</a><br/>
<a href="#RETURN VALUE">RETURN VALUE</a><br/>
<a href="#NOTES">NOTES</a><br/>
<a href="#SEE ALSO">SEE ALSO</a><br/>
<hr/>
<h2>NAME
<a name="NAME"></a>
</h2>
<p style="margin-left:9%; margin-top: 1em">getcon,
getprevcon, getpidcon − get SELinux security context
of a process</p>
<p style="margin-left:9%; margin-top: 1em">freecon,
freeconary − free memory associated with SELinux
security contexts</p>
<p style="margin-left:9%; margin-top: 1em">getpeercon
− get security context of a peer socket</p>
<p style="margin-left:9%; margin-top: 1em">setcon −
set current security context of a process</p>
<h2>SYNOPSIS
<a name="SYNOPSIS"></a>
</h2>
<p style="margin-left:9%; margin-top: 1em"><b>#include
&lt;selinux/selinux.h&gt;</b></p>
<p style="margin-left:9%; margin-top: 1em"><b>int
getcon(char **</b><i>context</i><b>);</b></p>
<p style="margin-left:9%; margin-top: 1em"><b>int
getcon_raw(char **</b><i>context</i><b>);</b></p>
<p style="margin-left:9%; margin-top: 1em"><b>int
getprevcon(char **</b><i>context</i><b>);</b></p>
<p style="margin-left:9%; margin-top: 1em"><b>int
getprevcon_raw(char **</b><i>context</i><b>);</b></p>
<p style="margin-left:9%; margin-top: 1em"><b>int
getpidcon(pid_t</b> <i>pid</i><b>, char
**</b><i>context</i><b>);</b></p>
<p style="margin-left:9%; margin-top: 1em"><b>int
getpidcon_raw(pid_t</b> <i>pid</i><b>, char
**</b><i>context</i><b>);</b></p>
<p style="margin-left:9%; margin-top: 1em"><b>int
getpidprevcon(pid_t</b> <i>pid</i><b>, char
**</b><i>context</i><b>);</b></p>
<p style="margin-left:9%; margin-top: 1em"><b>int
getpidprevcon_raw(pid_t</b> <i>pid</i><b>, char
**</b><i>context</i><b>);</b></p>
<p style="margin-left:9%; margin-top: 1em"><b>int
getpeercon(int</b> <i>fd</i><b>, char
**</b><i>context</i><b>);</b></p>
<p style="margin-left:9%; margin-top: 1em"><b>int
getpeercon_raw(int</b> <i>fd</i><b>, char
**</b><i>context</i><b>);</b></p>
<p style="margin-left:9%; margin-top: 1em"><b>void
freecon(char *</b><i>con</i><b>);</b></p>
<p style="margin-left:9%; margin-top: 1em"><b>void
freeconary(char **</b><i>con</i><b>);</b></p>
<p style="margin-left:9%; margin-top: 1em"><b>int
setcon(const char *</b><i>context</i><b>);</b></p>
<p style="margin-left:9%; margin-top: 1em"><b>int
setcon_raw(const char *</b><i>context</i><b>);</b></p>
<h2>DESCRIPTION
<a name="DESCRIPTION"></a>
</h2>
<p style="margin-left:9%; margin-top: 1em"><b>getcon</b>()</p>
<p style="margin-left:18%;">retrieves the context of the
current process, which must be free’d with
<b>freecon</b>().</p>
<p style="margin-left:9%;"><b>getprevcon</b>()</p>
<p style="margin-left:18%;">same as getcon but gets the
context before the last exec.</p>
<p style="margin-left:9%;"><b>getpidcon</b>()</p>
<p style="margin-left:18%;">returns the process context for
the specified PID, which must be free’d with
<b>freecon</b>().</p>
<p style="margin-left:9%;"><b>getpidprevcon</b>()</p>
<p style="margin-left:18%;">returns the process context
before the last exec for the specified PID, which must be
free’d with <b>freecon</b>().</p>
<p style="margin-left:9%;"><b>getpeercon</b>()</p>
<p style="margin-left:18%;">retrieves the context of the
peer socket, which must be free’d with
<b>freecon</b>().</p>
<p style="margin-left:9%;"><b>freecon</b>()</p>
<p style="margin-left:18%;">frees the memory allocated for
a security context.</p>
<p style="margin-left:18%; margin-top: 1em">If <i>con</i>
is NULL, no operation is performed.</p>
<p style="margin-left:9%;"><b>freeconary</b>()</p>
<p style="margin-left:18%;">frees the memory allocated for
a context array.</p>
<p style="margin-left:18%; margin-top: 1em">If <i>con</i>
is NULL, no operation is performed.</p>
<p style="margin-left:9%;"><b>setcon</b>()</p>
<p style="margin-left:18%;">sets the current security
context of the process to a new value. Note that use of this
function requires that the entire application be trusted to
maintain any desired separation between the old and new
security contexts, unlike exec-based transitions performed
via <b>setexeccon</b>(3). When possible, decompose your
application and use <b>setexeccon</b>(3) and
<b>execve</b>(3) instead.</p>
<p style="margin-left:18%; margin-top: 1em">Since access to
file descriptors is revalidated upon use by SELinux, the new
context must be explicitly authorized in the policy to use
the descriptors opened by the old context if that is
desired. Otherwise, attempts by the process to use any
existing descriptors (including <i>stdin</i>, <i>stdout</i>,
and <i>stderr</i>) after performing the <b>setcon</b>() will
fail.</p>
<p style="margin-left:18%; margin-top: 1em">A
multi-threaded application can perform a <b>setcon</b>()
prior to creating any child threads, in which case all of
the child threads will inherit the new context. However,
prior to Linux 2.6.28, <b>setcon</b>() would fail if there
are any other threads running in the same process since this
would yield an inconsistency among the security contexts of
threads sharing the same memory space. Since Linux 2.6.28,
<b>setcon()</b> is permitted for threads within a
multi-threaded process if the new security context is
bounded by the old security context, where the bounded
relation is defined through typebounds statements in the
policy and guarantees that the new security context has a
subset of the permissions of the old security context.</p>
<p style="margin-left:18%; margin-top: 1em">If the process
was being ptraced at the time of the <b>setcon</b>()
operation, ptrace permission will be revalidated against the
new context and the <b>setcon</b>() will fail if it is not
allowed by policy.</p>
<p style="margin-left:9%;"><b>*_raw()</b></p>
<p style="margin-left:18%;"><b>getcon_raw</b>(),
<b>getprevcon_raw</b>(), <b>getpidcon_raw</b>(),
<b>getpidprevcon_raw</b>(), <b>getpeercon_raw</b>() and
<b>setcon_raw</b>() behave identically to their non-raw
counterparts but do not perform context translation.</p>
<h2>RETURN VALUE
<a name="RETURN VALUE"></a>
</h2>
<p style="margin-left:9%; margin-top: 1em">On error
−1 is returned with errno set. On success 0 is
returned.</p>
<h2>NOTES
<a name="NOTES"></a>
</h2>
<p style="margin-left:9%; margin-top: 1em">The retrieval
functions might return success and set <i>*context</i> to
NULL if and only if SELinux is not enabled.</p>
<p style="margin-left:9%; margin-top: 1em">Querying a
foreign process via its PID, e.g. <b>getpidcon</b>() or
<b>getpidprevcon</b>(), is inherently racy and therefore
should never be relied upon for security purposes.</p>
<h2>SEE ALSO
<a name="SEE ALSO"></a>
</h2>
<p style="margin-left:9%; margin-top: 1em"><b>selinux</b>(8),
<b>setexeccon</b>(3)</p>
<hr/>
</body>
</html>
