<!-- Creator     : groff version 1.23.0 -->
<!-- CreationDate: Sat Apr  5 20:45:42 2025 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">

<html>
<head>
<meta content="groff -Thtml, see www.gnu.org" name="generator"/>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<meta content="text/css" name="Content-Style"/>
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title>IO::Socket::SSL::Utils</title>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/><style>
            :root {
                --primary-color: #3498db;
                --background-color: #f9f9f9;
                --text-color: #333;
                --code-bg: #f0f0f0;
                --header-color: #2c3e50;
                --link-color: #2980b9;
            }
            body {
                font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
                line-height: 1.6;
                color: var(--text-color);
                background-color: var(--background-color);
                max-width: 900px;
                margin: 0 auto;
                padding: 2rem;
            }
            h1, h2, h3, h4 {
                color: var(--header-color);
            }
            h1 {
                border-bottom: 2px solid var(--primary-color);
                padding-bottom: 0.5rem;
            }
            pre {
                background-color: var(--code-bg);
                padding: 1rem;
                border-radius: 4px;
                overflow-x: auto;
            }
            a {
                color: var(--link-color);
                text-decoration: none;
            }
            a:hover {
                text-decoration: underline;
            }
            .man-navigation {
                background-color: #fff;
                border-bottom: 1px solid #ddd;
                padding: 0.5rem 0;
                position: sticky;
                top: 0;
                z-index: 100;
            }
            .section {
                margin-top: 2rem;
            }
            @media (prefers-color-scheme: dark) {
                :root {
                    --primary-color: #3498db;
                    --background-color: #222;
                    --text-color: #f0f0f0;
                    --code-bg: #333;
                    --header-color: #3498db;
                    --link-color: #5dade2;
                }
            }
            .back-to-index {
                display: inline-block;
                margin: 1rem 0;
                padding: 0.5rem 1rem;
                background-color: var(--primary-color);
                color: white;
                border-radius: 4px;
                text-decoration: none;
            }
            .back-to-index:hover {
                background-color: var(--link-color);
                text-decoration: none;
            }
        </style></head>
<body><div><a class="back-to-index" href="../index.html">← Back to Index</a></div>
<h1 align="center">IO::Socket::SSL::Utils</h1>
<a href="#NAME">NAME</a><br/>
<a href="#SYNOPSIS">SYNOPSIS</a><br/>
<a href="#DESCRIPTION">DESCRIPTION</a><br/>
<a href="#FUNCTIONS">FUNCTIONS</a><br/>
<a href="#AUTHOR">AUTHOR</a><br/>
<hr/>
<h2>NAME
<a name="NAME"></a>
</h2>
<p style="margin-left:9%; margin-top: 1em">IO::Socket::SSL::Utils
−− loading, storing, creating certificates and
keys</p>
<h2>SYNOPSIS
<a name="SYNOPSIS"></a>
</h2>
<p style="margin-left:9%; margin-top: 1em">use
IO::Socket::SSL::Utils; <br/>
$cert = PEM_file2cert('cert.pem'); # load certificate from
file <br/>
my $hash = CERT_asHash($cert); # get details from
certificate <br/>
PEM_cert2file($cert,'cert.pem'); # write certificate to file
<br/>
CERT_free($cert); # free memory within OpenSSL <br/>
@certs = PEM_file2certs('chain.pem'); # load multiple
certificates from file <br/>
PEM_certs2file('chain.pem', @certs); # write multiple
certificates to file <br/>
CERT_free(@certs); # free memory for all within OpenSSL <br/>
my $cert = PEM_string2cert($pem); # load certificate from
PEM string <br/>
$pem = PEM_cert2string($cert); # convert certificate to PEM
string <br/>
$key = KEY_create_rsa(2048); # create new 2048−bit RSA
key <br/>
PEM_key2file($key,"key.pem"); # and write it to
file <br/>
KEY_free($key); # free memory within OpenSSL</p>
<h2>DESCRIPTION
<a name="DESCRIPTION"></a>
</h2>
<p style="margin-left:9%; margin-top: 1em">This module
provides various utility functions to work with certificates
and private keys, shielding some of the complexity of the
underlying Net::SSLeay and OpenSSL.</p>
<h2>FUNCTIONS
<a name="FUNCTIONS"></a>
</h2>
<table border="0" cellpadding="0" cellspacing="0" frame="void" rules="none" width="100%">
<tr align="left" valign="top">
<td width="9%"></td>
<td width="1%">
<p style="margin-top: 1em">•</p></td>
<td width="4%"></td>
<td width="82%">
<p style="margin-top: 1em">Functions converting between
string or file and certificates and keys. They croak if the
operation cannot be completed.</p></td>
<td width="4%">
</td></tr>
</table>
<p style="margin-left:14%;">PEM_file2cert(file) −&gt;
cert <br/>
PEM_cert2file(cert,file) <br/>
PEM_file2certs(file) −&gt; @certs <br/>
PEM_certs2file(file,@certs) <br/>
PEM_string2cert(string) −&gt; cert <br/>
PEM_cert2string(cert) −&gt; string <br/>
PEM_file2key(file) −&gt; key <br/>
PEM_key2file(key,file) <br/>
PEM_string2key(string) −&gt; key <br/>
PEM_key2string(key) −&gt; string</p>
<table border="0" cellpadding="0" cellspacing="0" frame="void" rules="none" width="100%">
<tr align="left" valign="top">
<td width="9%"></td>
<td width="1%">
<p>•</p></td>
<td width="4%"></td>
<td width="81%">
<p>Functions for cleaning up. Each loaded or created cert
and key must be freed to not leak memory.</p></td>
<td width="5%">
</td></tr>
</table>
<p style="margin-left:14%;">CERT_free(@certs) <br/>
KEY_free(@keys)</p>
<table border="0" cellpadding="0" cellspacing="0" frame="void" rules="none" width="100%">
<tr align="left" valign="top">
<td width="9%"></td>
<td width="1%">
<p>•</p></td>
<td width="4%"></td>
<td width="35%">
<p>KEY_create_rsa(bits) −&gt; key</p></td>
<td width="51%">
</td></tr>
</table>
<p style="margin-left:14%; margin-top: 1em">Creates an RSA
key pair, bits defaults to 2048.</p>
<table border="0" cellpadding="0" cellspacing="0" frame="void" rules="none" width="100%">
<tr align="left" valign="top">
<td width="9%"></td>
<td width="1%">
<p style="margin-top: 1em">•</p></td>
<td width="4%"></td>
<td width="35%">
<p style="margin-top: 1em">KEY_create_ec(curve) −&gt;
key</p> </td>
<td width="51%">
</td></tr>
</table>
<p style="margin-left:14%; margin-top: 1em">Creates an EC
key, curve defaults to "prime256v1".</p>
<table border="0" cellpadding="0" cellspacing="0" frame="void" rules="none" width="100%">
<tr align="left" valign="top">
<td width="9%"></td>
<td width="1%">
<p style="margin-top: 1em">•</p></td>
<td width="4%"></td>
<td width="50%">
<p style="margin-top: 1em">CERT_asHash(cert,[digest_algo])
−&gt; hash</p></td>
<td width="36%">
</td></tr>
</table>
<p style="margin-left:14%; margin-top: 1em">Extracts the
information from the certificate into a hash and uses the
given digest_algo (default: SHA−256) to determine
digest of pubkey and cert. The resulting hash contains:</p>
<table border="0" cellpadding="0" cellspacing="0" frame="void" rules="none" width="100%">
<tr align="left" valign="top">
<td width="14%"></td>
<td width="9%">
<p style="margin-top: 1em">subject</p></td>
<td width="1%"></td>
<td width="76%">
<p style="margin-top: 1em">Hash with the parts of the
subject, e.g. commonName, countryName, organizationName,
stateOrProvinceName, localityName. If there are multiple
values for any of these parts the hash value will be an
array ref with the values in order instead of just a
scalar.</p> </td></tr>
</table>
<p style="margin-left:14%;">subjectAltNames</p>
<p style="margin-left:24%;">Array with list of alternative
names. Each entry in the list is of
"[type,value]", where "type" can be
OTHERNAME, EMAIL, DNS, X400, DIRNAME, EDIPARTY, URI, IP or
RID.</p>
<table border="0" cellpadding="0" cellspacing="0" frame="void" rules="none" width="100%">
<tr align="left" valign="top">
<td width="14%"></td>
<td width="8%">
<p>issuer</p></td>
<td width="2%"></td>
<td width="76%">
<p>Hash with the parts of the issuer, e.g. commonName,
countryName, organizationName, stateOrProvinceName,
localityName. If there are multiple values for any of these
parts the hash value will be an array ref with the values in
order instead of just a scalar.</p></td></tr>
</table>
<p style="margin-left:14%;">not_before, not_after</p>
<p style="margin-left:24%;">The time frame, where the
certificate is valid, as time_t, e.g. can be converted with
localtime or similar functions.</p>
<table border="0" cellpadding="0" cellspacing="0" frame="void" rules="none" width="100%">
<tr align="left" valign="top">
<td width="14%"></td>
<td width="9%">
<p>serial</p></td>
<td width="1%"></td>
<td width="44%">
<p>The serial number</p></td>
<td width="32%">
</td></tr>
<tr align="left" valign="top">
<td width="14%"></td>
<td width="9%">
<p>crl_uri</p></td>
<td width="1%"></td>
<td width="44%">
<p>List of URIs for CRL distribution.</p></td>
<td width="32%">
</td></tr>
</table>
<p style="margin-left:14%;">ocsp_uri</p>
<p style="margin-left:24%;">List of URIs for revocation
checking using OCSP.</p>
<p style="margin-left:14%;">keyusage</p>
<p style="margin-left:24%;">List of keyUsage information in
the certificate.</p>
<p style="margin-left:14%;">extkeyusage</p>
<p style="margin-left:24%;">List of extended key usage
information from the certificate. Each entry in this list
consists of a hash with oid, nid, ln and sn.</p>
<p style="margin-left:14%;">pubkey_digest_xxx</p>
<p style="margin-left:24%;">Binary digest of the pubkey
using the given digest algorithm, e.g. pubkey_digest_sha256
if (the default) SHA−256 was used.</p>
<p style="margin-left:14%;">x509_digest_xxx</p>
<p style="margin-left:24%;">Binary digest of the X.509
certificate using the given digest algorithm, e.g.
x509_digest_sha256 if (the default) SHA−256 was
used.</p>
<p style="margin-left:14%;">fingerprint_xxx</p>
<p style="margin-left:24%;">Fingerprint of the certificate
using the given digest algorithm, e.g. fingerprint_sha256 if
(the default) SHA−256 was used. Contrary to digest_*
this is an ASCII string with a list if hexadecimal numbers,
e.g. "73:59:75:5C:6D...".</p>
<p style="margin-left:14%;">signature_alg</p>
<p style="margin-left:24%;">Algorithm used to sign
certificate, e.g. "sha256WithRSAEncryption".</p>
<table border="0" cellpadding="0" cellspacing="0" frame="void" rules="none" width="100%">
<tr align="left" valign="top">
<td width="9%"></td>
<td width="14%">
<p>ext</p></td>
<td width="1%"></td>
<td width="75%">
<p>List of extensions. Each entry in the list is a hash
with oid, nid, sn, critical flag (boolean) and data (string
representation given by X509V3_EXT_print).</p></td>
<td width="1%">
</td></tr>
<tr align="left" valign="top">
<td width="9%"></td>
<td width="14%">
<p>version</p></td>
<td width="1%"></td>
<td width="75%">
<p>Certificate version, usually 2 (x509v3)</p></td>
<td width="1%">
</td></tr>
<tr align="left" valign="top">
<td width="9%"></td>
<td width="14%">
<p>•</p></td>
<td width="1%"></td>
<td width="75%"></td>
<td width="1%">
</td></tr>
</table>
<p style="margin-left:14%; margin-top: 1em">CERT_create(hash)
−&gt; (cert,key)</p>
<p style="margin-left:14%; margin-top: 1em">Creates a
certificate based on the given hash. If the issuer is not
specified the certificate will be self−signed. The
following keys can be given:</p>
<table border="0" cellpadding="0" cellspacing="0" frame="void" rules="none" width="100%">
<tr align="left" valign="top">
<td width="14%"></td>
<td width="9%">
<p style="margin-top: 1em">subject</p></td>
<td width="1%"></td>
<td width="72%">
<p style="margin-top: 1em">Hash with the parts of the
subject, e.g. commonName, countryName, ... as described in
"CERT_asHash". Default points to
IO::Socket::SSL.</p> </td>
<td width="4%">
</td></tr>
</table>
<p style="margin-left:14%;">not_before</p>
<p style="margin-left:24%;">A time_t value when the
certificate starts to be valid. Defaults to current
time.</p>
<p style="margin-left:14%;">not_after</p>
<p style="margin-left:24%;">A time_t value when the
certificate ends to be valid. Defaults to current time plus
one 365 days.</p>
<table border="0" cellpadding="0" cellspacing="0" frame="void" rules="none" width="100%">
<tr align="left" valign="top">
<td width="14%"></td>
<td width="9%">
<p>serial</p></td>
<td width="1%"></td>
<td width="71%">
<p>The serial number. If not given a random number will be
used.</p> </td>
<td width="5%">
</td></tr>
<tr align="left" valign="top">
<td width="14%"></td>
<td width="9%">
<p>version</p></td>
<td width="1%"></td>
<td width="71%">
<p>The version of the certificate, default 2 (x509v3).</p></td>
<td width="5%">
</td></tr>
</table>
<p style="margin-left:14%;">CA true|false</p>
<p style="margin-left:24%;">If true declare certificate as
CA, defaults to false.</p>
<p style="margin-left:14%;">purpose string|array|hash</p>
<p style="margin-left:24%;">Set the purpose of the
certificate. The different purposes can be given as a string
separated by non−word character, as array or hash.
With string or array each purpose can be prefixed with '+'
(enable) or '−' (disable) and same can be done with
the value when given as a hash. By default enabling the
purpose is assumed.</p>
<p style="margin-left:24%; margin-top: 1em">If the CA
option is given and true the defaults
"ca,sslca,emailca,objca" are assumed, but can be
overridden with explicit purpose. If the CA option is given
and false the defaults "server,client" are
assumed. If no CA option and no purpose is given it defaults
to "server,client".</p>
<p style="margin-left:24%; margin-top: 1em">Purpose affects
basicConstraints, keyUsage, extKeyUsage and
netscapeCertType. The following purposes are defined (case
is not important):</p>
<p style="margin-left:24%; margin-top: 1em">client <br/>
server <br/>
email <br/>
objsign <br/>
CA <br/>
sslCA <br/>
emailCA <br/>
objCA <br/>
emailProtection <br/>
codeSigning <br/>
timeStamping <br/>
digitalSignature <br/>
nonRepudiation <br/>
keyEncipherment <br/>
dataEncipherment <br/>
keyAgreement <br/>
keyCertSign <br/>
cRLSign <br/>
encipherOnly <br/>
decipherOnly</p>
<p style="margin-left:24%; margin-top: 1em">Examples:</p>
<p style="margin-left:24%; margin-top: 1em"># root−CA
for SSL certificates <br/>
purpose =&gt; 'sslCA' # or CA =&gt; 1 <br/>
# server certificate and CA (typically self−signed)
<br/>
purpose =&gt; 'sslCA,server' <br/>
# client certificate <br/>
purpose =&gt; 'client',</p>
<p style="margin-left:14%;">ext [{ sn =&gt; .., data =&gt;
... }, ... ]</p>
<p style="margin-left:24%;">List of extensions. The type of
the extension can be specified as name with "sn"
or as NID with "nid" and the data with
"data". These data must be in the same syntax as
expected within openssl.cnf, e.g. something like
"OCSP;URI=http://...". Additionally the critical
flag can be set with "critical =" 1&gt;.</p>
<table border="0" cellpadding="0" cellspacing="0" frame="void" rules="none" width="100%">
<tr align="left" valign="top">
<td width="14%"></td>
<td width="9%">
<p>key key</p></td>
<td width="1%"></td>
<td width="73%">
<p>use given key as key for certificate, otherwise a new
one will be generated and returned</p></td>
<td width="3%">
</td></tr>
</table>
<p style="margin-left:14%;">issuer_cert cert</p>
<p style="margin-left:24%;">set issuer for new
certificate</p>
<p style="margin-left:14%;">issuer_key key</p>
<p style="margin-left:24%;">sign new certificate with given
key</p>
<p style="margin-left:14%;">issuer [ cert, key ]</p>
<p style="margin-left:24%;">Instead of giving issuer_key
and issuer_cert as separate arguments they can be given both
together.</p>
<p style="margin-left:14%;">digest algorithm</p>
<p style="margin-left:24%;">specify the algorithm used to
sign the certificate, default SHA−256.</p>
<p style="margin-left:14%;">ignore_invalid_args</p>
<p style="margin-left:24%;">ignore any unknown arguments
which might be in the argument list (which might be in the
arguments for example as result from CERT_asHash)</p>
<h2>AUTHOR
<a name="AUTHOR"></a>
</h2>
<p style="margin-left:9%; margin-top: 1em">Steffen
Ullrich</p>
<hr/>
</body>
</html>
