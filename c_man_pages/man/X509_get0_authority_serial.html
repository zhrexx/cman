<!-- Creator     : groff version 1.23.0 -->
<!-- CreationDate: Sat Apr  5 20:52:50 2025 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">

<html>
<head>
<meta content="groff -Thtml, see www.gnu.org" name="generator"/>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<meta content="text/css" name="Content-Style"/>
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title>X509_GET_EXTENSION_FLAGS</title>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/><style>
            :root {
                --primary-color: #3498db;
                --background-color: #f9f9f9;
                --text-color: #333;
                --code-bg: #f0f0f0;
                --header-color: #2c3e50;
                --link-color: #2980b9;
            }
            body {
                font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
                line-height: 1.6;
                color: var(--text-color);
                background-color: var(--background-color);
                max-width: 900px;
                margin: 0 auto;
                padding: 2rem;
            }
            h1, h2, h3, h4 {
                color: var(--header-color);
            }
            h1 {
                border-bottom: 2px solid var(--primary-color);
                padding-bottom: 0.5rem;
            }
            pre {
                background-color: var(--code-bg);
                padding: 1rem;
                border-radius: 4px;
                overflow-x: auto;
            }
            a {
                color: var(--link-color);
                text-decoration: none;
            }
            a:hover {
                text-decoration: underline;
            }
            .man-navigation {
                background-color: #fff;
                border-bottom: 1px solid #ddd;
                padding: 0.5rem 0;
                position: sticky;
                top: 0;
                z-index: 100;
            }
            .section {
                margin-top: 2rem;
            }
            @media (prefers-color-scheme: dark) {
                :root {
                    --primary-color: #3498db;
                    --background-color: #222;
                    --text-color: #f0f0f0;
                    --code-bg: #333;
                    --header-color: #3498db;
                    --link-color: #5dade2;
                }
            }
            .back-to-index {
                display: inline-block;
                margin: 1rem 0;
                padding: 0.5rem 1rem;
                background-color: var(--primary-color);
                color: white;
                border-radius: 4px;
                text-decoration: none;
            }
            .back-to-index:hover {
                background-color: var(--link-color);
                text-decoration: none;
            }
        </style></head>
<body><div><a class="back-to-index" href="../index.html">← Back to Index</a></div>
<h1 align="center">X509_GET_EXTENSION_FLAGS</h1>
<a href="#NAME">NAME</a><br/>
<a href="#SYNOPSIS">SYNOPSIS</a><br/>
<a href="#DESCRIPTION">DESCRIPTION</a><br/>
<a href="#NOTES">NOTES</a><br/>
<a href="#RETURN VALUES">RETURN VALUES</a><br/>
<a href="#SEE ALSO">SEE ALSO</a><br/>
<a href="#HISTORY">HISTORY</a><br/>
<a href="#COPYRIGHT">COPYRIGHT</a><br/>
<hr/>
<h2>NAME
<a name="NAME"></a>
</h2>
<p style="margin-left:9%; margin-top: 1em">X509_get0_subject_key_id,
X509_get0_authority_key_id, X509_get0_authority_issuer,
X509_get0_authority_serial, X509_get_pathlen,
X509_get_extension_flags, X509_get_key_usage,
X509_get_extended_key_usage, X509_set_proxy_flag,
X509_set_proxy_pathlen, X509_get_proxy_pathlen −
retrieve certificate extension data</p>
<h2>SYNOPSIS
<a name="SYNOPSIS"></a>
</h2>
<p style="margin-left:9%; margin-top: 1em">#include
&lt;openssl/x509v3.h&gt; <br/>
long X509_get_pathlen(X509 *x); <br/>
uint32_t X509_get_extension_flags(X509 *x); <br/>
uint32_t X509_get_key_usage(X509 *x); <br/>
uint32_t X509_get_extended_key_usage(X509 *x); <br/>
const ASN1_OCTET_STRING *X509_get0_subject_key_id(X509 *x);
<br/>
const ASN1_OCTET_STRING *X509_get0_authority_key_id(X509
*x); <br/>
const GENERAL_NAMES *X509_get0_authority_issuer(X509 *x);
<br/>
const ASN1_INTEGER *X509_get0_authority_serial(X509 *x);
<br/>
void X509_set_proxy_flag(X509 *x); <br/>
void X509_set_proxy_pathlen(int l); <br/>
long X509_get_proxy_pathlen(X509 *x);</p>
<h2>DESCRIPTION
<a name="DESCRIPTION"></a>
</h2>
<p style="margin-left:9%; margin-top: 1em">These functions
retrieve information related to commonly used certificate
extensions.</p>
<p style="margin-left:9%; margin-top: 1em"><b>X509_get_pathlen()</b>
retrieves the path length extension from a certificate. This
extension is used to limit the length of a cert chain that
may be issued from that CA.</p>
<p style="margin-left:9%; margin-top: 1em"><b>X509_get_extension_flags()</b>
retrieves general information about a certificate, it will
return one or more of the following flags ored together.
<b><br/>
EXFLAG_V1</b></p>
<p style="margin-left:14%;">The certificate is an obsolete
version 1 certificate.</p>
<p style="margin-left:9%;"><b>EXFLAG_BCONS</b></p>
<p style="margin-left:14%;">The certificate contains a
basic constraints extension.</p>
<p style="margin-left:9%;"><b>EXFLAG_CA</b></p>
<p style="margin-left:14%;">The certificate contains basic
constraints and asserts the CA flag.</p>
<p style="margin-left:9%;"><b>EXFLAG_PROXY</b></p>
<p style="margin-left:14%;">The certificate is a valid
proxy certificate.</p>
<p style="margin-left:9%;"><b>EXFLAG_SI</b></p>
<p style="margin-left:14%;">The certificate is self issued
(that is subject and issuer names match).</p>
<p style="margin-left:9%;"><b>EXFLAG_SS</b></p>
<p style="margin-left:14%;">The subject and issuer names
match and extension values imply it is self signed.</p>
<p style="margin-left:9%;"><b>EXFLAG_FRESHEST</b></p>
<p style="margin-left:14%;">The freshest CRL extension is
present in the certificate.</p>
<p style="margin-left:9%;"><b>EXFLAG_CRITICAL</b></p>
<p style="margin-left:14%;">The certificate contains an
unhandled critical extension.</p>
<p style="margin-left:9%;"><b>EXFLAG_INVALID</b></p>
<p style="margin-left:14%;">Some certificate extension
values are invalid or inconsistent. The certificate should
be rejected. This bit may also be raised after an
out−of−memory error while processing the X509
object, so it may not be related to the processed ASN1
object itself.</p>
<p style="margin-left:9%;"><b>EXFLAG_NO_FINGERPRINT</b></p>
<p style="margin-left:14%;">Failed to compute the internal
SHA1 hash value of the certificate or CRL. This may be due
to malloc failure or because no SHA1 implementation was
found.</p>
<p style="margin-left:9%;"><b>EXFLAG_INVALID_POLICY</b></p>
<p style="margin-left:14%;">The NID_certificate_policies
certificate extension is invalid or inconsistent. The
certificate should be rejected. This bit may also be raised
after an out−of−memory error while processing
the X509 object, so it may not be related to the processed
ASN1 object itself.</p>
<p style="margin-left:9%;"><b>EXFLAG_KUSAGE</b></p>
<p style="margin-left:14%;">The certificate contains a key
usage extension. The value can be retrieved using
<b>X509_get_key_usage()</b>.</p>
<p style="margin-left:9%;"><b>EXFLAG_XKUSAGE</b></p>
<p style="margin-left:14%;">The certificate contains an
extended key usage extension. The value can be retrieved
using <b>X509_get_extended_key_usage()</b>.</p>
<p style="margin-left:9%; margin-top: 1em"><b>X509_get_key_usage()</b>
returns the value of the key usage extension. If key usage
is present will return zero or more of the flags:
<b>KU_DIGITAL_SIGNATURE</b>, <b>KU_NON_REPUDIATION</b>,
<b>KU_KEY_ENCIPHERMENT</b>, <b>KU_DATA_ENCIPHERMENT</b>,
<b>KU_KEY_AGREEMENT</b>, <b>KU_KEY_CERT_SIGN</b>,
<b>KU_CRL_SIGN</b>, <b>KU_ENCIPHER_ONLY</b> or
<b>KU_DECIPHER_ONLY</b> corresponding to individual key
usage bits. If key usage is absent then <b>UINT32_MAX</b> is
returned.</p>
<p style="margin-left:9%; margin-top: 1em"><b>X509_get_extended_key_usage()</b>
returns the value of the extended key usage extension. If
extended key usage is present it will return zero or more of
the flags: <b>XKU_SSL_SERVER</b>, <b>XKU_SSL_CLIENT</b>,
<b>XKU_SMIME</b>, <b>XKU_CODE_SIGN XKU_OCSP_SIGN</b>,
<b>XKU_TIMESTAMP</b>, <b>XKU_DVCS</b> or <b>XKU_ANYEKU</b>.
These correspond to the OIDs
<b>id−kp−serverAuth</b>,
<b>id−kp−clientAuth</b>,
<b>id−kp−emailProtection</b>,
<b>id−kp−codeSigning</b>,
<b>id−kp−OCSPSigning</b>,
<b>id−kp−timeStamping</b>,
<b>id−kp−dvcs</b> and <b>anyExtendedKeyUsage</b>
respectively. Additionally <b>XKU_SGC</b> is set if either
Netscape or Microsoft SGC OIDs are present.</p>
<p style="margin-left:9%; margin-top: 1em"><b>X509_get0_subject_key_id()</b>
returns an internal pointer to the subject key identifier of
<b>x</b> as an <b>ASN1_OCTET_STRING</b> or <b>NULL</b> if
the extension is not present or cannot be parsed.</p>
<p style="margin-left:9%; margin-top: 1em"><b>X509_get0_authority_key_id()</b>
returns an internal pointer to the authority key identifier
of <b>x</b> as an <b>ASN1_OCTET_STRING</b> or <b>NULL</b> if
the extension is not present or cannot be parsed.</p>
<p style="margin-left:9%; margin-top: 1em"><b>X509_get0_authority_issuer()</b>
returns an internal pointer to the authority certificate
issuer of <b>x</b> as a stack of <b>GENERAL_NAME</b>
structures or <b>NULL</b> if the extension is not present or
cannot be parsed.</p>
<p style="margin-left:9%; margin-top: 1em"><b>X509_get0_authority_serial()</b>
returns an internal pointer to the authority certificate
serial number of <b>x</b> as an <b>ASN1_INTEGER</b> or
<b>NULL</b> if the extension is not present or cannot be
parsed.</p>
<p style="margin-left:9%; margin-top: 1em"><b>X509_set_proxy_flag()</b>
marks the certificate with the <b>EXFLAG_PROXY</b> flag.
This is for the users who need to mark non−RFC3820
proxy certificates as such, as OpenSSL only detects RFC3820
compliant ones.</p>
<p style="margin-left:9%; margin-top: 1em"><b>X509_set_proxy_pathlen()</b>
sets the proxy certificate path length for the given
certificate <b>x</b>. This is for the users who need to mark
non−RFC3820 proxy certificates as such, as OpenSSL
only detects RFC3820 compliant ones.</p>
<p style="margin-left:9%; margin-top: 1em"><b>X509_get_proxy_pathlen()</b>
returns the proxy certificate path length for the given
certificate <b>x</b> if it is a proxy certificate.</p>
<h2>NOTES
<a name="NOTES"></a>
</h2>
<p style="margin-left:9%; margin-top: 1em">The value of the
flags correspond to extension values which are cached in the
<b>X509</b> structure. If the flags returned do not provide
sufficient information an application should examine
extension values directly for example using
<b>X509_get_ext_d2i()</b>.</p>
<p style="margin-left:9%; margin-top: 1em">If the key usage
or extended key usage extension is absent then typically
usage is unrestricted. For this reason
<b>X509_get_key_usage()</b> and
<b>X509_get_extended_key_usage()</b> return
<b>UINT32_MAX</b> when the corresponding extension is
absent. Applications can additionally check the return value
of <b>X509_get_extension_flags()</b> and take appropriate
action is an extension is absent.</p>
<p style="margin-left:9%; margin-top: 1em">If
<b>X509_get0_subject_key_id()</b> returns <b>NULL</b> then
the extension may be absent or malformed. Applications can
determine the precise reason using
<b>X509_get_ext_d2i()</b>.</p>
<h2>RETURN VALUES
<a name="RETURN VALUES"></a>
</h2>
<p style="margin-left:9%; margin-top: 1em"><b>X509_get_pathlen()</b>
returns the path length value, or −1 if the extension
is not present.</p>
<p style="margin-left:9%; margin-top: 1em"><b>X509_get_extension_flags()</b>,
<b>X509_get_key_usage()</b> and
<b>X509_get_extended_key_usage()</b> return sets of flags
corresponding to the certificate extension values.</p>
<p style="margin-left:9%; margin-top: 1em"><b>X509_get0_subject_key_id()</b>
returns the subject key identifier as a pointer to an
<b>ASN1_OCTET_STRING</b> structure or <b>NULL</b> if the
extension is absent or an error occurred during parsing.</p>
<p style="margin-left:9%; margin-top: 1em"><b>X509_get_proxy_pathlen()</b>
returns the path length value if the given certificate is a
proxy one and has a path length set, and −1
otherwise.</p>
<h2>SEE ALSO
<a name="SEE ALSO"></a>
</h2>
<p style="margin-left:9%; margin-top: 1em"><b>X509_check_purpose</b>(3)</p>
<h2>HISTORY
<a name="HISTORY"></a>
</h2>
<p style="margin-left:9%; margin-top: 1em"><b>X509_get_pathlen()</b>,
<b>X509_set_proxy_flag()</b>,
<b>X509_set_proxy_pathlen()</b> and
<b>X509_get_proxy_pathlen()</b> were added in OpenSSL
1.1.0.</p>
<h2>COPYRIGHT
<a name="COPYRIGHT"></a>
</h2>
<p style="margin-left:9%; margin-top: 1em">Copyright
2015−2021 The OpenSSL Project Authors. All Rights
Reserved.</p>
<p style="margin-left:9%; margin-top: 1em">Licensed under
the Apache License 2.0 (the "License"). You may
not use this file except in compliance with the License. You
can obtain a copy in the file LICENSE in the source
distribution or at
&lt;https://www.openssl.org/source/license.html&gt;.</p>
<hr/>
</body>
</html>
