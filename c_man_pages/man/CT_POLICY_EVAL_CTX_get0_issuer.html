<!-- Creator     : groff version 1.23.0 -->
<!-- CreationDate: Sat Apr  5 20:40:29 2025 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">

<html>
<head>
<meta content="groff -Thtml, see www.gnu.org" name="generator"/>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<meta content="text/css" name="Content-Style"/>
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title>CT_POLICY_EVAL_CTX_NEW</title>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/><style>
            :root {
                --primary-color: #3498db;
                --background-color: #f9f9f9;
                --text-color: #333;
                --code-bg: #f0f0f0;
                --header-color: #2c3e50;
                --link-color: #2980b9;
            }
            body {
                font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
                line-height: 1.6;
                color: var(--text-color);
                background-color: var(--background-color);
                max-width: 900px;
                margin: 0 auto;
                padding: 2rem;
            }
            h1, h2, h3, h4 {
                color: var(--header-color);
            }
            h1 {
                border-bottom: 2px solid var(--primary-color);
                padding-bottom: 0.5rem;
            }
            pre {
                background-color: var(--code-bg);
                padding: 1rem;
                border-radius: 4px;
                overflow-x: auto;
            }
            a {
                color: var(--link-color);
                text-decoration: none;
            }
            a:hover {
                text-decoration: underline;
            }
            .man-navigation {
                background-color: #fff;
                border-bottom: 1px solid #ddd;
                padding: 0.5rem 0;
                position: sticky;
                top: 0;
                z-index: 100;
            }
            .section {
                margin-top: 2rem;
            }
            @media (prefers-color-scheme: dark) {
                :root {
                    --primary-color: #3498db;
                    --background-color: #222;
                    --text-color: #f0f0f0;
                    --code-bg: #333;
                    --header-color: #3498db;
                    --link-color: #5dade2;
                }
            }
            .back-to-index {
                display: inline-block;
                margin: 1rem 0;
                padding: 0.5rem 1rem;
                background-color: var(--primary-color);
                color: white;
                border-radius: 4px;
                text-decoration: none;
            }
            .back-to-index:hover {
                background-color: var(--link-color);
                text-decoration: none;
            }
        </style></head>
<body><div><a class="back-to-index" href="../index.html">← Back to Index</a></div>
<h1 align="center">CT_POLICY_EVAL_CTX_NEW</h1>
<a href="#NAME">NAME</a><br/>
<a href="#SYNOPSIS">SYNOPSIS</a><br/>
<a href="#DESCRIPTION">DESCRIPTION</a><br/>
<a href="#NOTES">NOTES</a><br/>
<a href="#RETURN VALUES">RETURN VALUES</a><br/>
<a href="#SEE ALSO">SEE ALSO</a><br/>
<a href="#HISTORY">HISTORY</a><br/>
<a href="#COPYRIGHT">COPYRIGHT</a><br/>
<hr/>
<h2>NAME
<a name="NAME"></a>
</h2>
<p style="margin-left:9%; margin-top: 1em">CT_POLICY_EVAL_CTX_new_ex,
CT_POLICY_EVAL_CTX_new, CT_POLICY_EVAL_CTX_free,
CT_POLICY_EVAL_CTX_get0_cert, CT_POLICY_EVAL_CTX_set1_cert,
CT_POLICY_EVAL_CTX_get0_issuer,
CT_POLICY_EVAL_CTX_set1_issuer,
CT_POLICY_EVAL_CTX_get0_log_store,
CT_POLICY_EVAL_CTX_set_shared_CTLOG_STORE,
CT_POLICY_EVAL_CTX_get_time, CT_POLICY_EVAL_CTX_set_time
− Encapsulates the data required to evaluate whether
SCTs meet a Certificate Transparency policy</p>
<h2>SYNOPSIS
<a name="SYNOPSIS"></a>
</h2>
<p style="margin-left:9%; margin-top: 1em">#include
&lt;openssl/ct.h&gt; <br/>
CT_POLICY_EVAL_CTX *CT_POLICY_EVAL_CTX_new_ex(OSSL_LIB_CTX
*libctx, <br/>
const char *propq); <br/>
CT_POLICY_EVAL_CTX *CT_POLICY_EVAL_CTX_new(void); <br/>
void CT_POLICY_EVAL_CTX_free(CT_POLICY_EVAL_CTX *ctx); <br/>
X509* CT_POLICY_EVAL_CTX_get0_cert(const CT_POLICY_EVAL_CTX
*ctx); <br/>
int CT_POLICY_EVAL_CTX_set1_cert(CT_POLICY_EVAL_CTX *ctx,
X509 *cert); <br/>
X509* CT_POLICY_EVAL_CTX_get0_issuer(const
CT_POLICY_EVAL_CTX *ctx); <br/>
int CT_POLICY_EVAL_CTX_set1_issuer(CT_POLICY_EVAL_CTX *ctx,
X509 *issuer); <br/>
const CTLOG_STORE *CT_POLICY_EVAL_CTX_get0_log_store(const
CT_POLICY_EVAL_CTX *ctx); <br/>
void
CT_POLICY_EVAL_CTX_set_shared_CTLOG_STORE(CT_POLICY_EVAL_CTX
*ctx, <br/>
CTLOG_STORE *log_store); <br/>
uint64_t CT_POLICY_EVAL_CTX_get_time(const
CT_POLICY_EVAL_CTX *ctx); <br/>
void CT_POLICY_EVAL_CTX_set_time(CT_POLICY_EVAL_CTX *ctx,
uint64_t time_in_ms);</p>
<h2>DESCRIPTION
<a name="DESCRIPTION"></a>
</h2>
<p style="margin-left:9%; margin-top: 1em">A
<b>CT_POLICY_EVAL_CTX</b> is used by functions that evaluate
whether Signed Certificate Timestamps (SCTs) fulfil a
Certificate Transparency (CT) policy. This policy may be,
for example, that at least one valid SCT is available. To
determine this, an SCT's timestamp and signature must be
verified. This requires:</p>
<table border="0" cellpadding="0" cellspacing="0" frame="void" rules="none" width="100%">
<tr align="left" valign="top">
<td width="9%"></td>
<td width="1%">
<p>•</p></td>
<td width="2%"></td>
<td width="87%">
<p>the public key of the log that issued the SCT</p></td>
<td width="1%">
</td></tr>
<tr align="left" valign="top">
<td width="9%"></td>
<td width="1%">
<p>•</p></td>
<td width="2%"></td>
<td width="87%">
<p>the certificate that the SCT was issued for</p></td>
<td width="1%">
</td></tr>
<tr align="left" valign="top">
<td width="9%"></td>
<td width="1%">
<p>•</p></td>
<td width="2%"></td>
<td width="87%">
<p>the issuer certificate (if the SCT was issued for a
pre−certificate)</p> </td>
<td width="1%">
</td></tr>
<tr align="left" valign="top">
<td width="9%"></td>
<td width="1%">
<p>•</p></td>
<td width="2%"></td>
<td width="87%">
<p>the current time</p></td>
<td width="1%">
</td></tr>
</table>
<p style="margin-left:9%; margin-top: 1em">The above
requirements are met using the setters described below.</p>
<p style="margin-left:9%; margin-top: 1em"><b>CT_POLICY_EVAL_CTX_new_ex()</b>
creates an empty policy evaluation context and associates it
with the given library context <i>libctx</i> and property
query string <i>propq</i>.</p>
<p style="margin-left:9%; margin-top: 1em"><b>CT_POLICY_EVAL_CTX_new()</b>
does the same thing as <b>CT_POLICY_EVAL_CTX_new_ex()</b>
except that it uses the default library context and property
query string.</p>
<p style="margin-left:9%; margin-top: 1em">The
CT_POLICY_EVAL_CTX should then be populated using:</p>
<table border="0" cellpadding="0" cellspacing="0" frame="void" rules="none" width="100%">
<tr align="left" valign="top">
<td width="9%"></td>
<td width="1%">
<p style="margin-top: 1em">•</p></td>
<td width="2%"></td>
<td width="84%">
<p style="margin-top: 1em"><b>CT_POLICY_EVAL_CTX_set1_cert()</b>
to provide the certificate the SCTs were issued for</p></td>
<td width="4%">
</td></tr>
</table>
<p style="margin-left:12%; margin-top: 1em">Increments the
reference count of the certificate.</p>
<table border="0" cellpadding="0" cellspacing="0" frame="void" rules="none" width="100%">
<tr align="left" valign="top">
<td width="9%"></td>
<td width="1%">
<p style="margin-top: 1em">•</p></td>
<td width="2%"></td>
<td width="84%">
<p style="margin-top: 1em"><b>CT_POLICY_EVAL_CTX_set1_issuer()</b>
to provide the issuer certificate</p></td>
<td width="4%">
</td></tr>
</table>
<p style="margin-left:12%; margin-top: 1em">Increments the
reference count of the certificate.</p>
<table border="0" cellpadding="0" cellspacing="0" frame="void" rules="none" width="100%">
<tr align="left" valign="top">
<td width="9%"></td>
<td width="1%">
<p style="margin-top: 1em">•</p></td>
<td width="2%"></td>
<td width="88%">
<p style="margin-top: 1em"><b>CT_POLICY_EVAL_CTX_set_shared_CTLOG_STORE()</b>
to provide a list of logs that are trusted as sources of
SCTs</p> </td></tr>
</table>
<p style="margin-left:12%; margin-top: 1em">Holds a pointer
to the CTLOG_STORE, so the CTLOG_STORE must outlive the
CT_POLICY_EVAL_CTX.</p>
<table border="0" cellpadding="0" cellspacing="0" frame="void" rules="none" width="100%">
<tr align="left" valign="top">
<td width="9%"></td>
<td width="1%">
<p style="margin-top: 1em">•</p></td>
<td width="2%"></td>
<td width="88%">
<p style="margin-top: 1em"><b>CT_POLICY_EVAL_CTX_set_time()</b>
to set the time SCTs should be compared with to determine if
they are valid</p></td></tr>
</table>
<p style="margin-left:12%; margin-top: 1em">The SCT
timestamp will be compared to this time to check whether the
SCT was issued in the future. RFC6962 states that "TLS
clients MUST reject SCTs whose timestamp is in the
future". By default, this will be set to 5 minutes in
the future (e.g. (<b>time()</b> + 300) * 1000), to allow for
clock drift.</p>
<p style="margin-left:12%; margin-top: 1em">The time should
be in milliseconds since the Unix Epoch.</p>
<p style="margin-left:9%; margin-top: 1em">Each setter has
a matching getter for accessing the current value.</p>
<p style="margin-left:9%; margin-top: 1em">When no longer
required, the <b>CT_POLICY_EVAL_CTX</b> should be passed to
<b>CT_POLICY_EVAL_CTX_free()</b> to delete it. If the
argument to <b>CT_POLICY_EVAL_CTX_free()</b> is NULL,
nothing is done.</p>
<h2>NOTES
<a name="NOTES"></a>
</h2>
<p style="margin-left:9%; margin-top: 1em">The issuer
certificate only needs to be provided if at least one of the
SCTs was issued for a pre−certificate. This will be
the case for SCTs embedded in a certificate (i.e. those in
an X.509 extension), but may not be the case for SCTs found
in the TLS SCT extension or OCSP response.</p>
<h2>RETURN VALUES
<a name="RETURN VALUES"></a>
</h2>
<p style="margin-left:9%; margin-top: 1em"><b>CT_POLICY_EVAL_CTX_new_ex()</b>
and <b>CT_POLICY_EVAL_CTX_new()</b> will return NULL if
malloc fails.</p>
<h2>SEE ALSO
<a name="SEE ALSO"></a>
</h2>
<p style="margin-left:9%; margin-top: 1em"><b>ct</b>(7)</p>
<h2>HISTORY
<a name="HISTORY"></a>
</h2>
<p style="margin-left:9%; margin-top: 1em">CT_POLICY_EVAL_CTX_new_ex
was added in OpenSSL 3.0. All other functions were added in
OpenSSL 1.1.0.</p>
<h2>COPYRIGHT
<a name="COPYRIGHT"></a>
</h2>
<p style="margin-left:9%; margin-top: 1em">Copyright
2016−2024 The OpenSSL Project Authors. All Rights
Reserved.</p>
<p style="margin-left:9%; margin-top: 1em">Licensed under
the Apache License 2.0 (the "License"). You may
not use this file except in compliance with the License. You
can obtain a copy in the file LICENSE in the source
distribution or at
&lt;https://www.openssl.org/source/license.html&gt;.</p>
<hr/>
</body>
</html>
