<!-- Creator     : groff version 1.23.0 -->
<!-- CreationDate: Sat Apr  5 19:54:58 2025 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">

<html>
<head>
<meta content="groff -Thtml, see www.gnu.org" name="generator"/>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<meta content="text/css" name="Content-Style"/>
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title>X509V3_GET_EXT_BY_NID</title>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/><style>
            :root {
                --primary-color: #3498db;
                --background-color: #f9f9f9;
                --text-color: #333;
                --code-bg: #f0f0f0;
                --header-color: #2c3e50;
                --link-color: #2980b9;
            }
            body {
                font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
                line-height: 1.6;
                color: var(--text-color);
                background-color: var(--background-color);
                max-width: 900px;
                margin: 0 auto;
                padding: 2rem;
            }
            h1, h2, h3, h4 {
                color: var(--header-color);
            }
            h1 {
                border-bottom: 2px solid var(--primary-color);
                padding-bottom: 0.5rem;
            }
            pre {
                background-color: var(--code-bg);
                padding: 1rem;
                border-radius: 4px;
                overflow-x: auto;
            }
            a {
                color: var(--link-color);
                text-decoration: none;
            }
            a:hover {
                text-decoration: underline;
            }
            .man-navigation {
                background-color: #fff;
                border-bottom: 1px solid #ddd;
                padding: 0.5rem 0;
                position: sticky;
                top: 0;
                z-index: 100;
            }
            .section {
                margin-top: 2rem;
            }
            @media (prefers-color-scheme: dark) {
                :root {
                    --primary-color: #3498db;
                    --background-color: #222;
                    --text-color: #f0f0f0;
                    --code-bg: #333;
                    --header-color: #3498db;
                    --link-color: #5dade2;
                }
            }
            .back-to-index {
                display: inline-block;
                margin: 1rem 0;
                padding: 0.5rem 1rem;
                background-color: var(--primary-color);
                color: white;
                border-radius: 4px;
                text-decoration: none;
            }
            .back-to-index:hover {
                background-color: var(--link-color);
                text-decoration: none;
            }
        </style></head>
<body><div><a class="back-to-index" href="../index.html">← Back to Index</a></div>
<h1 align="center">X509V3_GET_EXT_BY_NID</h1>
<a href="#NAME">NAME</a><br/>
<a href="#SYNOPSIS">SYNOPSIS</a><br/>
<a href="#DESCRIPTION">DESCRIPTION</a><br/>
<a href="#NOTES">NOTES</a><br/>
<a href="#RETURN VALUES">RETURN VALUES</a><br/>
<a href="#SEE ALSO">SEE ALSO</a><br/>
<a href="#COPYRIGHT">COPYRIGHT</a><br/>
<hr/>
<h2>NAME
<a name="NAME"></a>
</h2>
<p style="margin-left:9%; margin-top: 1em">X509v3_get_ext_count,
X509v3_get_ext, X509v3_get_ext_by_NID,
X509v3_get_ext_by_OBJ, X509v3_get_ext_by_critical,
X509v3_delete_ext, X509v3_add_ext, X509_get_ext_count,
X509_get_ext, X509_get_ext_by_NID, X509_get_ext_by_OBJ,
X509_get_ext_by_critical, X509_delete_ext, X509_add_ext,
X509_CRL_get_ext_count, X509_CRL_get_ext,
X509_CRL_get_ext_by_NID, X509_CRL_get_ext_by_OBJ,
X509_CRL_get_ext_by_critical, X509_CRL_delete_ext,
X509_CRL_add_ext, X509_REVOKED_get_ext_count,
X509_REVOKED_get_ext, X509_REVOKED_get_ext_by_NID,
X509_REVOKED_get_ext_by_OBJ,
X509_REVOKED_get_ext_by_critical, X509_REVOKED_delete_ext,
X509_REVOKED_add_ext − extension stack utility
functions</p>
<h2>SYNOPSIS
<a name="SYNOPSIS"></a>
</h2>
<p style="margin-left:9%; margin-top: 1em">#include
&lt;openssl/x509.h&gt; <br/>
int X509v3_get_ext_count(const STACK_OF(X509_EXTENSION) *x);
<br/>
X509_EXTENSION *X509v3_get_ext(const
STACK_OF(X509_EXTENSION) *x, int loc); <br/>
int X509v3_get_ext_by_NID(const STACK_OF(X509_EXTENSION) *x,
<br/>
int nid, int lastpos); <br/>
int X509v3_get_ext_by_OBJ(const STACK_OF(X509_EXTENSION) *x,
<br/>
const ASN1_OBJECT *obj, int lastpos); <br/>
int X509v3_get_ext_by_critical(const
STACK_OF(X509_EXTENSION) *x, <br/>
int crit, int lastpos); <br/>
X509_EXTENSION *X509v3_delete_ext(STACK_OF(X509_EXTENSION)
*x, int loc); <br/>
STACK_OF(X509_EXTENSION)
*X509v3_add_ext(STACK_OF(X509_EXTENSION) **x, <br/>
X509_EXTENSION *ex, int loc); <br/>
int X509_get_ext_count(const X509 *x); <br/>
X509_EXTENSION *X509_get_ext(const X509 *x, int loc); <br/>
int X509_get_ext_by_NID(const X509 *x, int nid, int
lastpos); <br/>
int X509_get_ext_by_OBJ(const X509 *x, const ASN1_OBJECT
*obj, int lastpos); <br/>
int X509_get_ext_by_critical(const X509 *x, int crit, int
lastpos); <br/>
X509_EXTENSION *X509_delete_ext(X509 *x, int loc); <br/>
int X509_add_ext(X509 *x, X509_EXTENSION *ex, int loc); <br/>
int X509_CRL_get_ext_count(const X509_CRL *x); <br/>
X509_EXTENSION *X509_CRL_get_ext(const X509_CRL *x, int
loc); <br/>
int X509_CRL_get_ext_by_NID(const X509_CRL *x, int nid, int
lastpos); <br/>
int X509_CRL_get_ext_by_OBJ(const X509_CRL *x, const
ASN1_OBJECT *obj, <br/>
int lastpos); <br/>
int X509_CRL_get_ext_by_critical(const X509_CRL *x, int
crit, int lastpos); <br/>
X509_EXTENSION *X509_CRL_delete_ext(X509_CRL *x, int loc);
<br/>
int X509_CRL_add_ext(X509_CRL *x, X509_EXTENSION *ex, int
loc); <br/>
int X509_REVOKED_get_ext_count(const X509_REVOKED *x); <br/>
X509_EXTENSION *X509_REVOKED_get_ext(const X509_REVOKED *x,
int loc); <br/>
int X509_REVOKED_get_ext_by_NID(const X509_REVOKED *x, int
nid, int lastpos); <br/>
int X509_REVOKED_get_ext_by_OBJ(const X509_REVOKED *x, const
ASN1_OBJECT *obj, <br/>
int lastpos); <br/>
int X509_REVOKED_get_ext_by_critical(const X509_REVOKED *x,
int crit, int lastpos); <br/>
X509_EXTENSION *X509_REVOKED_delete_ext(X509_REVOKED *x, int
loc); <br/>
int X509_REVOKED_add_ext(X509_REVOKED *x, X509_EXTENSION
*ex, int loc);</p>
<h2>DESCRIPTION
<a name="DESCRIPTION"></a>
</h2>
<p style="margin-left:9%; margin-top: 1em"><b>X509v3_get_ext_count()</b>
retrieves the number of extensions in <i>x</i>.</p>
<p style="margin-left:9%; margin-top: 1em"><b>X509v3_get_ext()</b>
retrieves extension <i>loc</i> from <i>x</i>. The index
<i>loc</i> can take any value from 0 to
X509_get_ext_count(<i>x</i>) − 1. The returned
extension is an internal pointer which <b>MUST NOT</b> be
freed by the application.</p>
<p style="margin-left:9%; margin-top: 1em"><b>X509v3_get_ext_by_NID()</b>
and <b>X509v3_get_ext_by_OBJ()</b> look for an extension
with <i>nid</i> or <i>obj</i> from extension STACK <i>x</i>.
The search starts from the extension after <i>lastpos</i> or
from the beginning if <i>lastpos</i> is −1. If the
extension is found, its index is returned, otherwise
−1 is returned.</p>
<p style="margin-left:9%; margin-top: 1em"><b>X509v3_get_ext_by_critical()</b>
is similar to <b>X509v3_get_ext_by_NID()</b> except it looks
for an extension of criticality <i>crit</i>. A zero value
for <i>crit</i> looks for a non−critical extension. A
nonzero value looks for a critical extension.</p>
<p style="margin-left:9%; margin-top: 1em"><b>X509v3_delete_ext()</b>
deletes the extension with index <i>loc</i> from <i>x</i>.
The deleted extension is returned and must be freed by the
caller. If <i>loc</i> is an invalid index value, NULL is
returned.</p>
<p style="margin-left:9%; margin-top: 1em"><b>X509v3_add_ext()</b>
adds extension <i>ex</i> to STACK <i>*x</i> at position
<i>loc</i>. If <i>loc</i> is −1, the new extension is
added to the end. If <i>*x</i> is NULL, a new STACK will be
allocated. The passed extension <i>ex</i> is duplicated
internally so it must be freed after use.</p>
<p style="margin-left:9%; margin-top: 1em"><b>X509_get_ext_count()</b>,
<b>X509_get_ext()</b>, <b>X509_get_ext_by_NID()</b>,
<b>X509_get_ext_by_OBJ()</b>,
<b>X509_get_ext_by_critical()</b>, <b>X509_delete_ext()</b>
and <b>X509_add_ext()</b> operate on the extensions of
certificate <i>x</i>. They are otherwise identical to the
X509v3 functions.</p>
<p style="margin-left:9%; margin-top: 1em"><b>X509_CRL_get_ext_count()</b>,
<b>X509_CRL_get_ext()</b>, <b>X509_CRL_get_ext_by_NID()</b>,
<b>X509_CRL_get_ext_by_OBJ()</b>,
<b>X509_CRL_get_ext_by_critical()</b>,
<b>X509_CRL_delete_ext()</b> and <b>X509_CRL_add_ext()</b>
operate on the extensions of CRL <i>x</i>. They are
otherwise identical to the X509v3 functions.</p>
<p style="margin-left:9%; margin-top: 1em"><b>X509_REVOKED_get_ext_count()</b>,
<b>X509_REVOKED_get_ext()</b>,
<b>X509_REVOKED_get_ext_by_NID()</b>,
<b>X509_REVOKED_get_ext_by_OBJ()</b>,
<b>X509_REVOKED_get_ext_by_critical()</b>,
<b>X509_REVOKED_delete_ext()</b> and
<b>X509_REVOKED_add_ext()</b> operate on the extensions of
CRL entry <i>x</i>. They are otherwise identical to the
X509v3 functions.</p>
<h2>NOTES
<a name="NOTES"></a>
</h2>
<p style="margin-left:9%; margin-top: 1em">These functions
are used to examine stacks of extensions directly.
Applications that want to parse or encode and add an
extension should use the extension encode and decode
functions instead, such as <b>X509_add1_ext_i2d()</b> and
<b>X509_get_ext_d2i()</b>.</p>
<p style="margin-left:9%; margin-top: 1em">For
<b>X509v3_get_ext_by_NID()</b>,
<b>X509v3_get_ext_by_OBJ()</b>,
<b>X509v3_get_ext_by_critical()</b> and its variants, a zero
index return value is not an error since extension STACK
<i>x</i> indices start from zero. These search functions
start from the extension <b>after</b> the <i>lastpos</i>
parameter so it should initially be set to −1. If it
is set to zero, the initial extension will not be
checked.</p>
<p style="margin-left:9%; margin-top: 1em"><b>X509v3_delete_ext()</b>
and its variants are a bit counter−intuitive because
these functions do not free the extension they delete. They
return an <b>X509_EXTENSION</b> object which must be
explicitly freed using <b>X509_EXTENSION_free()</b>.</p>
<h2>RETURN VALUES
<a name="RETURN VALUES"></a>
</h2>
<p style="margin-left:9%; margin-top: 1em"><b>X509v3_get_ext_count()</b>
returns the extension count or 0 for failure.</p>
<p style="margin-left:9%; margin-top: 1em"><b>X509v3_get_ext()</b>,
<b>X509v3_delete_ext()</b> and <b>X509_delete_ext()</b>
return an <b>X509_EXTENSION</b> structure or NULL if an
error occurs.</p>
<p style="margin-left:9%; margin-top: 1em"><b>X509v3_get_ext_by_OBJ()</b>
and <b>X509v3_get_ext_by_critical()</b> return the extension
index or −1 if an error occurs.</p>
<p style="margin-left:9%; margin-top: 1em"><b>X509v3_get_ext_by_NID()</b>
returns the extension index or negative values if an error
occurs.</p>
<p style="margin-left:9%; margin-top: 1em"><b>X509v3_add_ext()</b>
returns a STACK of extensions or NULL on error.</p>
<p style="margin-left:9%; margin-top: 1em"><b>X509_add_ext()</b>
returns 1 on success and 0 on error.</p>
<h2>SEE ALSO
<a name="SEE ALSO"></a>
</h2>
<p style="margin-left:9%; margin-top: 1em"><b>X509V3_get_d2i</b>(3)</p>
<h2>COPYRIGHT
<a name="COPYRIGHT"></a>
</h2>
<p style="margin-left:9%; margin-top: 1em">Copyright
2015−2022 The OpenSSL Project Authors. All Rights
Reserved.</p>
<p style="margin-left:9%; margin-top: 1em">Licensed under
the Apache License 2.0 (the "License"). You may
not use this file except in compliance with the License. You
can obtain a copy in the file LICENSE in the source
distribution or at
&lt;https://www.openssl.org/source/license.html&gt;.</p>
<hr/>
</body>
</html>
