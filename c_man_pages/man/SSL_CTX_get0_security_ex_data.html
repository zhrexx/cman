<!-- Creator     : groff version 1.23.0 -->
<!-- CreationDate: Sat Apr  5 19:53:12 2025 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">

<html>
<head>
<meta content="groff -Thtml, see www.gnu.org" name="generator"/>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<meta content="text/css" name="Content-Style"/>
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title>SSL_CTX_SET_SECURITY_LEVEL</title>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/><style>
            :root {
                --primary-color: #3498db;
                --background-color: #f9f9f9;
                --text-color: #333;
                --code-bg: #f0f0f0;
                --header-color: #2c3e50;
                --link-color: #2980b9;
            }
            body {
                font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
                line-height: 1.6;
                color: var(--text-color);
                background-color: var(--background-color);
                max-width: 900px;
                margin: 0 auto;
                padding: 2rem;
            }
            h1, h2, h3, h4 {
                color: var(--header-color);
            }
            h1 {
                border-bottom: 2px solid var(--primary-color);
                padding-bottom: 0.5rem;
            }
            pre {
                background-color: var(--code-bg);
                padding: 1rem;
                border-radius: 4px;
                overflow-x: auto;
            }
            a {
                color: var(--link-color);
                text-decoration: none;
            }
            a:hover {
                text-decoration: underline;
            }
            .man-navigation {
                background-color: #fff;
                border-bottom: 1px solid #ddd;
                padding: 0.5rem 0;
                position: sticky;
                top: 0;
                z-index: 100;
            }
            .section {
                margin-top: 2rem;
            }
            @media (prefers-color-scheme: dark) {
                :root {
                    --primary-color: #3498db;
                    --background-color: #222;
                    --text-color: #f0f0f0;
                    --code-bg: #333;
                    --header-color: #3498db;
                    --link-color: #5dade2;
                }
            }
            .back-to-index {
                display: inline-block;
                margin: 1rem 0;
                padding: 0.5rem 1rem;
                background-color: var(--primary-color);
                color: white;
                border-radius: 4px;
                text-decoration: none;
            }
            .back-to-index:hover {
                background-color: var(--link-color);
                text-decoration: none;
            }
        </style></head>
<body><div><a class="back-to-index" href="../index.html">← Back to Index</a></div>
<h1 align="center">SSL_CTX_SET_SECURITY_LEVEL</h1>
<a href="#NAME">NAME</a><br/>
<a href="#SYNOPSIS">SYNOPSIS</a><br/>
<a href="#DESCRIPTION">DESCRIPTION</a><br/>
<a href="#DEFAULT CALLBACK BEHAVIOUR">DEFAULT CALLBACK BEHAVIOUR</a><br/>
<a href="#APPLICATION DEFINED SECURITY CALLBACKS">APPLICATION DEFINED SECURITY CALLBACKS</a><br/>
<a href="#NOTES">NOTES</a><br/>
<a href="#RETURN VALUES">RETURN VALUES</a><br/>
<a href="#SEE ALSO">SEE ALSO</a><br/>
<a href="#HISTORY">HISTORY</a><br/>
<a href="#COPYRIGHT">COPYRIGHT</a><br/>
<hr/>
<h2>NAME
<a name="NAME"></a>
</h2>
<p style="margin-left:9%; margin-top: 1em">SSL_CTX_set_security_level,
SSL_set_security_level, SSL_CTX_get_security_level,
SSL_get_security_level, SSL_CTX_set_security_callback,
SSL_set_security_callback, SSL_CTX_get_security_callback,
SSL_get_security_callback, SSL_CTX_set0_security_ex_data,
SSL_set0_security_ex_data, SSL_CTX_get0_security_ex_data,
SSL_get0_security_ex_data − SSL/TLS security
framework</p>
<h2>SYNOPSIS
<a name="SYNOPSIS"></a>
</h2>
<p style="margin-left:9%; margin-top: 1em">#include
&lt;openssl/ssl.h&gt; <br/>
void SSL_CTX_set_security_level(SSL_CTX *ctx, int level);
<br/>
void SSL_set_security_level(SSL *s, int level); <br/>
int SSL_CTX_get_security_level(const SSL_CTX *ctx); <br/>
int SSL_get_security_level(const SSL *s); <br/>
void SSL_CTX_set_security_callback(SSL_CTX *ctx, <br/>
int (*cb)(SSL *s, SSL_CTX *ctx, int op, <br/>
int bits, int nid, <br/>
void *other, void *ex)); <br/>
void SSL_set_security_callback(SSL *s, int (*cb)(SSL *s,
SSL_CTX *ctx, int op, <br/>
int bits, int nid, <br/>
void *other, void *ex)); <br/>
int (*SSL_CTX_get_security_callback(const SSL_CTX *ctx))(SSL
*s, SSL_CTX *ctx, int op, <br/>
int bits, int nid, void *other, <br/>
void *ex); <br/>
int (*SSL_get_security_callback(const SSL *s))(SSL *s,
SSL_CTX *ctx, int op, <br/>
int bits, int nid, void *other, <br/>
void *ex); <br/>
void SSL_CTX_set0_security_ex_data(SSL_CTX *ctx, void *ex);
<br/>
void SSL_set0_security_ex_data(SSL *s, void *ex); <br/>
void *SSL_CTX_get0_security_ex_data(const SSL_CTX *ctx);
<br/>
void *SSL_get0_security_ex_data(const SSL *s);</p>
<h2>DESCRIPTION
<a name="DESCRIPTION"></a>
</h2>
<p style="margin-left:9%; margin-top: 1em">The functions
<b>SSL_CTX_set_security_level()</b> and
<b>SSL_set_security_level()</b> set the security level to
<b>level</b>. If not set the library default security level
is used.</p>
<p style="margin-left:9%; margin-top: 1em">The functions
<b>SSL_CTX_get_security_level()</b> and
<b>SSL_get_security_level()</b> retrieve the current
security level.</p>
<p style="margin-left:9%; margin-top: 1em"><b>SSL_CTX_set_security_callback()</b>,
<b>SSL_set_security_callback()</b>,
<b>SSL_CTX_get_security_callback()</b> and
<b>SSL_get_security_callback()</b> get or set the security
callback associated with <b>ctx</b> or <b>s</b>. If not set
a default security callback is used. The meaning of the
parameters and the behaviour of the default callbacks is
described below.</p>
<p style="margin-left:9%; margin-top: 1em"><b>SSL_CTX_set0_security_ex_data()</b>,
<b>SSL_set0_security_ex_data()</b>,
<b>SSL_CTX_get0_security_ex_data()</b> and
<b>SSL_get0_security_ex_data()</b> set the extra data
pointer passed to the <b>ex</b> parameter of the callback.
This value is passed to the callback verbatim and can be set
to any convenient application specific value.</p>
<h2>DEFAULT CALLBACK BEHAVIOUR
<a name="DEFAULT CALLBACK BEHAVIOUR"></a>
</h2>
<p style="margin-left:9%; margin-top: 1em">If an
application doesn't set its own security callback the
default callback is used. It is intended to provide sane
defaults. The meaning of each level is described below.
<b><br/>
Level 0</b></p>
<p style="margin-left:14%;">Everything is permitted. This
retains compatibility with previous versions of OpenSSL.</p>
<p style="margin-left:9%;"><b>Level 1</b></p>
<p style="margin-left:14%;">The security level corresponds
to a minimum of 80 bits of security. Any parameters offering
below 80 bits of security are excluded. As a result RSA, DSA
and DH keys shorter than 1024 bits and ECC keys shorter than
160 bits are prohibited. Any cipher suite using MD5 for the
MAC is also prohibited. Any cipher suites using CCM with a
64 bit authentication tag are prohibited. Note that
signatures using SHA1 and MD5 are also forbidden at this
level as they have less than 80 security bits. Additionally,
SSLv3, TLS 1.0, TLS 1.1 and DTLS 1.0 are all disabled at
this level.</p>
<p style="margin-left:9%;"><b>Level 2</b></p>
<p style="margin-left:14%;">Security level set to 112 bits
of security. As a result RSA, DSA and DH keys shorter than
2048 bits and ECC keys shorter than 224 bits are prohibited.
In addition to the level 1 exclusions any cipher suite using
RC4 is also prohibited. Compression is disabled.</p>
<p style="margin-left:9%;"><b>Level 3</b></p>
<p style="margin-left:14%;">Security level set to 128 bits
of security. As a result RSA, DSA and DH keys shorter than
3072 bits and ECC keys shorter than 256 bits are prohibited.
In addition to the level 2 exclusions cipher suites not
offering forward secrecy are prohibited. Session tickets are
disabled.</p>
<p style="margin-left:9%;"><b>Level 4</b></p>
<p style="margin-left:14%;">Security level set to 192 bits
of security. As a result RSA, DSA and DH keys shorter than
7680 bits and ECC keys shorter than 384 bits are prohibited.
Cipher suites using SHA1 for the MAC are prohibited.</p>
<p style="margin-left:9%;"><b>Level 5</b></p>
<p style="margin-left:14%;">Security level set to 256 bits
of security. As a result RSA, DSA and DH keys shorter than
15360 bits and ECC keys shorter than 512 bits are
prohibited.</p>
<h2>APPLICATION DEFINED SECURITY CALLBACKS
<a name="APPLICATION DEFINED SECURITY CALLBACKS"></a>
</h2>
<p style="margin-left:9%; margin-top: 1em"><i>Documentation
to be provided.</i></p>
<h2>NOTES
<a name="NOTES"></a>
</h2>
<p style="margin-left:9%; margin-top: 1em">The default
security level can be configured when OpenSSL is compiled by
setting <b>−DOPENSSL_TLS_SECURITY_LEVEL=level</b>. If
not set then 2 is used.</p>
<p style="margin-left:9%; margin-top: 1em">The security
framework disables or reject parameters inconsistent with
the set security level. In the past this was difficult as
applications had to set a number of distinct parameters
(supported ciphers, supported curves supported signature
algorithms) to achieve this end and some cases (DH parameter
size for example) could not be checked at all.</p>
<p style="margin-left:9%; margin-top: 1em">By setting an
appropriate security level much of this complexity can be
avoided.</p>
<p style="margin-left:9%; margin-top: 1em">The bits of
security limits affect all relevant parameters including
cipher suite encryption algorithms, supported ECC curves,
supported signature algorithms, DH parameter sizes,
certificate key sizes and signature algorithms. This limit
applies no matter what other custom settings an application
has set: so if the cipher suite is set to <b>ALL</b> then
only cipher suites consistent with the security level are
permissible.</p>
<p style="margin-left:9%; margin-top: 1em">See
SP800−57 for how the security limits are related to
individual algorithms.</p>
<p style="margin-left:9%; margin-top: 1em">Some security
levels require large key sizes for non−ECC public key
algorithms which can severely degrade performance. For
example 256 bits of security requires the use of RSA keys of
at least 15360 bits in size.</p>
<p style="margin-left:9%; margin-top: 1em">Some
restrictions can be gracefully handled: for example cipher
suites offering insufficient security are not sent by the
client and will not be selected by the server. Other
restrictions such as the peer certificate key size or the DH
parameter size will abort the handshake with a fatal
alert.</p>
<p style="margin-left:9%; margin-top: 1em">Attempts to set
certificates or parameters with insufficient security are
also blocked. For example trying to set a certificate using
a 512 bit RSA key or a certificate with a signature with
SHA1 digest at level 1 using
<b>SSL_CTX_use_certificate()</b>. Applications which do not
check the return values for errors will misbehave: for
example it might appear that a certificate is not set at all
because it had been rejected.</p>
<h2>RETURN VALUES
<a name="RETURN VALUES"></a>
</h2>
<p style="margin-left:9%; margin-top: 1em"><b>SSL_CTX_set_security_level()</b>
and <b>SSL_set_security_level()</b> do not return
values.</p>
<p style="margin-left:9%; margin-top: 1em"><b>SSL_CTX_get_security_level()</b>
and <b>SSL_get_security_level()</b> return a integer that
represents the security level with <b>SSL_CTX</b> or
<b>SSL</b>, respectively.</p>
<p style="margin-left:9%; margin-top: 1em"><b>SSL_CTX_set_security_callback()</b>
and <b>SSL_set_security_callback()</b> do not return
values.</p>
<p style="margin-left:9%; margin-top: 1em"><b>SSL_CTX_get_security_callback()</b>
and <b>SSL_get_security_callback()</b> return the pointer to
the security callback or NULL if the callback is not
set.</p>
<p style="margin-left:9%; margin-top: 1em"><b>SSL_CTX_get0_security_ex_data()</b>
and <b>SSL_get0_security_ex_data()</b> return the extra data
pointer or NULL if the ex data is not set.</p>
<h2>SEE ALSO
<a name="SEE ALSO"></a>
</h2>
<p style="margin-left:9%; margin-top: 1em"><b>ssl</b>(7)</p>
<h2>HISTORY
<a name="HISTORY"></a>
</h2>
<p style="margin-left:9%; margin-top: 1em">These functions
were added in OpenSSL 1.1.0.</p>
<h2>COPYRIGHT
<a name="COPYRIGHT"></a>
</h2>
<p style="margin-left:9%; margin-top: 1em">Copyright
2014−2020 The OpenSSL Project Authors. All Rights
Reserved.</p>
<p style="margin-left:9%; margin-top: 1em">Licensed under
the Apache License 2.0 (the "License"). You may
not use this file except in compliance with the License. You
can obtain a copy in the file LICENSE in the source
distribution or at
&lt;https://www.openssl.org/source/license.html&gt;.</p>
<hr/>
</body>
</html>
