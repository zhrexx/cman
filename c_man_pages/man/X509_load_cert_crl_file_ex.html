<!-- Creator     : groff version 1.23.0 -->
<!-- CreationDate: Sat Apr  5 19:55:02 2025 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">

<html>
<head>
<meta content="groff -Thtml, see www.gnu.org" name="generator"/>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<meta content="text/css" name="Content-Style"/>
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title>X509_LOOKUP_HASH_DIR</title>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/><style>
            :root {
                --primary-color: #3498db;
                --background-color: #f9f9f9;
                --text-color: #333;
                --code-bg: #f0f0f0;
                --header-color: #2c3e50;
                --link-color: #2980b9;
            }
            body {
                font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
                line-height: 1.6;
                color: var(--text-color);
                background-color: var(--background-color);
                max-width: 900px;
                margin: 0 auto;
                padding: 2rem;
            }
            h1, h2, h3, h4 {
                color: var(--header-color);
            }
            h1 {
                border-bottom: 2px solid var(--primary-color);
                padding-bottom: 0.5rem;
            }
            pre {
                background-color: var(--code-bg);
                padding: 1rem;
                border-radius: 4px;
                overflow-x: auto;
            }
            a {
                color: var(--link-color);
                text-decoration: none;
            }
            a:hover {
                text-decoration: underline;
            }
            .man-navigation {
                background-color: #fff;
                border-bottom: 1px solid #ddd;
                padding: 0.5rem 0;
                position: sticky;
                top: 0;
                z-index: 100;
            }
            .section {
                margin-top: 2rem;
            }
            @media (prefers-color-scheme: dark) {
                :root {
                    --primary-color: #3498db;
                    --background-color: #222;
                    --text-color: #f0f0f0;
                    --code-bg: #333;
                    --header-color: #3498db;
                    --link-color: #5dade2;
                }
            }
            .back-to-index {
                display: inline-block;
                margin: 1rem 0;
                padding: 0.5rem 1rem;
                background-color: var(--primary-color);
                color: white;
                border-radius: 4px;
                text-decoration: none;
            }
            .back-to-index:hover {
                background-color: var(--link-color);
                text-decoration: none;
            }
        </style></head>
<body><div><a class="back-to-index" href="../index.html">← Back to Index</a></div>
<h1 align="center">X509_LOOKUP_HASH_DIR</h1>
<a href="#NAME">NAME</a><br/>
<a href="#SYNOPSIS">SYNOPSIS</a><br/>
<a href="#DESCRIPTION">DESCRIPTION</a><br/>
<a href="#File Method">File Method</a><br/>
<a href="#Hashed Directory Method">Hashed Directory Method</a><br/>
<a href="#OSSL_STORE Method">OSSL_STORE Method</a><br/>
<a href="#RETURN VALUES">RETURN VALUES</a><br/>
<a href="#SEE ALSO">SEE ALSO</a><br/>
<a href="#HISTORY">HISTORY</a><br/>
<a href="#COPYRIGHT">COPYRIGHT</a><br/>
<hr/>
<h2>NAME
<a name="NAME"></a>
</h2>
<p style="margin-left:9%; margin-top: 1em">X509_LOOKUP_hash_dir,
X509_LOOKUP_file, X509_LOOKUP_store, X509_load_cert_file_ex,
X509_load_cert_file, X509_load_crl_file,
X509_load_cert_crl_file_ex, X509_load_cert_crl_file −
Default OpenSSL certificate lookup methods</p>
<h2>SYNOPSIS
<a name="SYNOPSIS"></a>
</h2>
<p style="margin-left:9%; margin-top: 1em">#include
&lt;openssl/x509_vfy.h&gt; <br/>
X509_LOOKUP_METHOD *X509_LOOKUP_hash_dir(void); <br/>
X509_LOOKUP_METHOD *X509_LOOKUP_file(void); <br/>
X509_LOOKUP_METHOD *X509_LOOKUP_store(void); <br/>
int X509_load_cert_file_ex(X509_LOOKUP *ctx, const char
*file, int type, <br/>
OSSL_LIB_CTX *libctx, const char *propq); <br/>
int X509_load_cert_file(X509_LOOKUP *ctx, const char *file,
int type); <br/>
int X509_load_crl_file(X509_LOOKUP *ctx, const char *file,
int type); <br/>
int X509_load_cert_crl_file_ex(X509_LOOKUP *ctx, const char
*file, int type, <br/>
OSSL_LIB_CTX *libctx, const char *propq); <br/>
int X509_load_cert_crl_file(X509_LOOKUP *ctx, const char
*file, int type);</p>
<h2>DESCRIPTION
<a name="DESCRIPTION"></a>
</h2>
<p style="margin-left:9%; margin-top: 1em"><b>X509_LOOKUP_hash_dir</b>
and <b>X509_LOOKUP_file</b> are two certificate lookup
methods to use with <b>X509_STORE</b>, provided by OpenSSL
library.</p>
<p style="margin-left:9%; margin-top: 1em">Users of the
library typically do not need to create instances of these
methods manually, they would be created automatically by
<b>X509_STORE_load_locations</b>(3) or
<b>SSL_CTX_load_verify_locations</b>(3) functions.</p>
<p style="margin-left:9%; margin-top: 1em">Internally
loading of certificates and CRLs is implemented via
functions <b>X509_load_cert_crl_file</b>,
<b>X509_load_cert_file</b> and <b>X509_load_crl_file</b>.
These functions support parameter <i>type</i>, which can be
one of constants <b>FILETYPE_PEM</b>, <b>FILETYPE_ASN1</b>
and <b>FILETYPE_DEFAULT</b>. They load certificates and/or
CRLs from specified file into memory cache of
<b>X509_STORE</b> objects which given <b>ctx</b> parameter
is associated with.</p>
<p style="margin-left:9%; margin-top: 1em">Functions
<b>X509_load_cert_file</b> and <b>X509_load_crl_file</b> can
load both PEM and DER formats depending of type value.
Because DER format cannot contain more than one certificate
or CRL object (while PEM can contain several concatenated
PEM objects) <b>X509_load_cert_crl_file</b> with
<b>FILETYPE_ASN1</b> is equivalent to
<b>X509_load_cert_file</b>.</p>
<p style="margin-left:9%; margin-top: 1em">Constant
<b>FILETYPE_DEFAULT</b> with NULL filename causes these
functions to load default certificate store file (see
<b>X509_STORE_set_default_paths</b>(3).</p>
<p style="margin-left:9%; margin-top: 1em">Functions return
number of objects loaded from file or 0 in case of
error.</p>
<p style="margin-left:9%; margin-top: 1em">Both methods
support adding several certificate locations into one
<b>X509_STORE</b>.</p>
<p style="margin-left:9%; margin-top: 1em">This page
documents certificate store formats used by these methods
and caching policy.</p>
<h3>File Method
<a name="File Method"></a>
</h3>
<p style="margin-left:9%; margin-top: 1em">The
<b>X509_LOOKUP_file</b> method loads all the certificates or
CRLs present in a file into memory at the time the file is
added as a lookup source.</p>
<p style="margin-left:9%; margin-top: 1em">File format is
ASCII text which contains concatenated PEM certificates and
CRLs.</p>
<p style="margin-left:9%; margin-top: 1em">This method
should be used by applications which work with a small set
of CAs.</p>
<h3>Hashed Directory Method
<a name="Hashed Directory Method"></a>
</h3>
<p style="margin-left:9%; margin-top: 1em"><b>X509_LOOKUP_hash_dir</b>
is a more advanced method, which loads certificates and CRLs
on demand, and caches them in memory once they are loaded.
As of OpenSSL 1.0.0, it also checks for newer CRLs upon each
lookup, so that newer CRLs are as soon as they appear in the
directory.</p>
<p style="margin-left:9%; margin-top: 1em">The directory
should contain one certificate or CRL per file in PEM
format, with a filename of the form <i>hash</i>.<i>N</i> for
a certificate, or <i>hash</i>.<b>r</b><i>N</i> for a CRL.
The <i>hash</i> is the value returned by the
<b>X509_NAME_hash_ex</b>(3) function applied to the subject
name for certificates or issuer name for CRLs. The hash can
also be obtained via the <b>−hash</b> option of the
<b>openssl−x509</b>(1) or <b>openssl−crl</b>(1)
commands.</p>
<p style="margin-left:9%; margin-top: 1em">The .<i>N</i> or
.<b>r</b><i>N</i> suffix is a sequence number that starts at
zero, and is incremented consecutively for each certificate
or CRL with the same <i>hash</i> value. Gaps in the sequence
numbers are not supported, it is assumed that there are no
more objects with the same hash beyond the first missing
number in the sequence.</p>
<p style="margin-left:9%; margin-top: 1em">Sequence numbers
make it possible for the directory to contain multiple
certificates with same subject name hash value. For example,
it is possible to have in the store several certificates
with same subject or several CRLs with same issuer (and, for
example, different validity period).</p>
<p style="margin-left:9%; margin-top: 1em">When checking
for new CRLs once one CRL for given hash value is loaded,
hash_dir lookup method checks only for certificates with
sequence number greater than that of the already cached
CRL.</p>
<p style="margin-left:9%; margin-top: 1em">Note that the
hash algorithm used for subject name hashing changed in
OpenSSL 1.0.0, and all certificate stores have to be
rehashed when moving from OpenSSL 0.9.8 to 1.0.0.</p>
<p style="margin-left:9%; margin-top: 1em">OpenSSL includes
a <b>openssl−rehash</b>(1) utility which creates
symlinks with hashed names for all files with <i>.pem</i>
suffix in a given directory.</p>
<h3>OSSL_STORE Method
<a name="OSSL_STORE Method"></a>
</h3>
<p style="margin-left:9%; margin-top: 1em"><b>X509_LOOKUP_store</b>
is a method that allows access to any store of certificates
and CRLs through any loader supported by
<b>ossl_store</b>(7). It works with the help of URIs, which
can be direct references to certificates or CRLs, but can
also be references to catalogues of such objects (that
behave like directories).</p>
<p style="margin-left:9%; margin-top: 1em">This method
overlaps the "File Method" and "Hashed
Directory Method" because of the 'file:' scheme loader.
It does no caching of its own, but can use a caching
<b>ossl_store</b>(7) loader, and therefore depends on the
loader's capability.</p>
<h2>RETURN VALUES
<a name="RETURN VALUES"></a>
</h2>
<p style="margin-left:9%; margin-top: 1em"><b>X509_LOOKUP_hash_dir()</b>,
<b>X509_LOOKUP_file()</b> and <b>X509_LOOKUP_store()</b>
always return a valid <b>X509_LOOKUP_METHOD</b>
structure.</p>
<p style="margin-left:9%; margin-top: 1em"><b>X509_load_cert_file()</b>,
<b>X509_load_crl_file()</b> and
<b>X509_load_cert_crl_file()</b> return the number of loaded
objects or 0 on error.</p>
<h2>SEE ALSO
<a name="SEE ALSO"></a>
</h2>
<p style="margin-left:9%; margin-top: 1em"><b>PEM_read_PrivateKey</b>(3),
<b>X509_STORE_load_locations</b>(3),
<b>SSL_CTX_load_verify_locations</b>(3),
<b>X509_LOOKUP_meth_new</b>(3), <b>ossl_store</b>(7)</p>
<h2>HISTORY
<a name="HISTORY"></a>
</h2>
<p style="margin-left:9%; margin-top: 1em">The functions
<b>X509_load_cert_file_ex()</b>,
<b>X509_load_cert_crl_file_ex()</b> and
<b>X509_LOOKUP_store()</b> were added in OpenSSL 3.0.</p>
<h2>COPYRIGHT
<a name="COPYRIGHT"></a>
</h2>
<p style="margin-left:9%; margin-top: 1em">Copyright
2015−2021 The OpenSSL Project Authors. All Rights
Reserved.</p>
<p style="margin-left:9%; margin-top: 1em">Licensed under
the Apache License 2.0 (the "License"). You may
not use this file except in compliance with the License. You
can obtain a copy in the file LICENSE in the source
distribution or at
&lt;https://www.openssl.org/source/license.html&gt;.</p>
<hr/>
</body>
</html>
