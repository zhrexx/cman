<!-- Creator     : groff version 1.23.0 -->
<!-- CreationDate: Sat Apr  5 20:51:12 2025 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">

<html>
<head>
<meta content="groff -Thtml, see www.gnu.org" name="generator"/>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<meta content="text/css" name="Content-Style"/>
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title>SSL_CTX_SET1_CERT_COMP_PREFERENCE</title>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/><style>
            :root {
                --primary-color: #3498db;
                --background-color: #f9f9f9;
                --text-color: #333;
                --code-bg: #f0f0f0;
                --header-color: #2c3e50;
                --link-color: #2980b9;
            }
            body {
                font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
                line-height: 1.6;
                color: var(--text-color);
                background-color: var(--background-color);
                max-width: 900px;
                margin: 0 auto;
                padding: 2rem;
            }
            h1, h2, h3, h4 {
                color: var(--header-color);
            }
            h1 {
                border-bottom: 2px solid var(--primary-color);
                padding-bottom: 0.5rem;
            }
            pre {
                background-color: var(--code-bg);
                padding: 1rem;
                border-radius: 4px;
                overflow-x: auto;
            }
            a {
                color: var(--link-color);
                text-decoration: none;
            }
            a:hover {
                text-decoration: underline;
            }
            .man-navigation {
                background-color: #fff;
                border-bottom: 1px solid #ddd;
                padding: 0.5rem 0;
                position: sticky;
                top: 0;
                z-index: 100;
            }
            .section {
                margin-top: 2rem;
            }
            @media (prefers-color-scheme: dark) {
                :root {
                    --primary-color: #3498db;
                    --background-color: #222;
                    --text-color: #f0f0f0;
                    --code-bg: #333;
                    --header-color: #3498db;
                    --link-color: #5dade2;
                }
            }
            .back-to-index {
                display: inline-block;
                margin: 1rem 0;
                padding: 0.5rem 1rem;
                background-color: var(--primary-color);
                color: white;
                border-radius: 4px;
                text-decoration: none;
            }
            .back-to-index:hover {
                background-color: var(--link-color);
                text-decoration: none;
            }
        </style></head>
<body><div><a class="back-to-index" href="../index.html">← Back to Index</a></div>
<h1 align="center">SSL_CTX_SET1_CERT_COMP_PREFERENCE</h1>
<a href="#NAME">NAME</a><br/>
<a href="#SYNOPSIS">SYNOPSIS</a><br/>
<a href="#DESCRIPTION">DESCRIPTION</a><br/>
<a href="#NOTES">NOTES</a><br/>
<a href="#RETURN VALUES">RETURN VALUES</a><br/>
<a href="#SEE ALSO">SEE ALSO</a><br/>
<a href="#HISTORY">HISTORY</a><br/>
<a href="#COPYRIGHT">COPYRIGHT</a><br/>
<hr/>
<h2>NAME
<a name="NAME"></a>
</h2>
<p style="margin-left:9%; margin-top: 1em">SSL_CTX_set1_cert_comp_preference,
SSL_set1_cert_comp_preference, SSL_CTX_compress_certs,
SSL_compress_certs, SSL_CTX_get1_compressed_cert,
SSL_get1_compressed_cert, SSL_CTX_set1_compressed_cert,
SSL_set1_compressed_cert − Certificate compression
functions</p>
<h2>SYNOPSIS
<a name="SYNOPSIS"></a>
</h2>
<p style="margin-left:9%; margin-top: 1em">#include
&lt;openssl/ssl.h&gt; <br/>
int SSL_CTX_set1_cert_comp_preference(SSL_CTX *ctx, int
*algs, size_t len); <br/>
int SSL_set1_cert_comp_preference(SSL *ssl, int *algs,
size_t len); <br/>
int SSL_CTX_compress_certs(SSL_CTX *ctx, int alg); <br/>
int SSL_compress_certs(SSL *ssl, int alg); <br/>
size_t SSL_CTX_get1_compressed_cert(SSL_CTX *ctx, int alg,
unsigned char **data, <br/>
size_t *orig_len); <br/>
size_t SSL_get1_compressed_cert(SSL *ssl, int alg, unsigned
char **data, <br/>
size_t *orig_len); <br/>
int SSL_CTX_set1_compressed_cert(SSL_CTX *ctx, int alg, <br/>
unsigned char *comp_data, <br/>
size_t comp_length, size_t orig_length); <br/>
int SSL_set1_compressed_cert(SSL *ssl, int alg, unsigned
char *comp_data, <br/>
size_t comp_length, size_t orig_length);</p>
<h2>DESCRIPTION
<a name="DESCRIPTION"></a>
</h2>
<p style="margin-left:9%; margin-top: 1em">These functions
control the certificate compression feature. Certificate
compression is only available for TLSv1.3 as defined in
RFC8879.</p>
<p style="margin-left:9%; margin-top: 1em"><b>SSL_CTX_set1_cert_comp_preference()</b>
and <b>SSL_set1_cert_comp_preference()</b> are used to
specify the preferred compression algorithms. The
<b>algs</b> argument is an array of algorithms, and
<b>length</b> is number of elements in the <b>algs</b>
array. Only those algorithms enabled in the library will be
accepted in <b>algs</b>, unknown algorithms in <b>algs</b>
are ignored. On an error, the preference order is left
unmodified.</p>
<p style="margin-left:9%; margin-top: 1em">The following
compression algorithms (<b>alg</b> arguments) may be
used:</p>
<table border="0" cellpadding="0" cellspacing="0" frame="void" rules="none" width="100%">
<tr align="left" valign="top">
<td width="9%"></td>
<td width="1%">
<p>•</p></td>
<td width="4%"></td>
<td width="30%">
<p>TLSEXT_comp_cert_brotli</p></td>
<td width="56%">
</td></tr>
<tr align="left" valign="top">
<td width="9%"></td>
<td width="1%">
<p>•</p></td>
<td width="4%"></td>
<td width="30%">
<p>TLSEXT_comp_cert_zlib</p></td>
<td width="56%">
</td></tr>
<tr align="left" valign="top">
<td width="9%"></td>
<td width="1%">
<p>•</p></td>
<td width="4%"></td>
<td width="30%">
<p>TLSEXT_comp_cert_zstd</p></td>
<td width="56%">
</td></tr>
</table>
<p style="margin-left:9%; margin-top: 1em">The above is
also the default preference order. If a preference order is
not specified, then the default preference order is sent to
the peer and the received peer's preference order will be
used when compressing a certificate. Otherwise, the
configured preference order is sent to the peer and is used
to filter the peer's preference order.</p>
<p style="margin-left:9%; margin-top: 1em"><b>SSL_CTX_compress_certs()</b>
and <b>SSL_compress_certs()</b> are used to
pre−compress all the configured certificates on an
SSL_CTX/SSL object with algorithm <b>alg</b>. If <b>alg</b>
is 0, then the certificates are compressed with the
algorithms specified in the preference list. Calling these
functions on a client SSL_CTX/SSL object will result in an
error, as only server certificates may be
pre−compressed.</p>
<p style="margin-left:9%; margin-top: 1em"><b>SSL_CTX_get1_compressed_cert()</b>
and <b>SSL_get1_compressed_cert()</b> are used to get the
pre−compressed certificate most recently set that may
be stored for later use. Calling these functions on a client
SSL_CTX/SSL object will result in an error, as only server
certificates may be pre−compressed. The <b>data</b>
and <b>orig_len</b> arguments are required.</p>
<p style="margin-left:9%; margin-top: 1em">The compressed
certificate data may be passed to
<b>SSL_CTX_set1_compressed_cert()</b> or
<b>SSL_set1_compressed_cert()</b> to provide a
pre−compressed version of the most recently set
certificate. This pre−compressed certificate can only
be used by a server.</p>
<h2>NOTES
<a name="NOTES"></a>
</h2>
<p style="margin-left:9%; margin-top: 1em">Each side of the
connection sends their compression algorithm preference list
to their peer indicating compressed certificate support. The
received preference list is filtered by the configured
preference list (i.e. the intersection is saved). As the
default list includes all the enabled algorithms, not
specifying a preference will allow any enabled algorithm by
the peer. The filtered peer's preference order is used to
determine what algorithm to use when sending a compressed
certificate.</p>
<p style="margin-left:9%; margin-top: 1em">Only server
certificates may be pre−compressed. Calling any of
these functions (except
<b>SSL_CTX_set1_cert_comp_preference()</b>/<b>SSL_set1_cert_comp_preference()</b>)
on a client SSL_CTX/SSL object will return an error. Client
certificates are compressed on−demand as unique
context data from the server is compressed along with the
certificate.</p>
<p style="margin-left:9%; margin-top: 1em">For
<b>SSL_CTX_set1_cert_comp_preference()</b> and
<b>SSL_set1_cert_comp_preference()</b> the <b>len</b>
argument is the size of the <b>algs</b> argument in
bytes.</p>
<p style="margin-left:9%; margin-top: 1em">The compressed
certificate returned by
<b>SSL_CTX_get1_compressed_cert()</b> and
<b>SSL_get1_compressed_cert()</b> is the last certificate
set on the SSL_CTX/SSL object. The certificate is copied by
the function and the caller must free <b>*data</b> via
<b>OPENSSL_free()</b>.</p>
<p style="margin-left:9%; margin-top: 1em">The compressed
certificate data set by
<b>SSL_CTX_set1_compressed_cert()</b> and
<b>SSL_set1_compressed_cert()</b> is copied into the
SSL_CTX/SSL object.</p>
<p style="margin-left:9%; margin-top: 1em"><b>SSL_CTX_compress_certs()</b>
and <b>SSL_compress_certs()</b> return an error under the
following conditions:</p>
<table border="0" cellpadding="0" cellspacing="0" frame="void" rules="none" width="100%">
<tr align="left" valign="top">
<td width="9%"></td>
<td width="1%">
<p style="margin-top: 1em">•</p></td>
<td width="4%"></td>
<td width="69%">
<p style="margin-top: 1em">If no certificates have been
configured.</p> </td>
<td width="17%">
</td></tr>
<tr align="left" valign="top">
<td width="9%"></td>
<td width="1%">
<p>•</p></td>
<td width="4%"></td>
<td width="69%">
<p>If the specified algorithm <b>alg</b> is not
enabled.</p> </td>
<td width="17%">
</td></tr>
<tr align="left" valign="top">
<td width="9%"></td>
<td width="1%">
<p>•</p></td>
<td width="4%"></td>
<td width="69%">
<p>If <b>alg</b> is 0 and no compression algorithms are
enabled.</p> </td>
<td width="17%">
</td></tr>
</table>
<p style="margin-left:9%; margin-top: 1em">Sending
compressed certificates may be disabled on a connection via
the SSL_OP_NO_TX_CERTIFICATE_COMPRESSION option. Receiving
compressed certificates may be disabled on a connection via
the SSL_OP_NO_RX_CERTIFICATE_COMPRESSION option.</p>
<h2>RETURN VALUES
<a name="RETURN VALUES"></a>
</h2>
<p style="margin-left:9%; margin-top: 1em"><b>SSL_CTX_set1_cert_comp_preference()</b>,
<b>SSL_set1_cert_comp_preference()</b>,
<b>SSL_CTX_compress_certs()</b>,
<b>SSL_compress_certs()</b>,
<b>SSL_CTX_set1_compressed_cert()</b>, and
<b>SSL_set1_compressed_cert()</b> return 1 for success and 0
on error.</p>
<p style="margin-left:9%; margin-top: 1em"><b>SSL_CTX_get1_compressed_cert()</b>
and <b>SSL_get1_compressed_cert()</b> return the length of
the allocated memory on success and 0 on error.</p>
<h2>SEE ALSO
<a name="SEE ALSO"></a>
</h2>
<p style="margin-left:9%; margin-top: 1em"><b>SSL_CTX_set_options</b>(3),
<b>SSL_CTX_use_certificate</b>(3)</p>
<h2>HISTORY
<a name="HISTORY"></a>
</h2>
<p style="margin-left:9%; margin-top: 1em">These functions
were added in OpenSSL 3.2.</p>
<h2>COPYRIGHT
<a name="COPYRIGHT"></a>
</h2>
<p style="margin-left:9%; margin-top: 1em">Copyright 2022
The OpenSSL Project Authors. All Rights Reserved.</p>
<p style="margin-left:9%; margin-top: 1em">Licensed under
the Apache License 2.0 (the "License"). You may
not use this file except in compliance with the License. You
can obtain a copy in the file LICENSE in the source
distribution or at
&lt;https://www.openssl.org/source/license.html&gt;.</p>
<hr/>
</body>
</html>
