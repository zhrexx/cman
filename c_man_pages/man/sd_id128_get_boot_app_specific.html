<!-- Creator     : groff version 1.23.0 -->
<!-- CreationDate: Sat Apr  5 20:48:52 2025 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">

<html>
<head>
<meta content="groff -Thtml, see www.gnu.org" name="generator"/>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<meta content="text/css" name="Content-Style"/>
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title>SD_ID128_GET_MACHINE</title>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/><style>
            :root {
                --primary-color: #3498db;
                --background-color: #f9f9f9;
                --text-color: #333;
                --code-bg: #f0f0f0;
                --header-color: #2c3e50;
                --link-color: #2980b9;
            }
            body {
                font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
                line-height: 1.6;
                color: var(--text-color);
                background-color: var(--background-color);
                max-width: 900px;
                margin: 0 auto;
                padding: 2rem;
            }
            h1, h2, h3, h4 {
                color: var(--header-color);
            }
            h1 {
                border-bottom: 2px solid var(--primary-color);
                padding-bottom: 0.5rem;
            }
            pre {
                background-color: var(--code-bg);
                padding: 1rem;
                border-radius: 4px;
                overflow-x: auto;
            }
            a {
                color: var(--link-color);
                text-decoration: none;
            }
            a:hover {
                text-decoration: underline;
            }
            .man-navigation {
                background-color: #fff;
                border-bottom: 1px solid #ddd;
                padding: 0.5rem 0;
                position: sticky;
                top: 0;
                z-index: 100;
            }
            .section {
                margin-top: 2rem;
            }
            @media (prefers-color-scheme: dark) {
                :root {
                    --primary-color: #3498db;
                    --background-color: #222;
                    --text-color: #f0f0f0;
                    --code-bg: #333;
                    --header-color: #3498db;
                    --link-color: #5dade2;
                }
            }
            .back-to-index {
                display: inline-block;
                margin: 1rem 0;
                padding: 0.5rem 1rem;
                background-color: var(--primary-color);
                color: white;
                border-radius: 4px;
                text-decoration: none;
            }
            .back-to-index:hover {
                background-color: var(--link-color);
                text-decoration: none;
            }
        </style></head>
<body><div><a class="back-to-index" href="../index.html">← Back to Index</a></div>
<h1 align="center">SD_ID128_GET_MACHINE</h1>
<a href="#NAME">NAME</a><br/>
<a href="#SYNOPSIS">SYNOPSIS</a><br/>
<a href="#DESCRIPTION">DESCRIPTION</a><br/>
<a href="#RETURN VALUE">RETURN VALUE</a><br/>
<a href="#Errors">Errors</a><br/>
<a href="#NOTES">NOTES</a><br/>
<a href="#EXAMPLES">EXAMPLES</a><br/>
<a href="#HISTORY">HISTORY</a><br/>
<a href="#SEE ALSO">SEE ALSO</a><br/>
<a href="#NOTES">NOTES</a><br/>
<hr/>
<h2>NAME
<a name="NAME"></a>
</h2>
<p style="margin-left:9%; margin-top: 1em">sd_id128_get_machine,
sd_id128_get_app_specific,
sd_id128_get_machine_app_specific, sd_id128_get_boot,
sd_id128_get_boot_app_specific, sd_id128_get_invocation
− Retrieve 128−bit IDs</p>
<h2>SYNOPSIS
<a name="SYNOPSIS"></a>
</h2>
<p style="margin-left:9%; margin-top: 1em"><b>#include
&lt;systemd/sd−id128.h&gt;</b></p>
<table border="0" cellpadding="0" cellspacing="0" frame="void" rules="none" width="100%">
<tr align="left" valign="top">
<td width="9%"></td>
<td width="91%">
<p style="margin-top: 1em"><b>int
sd_id128_get_machine(sd_id128_t *</b><i>ret</i><b>);</b></p> </td></tr>
<tr align="left" valign="top">
<td width="9%"></td>
<td width="91%">
<p style="margin-top: 1em"><b>int
sd_id128_get_app_specific(sd_id128_t </b><i>base</i><b>,
sd_id128_t </b><i>app_id</i><b>,
sd_id128_t *</b><i>ret</i><b>);</b></p> </td></tr>
<tr align="left" valign="top">
<td width="9%"></td>
<td width="91%">
<p style="margin-top: 1em"><b>int
sd_id128_get_machine_app_specific(sd_id128_t </b><i>app_id</i><b>,
sd_id128_t *</b><i>ret</i><b>);</b></p> </td></tr>
<tr align="left" valign="top">
<td width="9%"></td>
<td width="91%">
<p style="margin-top: 1em"><b>int
sd_id128_get_boot(sd_id128_t *</b><i>ret</i><b>);</b></p> </td></tr>
<tr align="left" valign="top">
<td width="9%"></td>
<td width="91%">
<p style="margin-top: 1em"><b>int
sd_id128_get_boot_app_specific(sd_id128_t </b><i>app_id</i><b>,
sd_id128_t *</b><i>ret</i><b>);</b></p> </td></tr>
<tr align="left" valign="top">
<td width="9%"></td>
<td width="91%">
<p style="margin-top: 1em"><b>int
sd_id128_get_invocation(sd_id128_t *</b><i>ret</i><b>);</b></p> </td></tr>
<tr align="left" valign="top">
<td width="9%"></td>
<td width="91%">
<p style="margin-top: 1em"><b>int
sd_id128_get_invocation_app_specific(sd_id128_t </b><i>app_id</i><b>,
sd_id128_t *</b><i>ret</i><b>);</b></p> </td></tr>
</table>
<h2>DESCRIPTION
<a name="DESCRIPTION"></a>
</h2>
<p style="margin-left:9%; margin-top: 1em"><b>sd_id128_get_machine()</b>
returns the machine ID of the executing host. This reads and
parses the <b>machine-id</b>(5) file. This function caches
the machine ID internally to make retrieving the machine ID
a cheap operation. This ID may be used wherever a unique
identifier for the local system is needed. However, it is
recommended to use this ID as−is only in trusted
environments. In untrusted environments it is recommended to
derive an application specific ID from this machine ID, in
an irreversible (cryptographically secure) way. To make this
easy <b>sd_id128_get_machine_app_specific()</b> is provided,
see below.</p>
<p style="margin-left:9%; margin-top: 1em"><b>sd_id128_get_app_specific()</b>
returns a machine ID that is a combination of the
<i>base</i> and <i>app_id</i> parameters. Internally, this
function calculates HMAC−SHA256 of the <i>app_id</i>
parameter keyed by the <i>base</i> parameter, and truncates
this result to fit in sd_id128_t and turns it into a valid
Variant 1 Version 4 UUID, in accordance with
<b><font color="#0000FF">RFC 4122</font></b>
<small><font color="#000000">[1]</font></small>
<font color="#000000">. Neither of the two input parameters
can be calculated from the output parameter
<i>ret</i>.</font></p>
<p style="margin-left:9%; margin-top: 1em"><font color="#000000"><b>sd_id128_get_machine_app_specific()</b>
is similar to <b>sd_id128_get_machine()</b>, but retrieves a
machine ID that is specific to the application that is
identified by the indicated application ID. It is
recommended to use this function instead of
<b>sd_id128_get_machine()</b> when passing an ID to
untrusted environments, in order to make sure that the
original machine ID may not be determined externally. This
way, the ID used by the application remains stable on a
given machine, but cannot be easily correlated with IDs used
in other applications on the same machine. The
application−specific ID should be generated via a tool
like <b>systemd−id128 new</b>, and may be compiled
into the application. This function will return the same
application−specific ID for each combination of
machine ID and application ID. Internally, this function
calls <b>sd_id128_get_app_specific()</b> with the result
from <b>sd_id128_get_machine()</b> and the <i>app_id</i>
parameter.</font></p>
<p style="margin-left:9%; margin-top: 1em"><font color="#000000"><b>sd_id128_get_boot()</b>
returns the boot ID of the executing kernel. This reads and
parses the /proc/sys/kernel/random/boot_id file exposed by
the kernel. It is randomly generated early at boot and is
unique for every running kernel instance. See
<b>random</b>(4) for more information. This function also
internally caches the returned ID to make this call a cheap
operation. It is recommended to use this ID as−is only
in trusted environments. In untrusted environments it is
recommended to derive an application specific ID using
<b>sd_id128_get_boot_app_specific()</b>, see
below.</font></p>
<p style="margin-left:9%; margin-top: 1em"><font color="#000000"><b>sd_id128_get_boot_app_specific()</b>
is analogous to <b>sd_id128_get_machine_app_specific()</b>,
but returns an ID that changes between boots. Some machines
may be used for a long time without rebooting, hence the
boot ID may remain constant for a long time, and has
properties similar to the machine ID during that
time.</font></p>
<p style="margin-left:9%; margin-top: 1em"><font color="#000000"><b>sd_id128_get_invocation()</b>
returns the invocation ID of the currently executed service.
In its current implementation, this tries to read and parse
the following:</font></p>
<p style="margin-left:14%; margin-top: 1em"><font color="#000000">•
The <i>$INVOCATION_ID</i> environment variable that the
service manager sets when activating a service.</font></p>
<p style="margin-left:14%; margin-top: 1em"><font color="#000000">•
An entry in the kernel keyring that the system service
manager sets when activating a service.</font></p>
<p style="margin-left:9%; margin-top: 1em"><font color="#000000">See
<b>systemd.exec</b>(5) for details. The ID is cached
internally. In future a different mechanism to determine the
invocation ID may be added.</font></p>
<p style="margin-left:9%; margin-top: 1em"><font color="#000000"><b>sd_id128_get_invocation_app_specific()</b>
derives an application−specific ID from the invocation
ID.</font></p>
<p style="margin-left:9%; margin-top: 1em"><font color="#000000">Note
that <b>sd_id128_get_machine_app_specific()</b>,
<b>sd_id128_get_boot()</b>,
<b>sd_id128_get_boot_app_specific()</b>,
<b>sd_id128_get_invocation()</b> and
<b>sd_id128_get_invocation_app_specific</b> always return
UUID Variant 1 Version 4 compatible IDs.
<b>sd_id128_get_machine()</b> will also return a UUID
Variant 1 Version 4 compatible ID on new installations but
might not on older. It is possible to convert the machine ID
non−reversibly into a UUID Variant 1 Version 4
compatible one. For more information, see
<b>machine-id</b>(5). It is hence guaranteed that these
functions will never return the ID consisting of all zero or
all one bits (<b>SD_ID128_NULL</b>, <b>SD_ID128_ALLF</b>)
— with the possible exception of
<b>sd_id128_get_machine()</b>, as mentioned.</font></p>
<p style="margin-left:9%; margin-top: 1em"><font color="#000000">For
more information about the "sd_id128_t" type see
<b>sd-id128</b>(3).</font></p>
<h2>RETURN VALUE
<a name="RETURN VALUE"></a>
</h2>
<p style="margin-left:9%; margin-top: 1em"><font color="#000000">Those
calls return 0 on success (in which case <i>ret</i> is
filled in), or a negative errno−style error
code.</font></p>
<h3>Errors
<a name="Errors"></a>
</h3>
<p style="margin-left:9%; margin-top: 1em"><font color="#000000">Returned
errors may indicate the following problems:</font></p>
<p style="margin-left:9%; margin-top: 1em"><font color="#000000"><b>−ENOENT</b></font></p>
<p style="margin-left:14%;"><font color="#000000">Returned
by <b>sd_id128_get_machine()</b> and
<b>sd_id128_get_machine_app_specific()</b> when
/etc/machine−id is missing.</font></p>
<p style="margin-left:14%; margin-top: 1em"><font color="#000000">Added
in version 242.</font></p>
<p style="margin-left:9%; margin-top: 1em"><font color="#000000"><b>−ENOMEDIUM</b></font></p>
<p style="margin-left:14%;"><font color="#000000">Returned
by <b>sd_id128_get_machine()</b> and
<b>sd_id128_get_machine_app_specific()</b> when
/etc/machine−id is empty or all zeros. Also returned
by <b>sd_id128_get_invocation()</b> when the invocation ID
is all zeros.</font></p>
<p style="margin-left:14%; margin-top: 1em"><font color="#000000">Added
in version 242.</font></p>
<p style="margin-left:9%; margin-top: 1em"><font color="#000000"><b>−ENOPKG</b></font></p>
<p style="margin-left:14%;"><font color="#000000">Returned
by <b>sd_id128_get_machine()</b> and
<b>sd_id128_get_machine_app_specific()</b> when the content
of /etc/machine−id is
"uninitialized".</font></p>
<p style="margin-left:14%; margin-top: 1em"><font color="#000000">Added
in version 253.</font></p>
<p style="margin-left:9%; margin-top: 1em"><font color="#000000"><b>−ENOSYS</b></font></p>
<p style="margin-left:14%;"><font color="#000000">Returned
by <b>sd_id128_get_boot()</b> and
<b>sd_id128_get_boot_app_specific()</b> when /proc/ is not
mounted.</font></p>
<p style="margin-left:14%; margin-top: 1em"><font color="#000000">Added
in version 253.</font></p>
<p style="margin-left:9%; margin-top: 1em"><font color="#000000"><b>−ENXIO</b></font></p>
<p style="margin-left:14%;"><font color="#000000">Returned
by <b>sd_id128_get_invocation()</b> if no invocation ID is
set. Also returned by <b>sd_id128_get_app_specific()</b>,
<b>sd_id128_get_machine_app_specific()</b>, and
<b>sd_id128_get_boot_app_specific()</b> when the
<i>app_id</i> parameter is all zeros.</font></p>
<p style="margin-left:14%; margin-top: 1em"><font color="#000000">Added
in version 242.</font></p>
<p style="margin-left:9%; margin-top: 1em"><font color="#000000"><b>−EUCLEAN</b></font></p>
<p style="margin-left:14%;"><font color="#000000">Returned
by any of the functions described here when the configured
value has invalid format.</font></p>
<p style="margin-left:14%; margin-top: 1em"><font color="#000000">Added
in version 253.</font></p>
<p style="margin-left:9%; margin-top: 1em"><font color="#000000"><b>−EPERM</b></font></p>
<p style="margin-left:14%;"><font color="#000000">Requested
information could not be retrieved because of insufficient
permissions.</font></p>
<p style="margin-left:14%; margin-top: 1em"><font color="#000000">Added
in version 242.</font></p>
<h2>NOTES
<a name="NOTES"></a>
</h2>
<p style="margin-left:9%; margin-top: 1em"><font color="#000000">Functions
described here are available as a shared library, which can
be compiled against and linked to with the
<b>libsystemd pkg-config</b>(1) file.</font></p>
<p style="margin-left:9%; margin-top: 1em"><font color="#000000">The
code described here uses <b>getenv</b>(3), which is declared
to be not multi−thread−safe. This means that the
code calling the functions described here must not call
<b>setenv</b>(3) from a parallel thread. It is recommended
to only do calls to <b>setenv()</b> from an early phase of
the program when no other threads have been
started.</font></p>
<h2>EXAMPLES
<a name="EXAMPLES"></a>
</h2>
<p style="margin-left:9%; margin-top: 1em"><font color="#000000"><b>Example 1. Application−specific
machine ID</b></font></p>
<p style="margin-left:9%; margin-top: 1em"><font color="#000000">First,
generate the application ID:</font></p>
<p style="margin-left:14%; margin-top: 1em"><font color="#000000">$
systemd−id128 −p new <br/>
As string: <br/>
c273277323db454ea63bb96e79b53e97</font></p>
<p style="margin-left:14%; margin-top: 1em"><font color="#000000">As
UUID: <br/>

c2732773−23db−454e−a63b−b96e79b53e97</font></p>
<p style="margin-left:14%; margin-top: 1em"><font color="#000000">As
man:sd−id128(3) macro: <br/>
#define MESSAGE_XYZ
SD_ID128_MAKE(c2,73,27,73,23,db,45,4e,a6,3b,b9,6e,79,b5,3e,97)
<br/>
...</font></p>
<p style="margin-left:9%; margin-top: 1em"><font color="#000000">Then
use the new identifier in an example application:</font></p>
<p style="margin-left:14%; margin-top: 1em"><font color="#000000">/*
SPDX−License−Identifier: MIT−0
*/</font></p>
<p style="margin-left:14%; margin-top: 1em"><font color="#000000">#include
&lt;stdio.h&gt; <br/>
#include &lt;systemd/sd−id128.h&gt;</font></p>
<p style="margin-left:14%; margin-top: 1em"><font color="#000000">#define
OUR_APPLICATION_ID
SD_ID128_MAKE(c2,73,27,73,23,db,45,4e,a6,3b,b9,6e,79,b5,3e,97)</font></p>
<p style="margin-left:14%; margin-top: 1em"><font color="#000000">int
main(int argc, char *argv[]) { <br/>
sd_id128_t id; <br/>
sd_id128_get_machine_app_specific(OUR_APPLICATION_ID,
&amp;id); <br/>
printf("Our application ID: " SD_ID128_FORMAT_STR
"\n", SD_ID128_FORMAT_VAL(id)); <br/>
return 0; <br/>
}</font></p>
<h2>HISTORY
<a name="HISTORY"></a>
</h2>
<p style="margin-left:9%; margin-top: 1em"><font color="#000000"><b>sd_id128_get_machine()</b>
and <b>sd_id128_get_boot()</b> were added in version
187.</font></p>
<p style="margin-left:9%; margin-top: 1em"><font color="#000000"><b>sd_id128_get_invocation()</b>
was added in version 232.</font></p>
<p style="margin-left:9%; margin-top: 1em"><font color="#000000"><b>sd_id128_get_machine_app_specific()</b>
was added in version 233.</font></p>
<p style="margin-left:9%; margin-top: 1em"><font color="#000000"><b>sd_id128_get_boot_app_specific()</b>
was added in version 240.</font></p>
<p style="margin-left:9%; margin-top: 1em"><font color="#000000"><b>sd_id128_get_app_specific()</b>
was added in version 255.</font></p>
<p style="margin-left:9%; margin-top: 1em"><font color="#000000"><b>sd_id128_get_invocation_app_specific()</b>
was added in version 256.</font></p>
<h2>SEE ALSO
<a name="SEE ALSO"></a>
</h2>
<p style="margin-left:9%; margin-top: 1em"><font color="#000000"><b>systemd</b>(1),
<b>systemd-id128</b>(1), <b>sd-id128</b>(3),
<b>machine-id</b>(5), <b>systemd.exec</b>(5),
<b>sd_id128_randomize</b>(3), <b>random</b>(4)</font></p>
<h2>NOTES
<a name="NOTES"></a>
</h2>
<table border="0" cellpadding="0" cellspacing="0" frame="void" rules="none" width="100%">
<tr align="left" valign="top">
<td width="10%"></td>
<td width="3%">
<p style="margin-top: 1em"><font color="#000000">1.</font></p> </td>
<td width="1%"></td>
<td width="10%">
<p style="margin-top: 1em"><font color="#000000">RFC
4122</font></p> </td>
<td width="76%">
</td></tr>
</table>
<p style="margin-left:14%;"><font color="#000000">https://tools.ietf.org/html/rfc4122</font></p>
<hr/>
</body>
</html>
