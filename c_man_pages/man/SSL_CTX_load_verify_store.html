<!-- Creator     : groff version 1.23.0 -->
<!-- CreationDate: Sat Apr  5 19:53:14 2025 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">

<html>
<head>
<meta content="groff -Thtml, see www.gnu.org" name="generator"/>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<meta content="text/css" name="Content-Style"/>
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title>SSL_CTX_LOAD_VERIFY_LOCATIONS</title>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/><style>
            :root {
                --primary-color: #3498db;
                --background-color: #f9f9f9;
                --text-color: #333;
                --code-bg: #f0f0f0;
                --header-color: #2c3e50;
                --link-color: #2980b9;
            }
            body {
                font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
                line-height: 1.6;
                color: var(--text-color);
                background-color: var(--background-color);
                max-width: 900px;
                margin: 0 auto;
                padding: 2rem;
            }
            h1, h2, h3, h4 {
                color: var(--header-color);
            }
            h1 {
                border-bottom: 2px solid var(--primary-color);
                padding-bottom: 0.5rem;
            }
            pre {
                background-color: var(--code-bg);
                padding: 1rem;
                border-radius: 4px;
                overflow-x: auto;
            }
            a {
                color: var(--link-color);
                text-decoration: none;
            }
            a:hover {
                text-decoration: underline;
            }
            .man-navigation {
                background-color: #fff;
                border-bottom: 1px solid #ddd;
                padding: 0.5rem 0;
                position: sticky;
                top: 0;
                z-index: 100;
            }
            .section {
                margin-top: 2rem;
            }
            @media (prefers-color-scheme: dark) {
                :root {
                    --primary-color: #3498db;
                    --background-color: #222;
                    --text-color: #f0f0f0;
                    --code-bg: #333;
                    --header-color: #3498db;
                    --link-color: #5dade2;
                }
            }
            .back-to-index {
                display: inline-block;
                margin: 1rem 0;
                padding: 0.5rem 1rem;
                background-color: var(--primary-color);
                color: white;
                border-radius: 4px;
                text-decoration: none;
            }
            .back-to-index:hover {
                background-color: var(--link-color);
                text-decoration: none;
            }
        </style></head>
<body><div><a class="back-to-index" href="../index.html">← Back to Index</a></div>
<h1 align="center">SSL_CTX_LOAD_VERIFY_LOCATIONS</h1>
<a href="#NAME">NAME</a><br/>
<a href="#SYNOPSIS">SYNOPSIS</a><br/>
<a href="#DESCRIPTION">DESCRIPTION</a><br/>
<a href="#NOTES">NOTES</a><br/>
<a href="#WARNINGS">WARNINGS</a><br/>
<a href="#RETURN VALUES">RETURN VALUES</a><br/>
<a href="#EXAMPLES">EXAMPLES</a><br/>
<a href="#SEE ALSO">SEE ALSO</a><br/>
<a href="#COPYRIGHT">COPYRIGHT</a><br/>
<hr/>
<h2>NAME
<a name="NAME"></a>
</h2>
<p style="margin-left:9%; margin-top: 1em">SSL_CTX_load_verify_dir,
SSL_CTX_load_verify_file, SSL_CTX_load_verify_store,
SSL_CTX_set_default_verify_paths,
SSL_CTX_set_default_verify_dir,
SSL_CTX_set_default_verify_file,
SSL_CTX_set_default_verify_store,
SSL_CTX_load_verify_locations − set default locations
for trusted CA certificates</p>
<h2>SYNOPSIS
<a name="SYNOPSIS"></a>
</h2>
<p style="margin-left:9%; margin-top: 1em">#include
&lt;openssl/ssl.h&gt; <br/>
int SSL_CTX_load_verify_dir(SSL_CTX *ctx, const char
*CApath); <br/>
int SSL_CTX_load_verify_file(SSL_CTX *ctx, const char
*CAfile); <br/>
int SSL_CTX_load_verify_store(SSL_CTX *ctx, const char
*CAstore); <br/>
int SSL_CTX_set_default_verify_paths(SSL_CTX *ctx); <br/>
int SSL_CTX_set_default_verify_dir(SSL_CTX *ctx); <br/>
int SSL_CTX_set_default_verify_file(SSL_CTX *ctx); <br/>
int SSL_CTX_set_default_verify_store(SSL_CTX *ctx); <br/>
int SSL_CTX_load_verify_locations(SSL_CTX *ctx, const char
*CAfile, <br/>
const char *CApath);</p>
<h2>DESCRIPTION
<a name="DESCRIPTION"></a>
</h2>
<p style="margin-left:9%; margin-top: 1em"><b>SSL_CTX_load_verify_locations()</b>,
<b>SSL_CTX_load_verify_dir()</b>,
<b>SSL_CTX_load_verify_file()</b>,
<b>SSL_CTX_load_verify_store()</b> specifies the locations
for <b>ctx</b>, at which CA certificates for verification
purposes are located. The certificates available via
<b>CAfile</b>, <b>CApath</b> and <b>CAstore</b> are
trusted.</p>
<p style="margin-left:9%; margin-top: 1em">Details of the
certificate verification and chain checking process are
described in "Certification Path Validation" in
<b>openssl−verification−options</b>(1).</p>
<p style="margin-left:9%; margin-top: 1em"><b>SSL_CTX_set_default_verify_paths()</b>
specifies that the default locations from which CA
certificates are loaded should be used. There is one default
directory, one default file and one default store. The
default CA certificates directory is called <i>certs</i> in
the default OpenSSL directory, and this is also the default
store. Alternatively the <b>SSL_CERT_DIR</b> environment
variable can be defined to override this location. The
default CA certificates file is called <i>cert.pem</i> in
the default OpenSSL directory. Alternatively the
<b>SSL_CERT_FILE</b> environment variable can be defined to
override this location.</p>
<p style="margin-left:9%; margin-top: 1em"><b>SSL_CTX_set_default_verify_dir()</b>
is similar to <b>SSL_CTX_set_default_verify_paths()</b>
except that just the default directory is used.</p>
<p style="margin-left:9%; margin-top: 1em"><b>SSL_CTX_set_default_verify_file()</b>
is similar to <b>SSL_CTX_set_default_verify_paths()</b>
except that just the default file is used.</p>
<p style="margin-left:9%; margin-top: 1em"><b>SSL_CTX_set_default_verify_store()</b>
is similar to <b>SSL_CTX_set_default_verify_paths()</b>
except that just the default store is used.</p>
<h2>NOTES
<a name="NOTES"></a>
</h2>
<p style="margin-left:9%; margin-top: 1em">If <b>CAfile</b>
is not NULL, it points to a file of CA certificates in PEM
format. The file can contain several CA certificates
identified by</p>
<p style="margin-left:9%; margin-top: 1em">−−−−−BEGIN
CERTIFICATE−−−−− <br/>
... (CA certificate in base64 encoding) ... <br/>
−−−−−END
CERTIFICATE−−−−−</p>
<p style="margin-left:9%; margin-top: 1em">sequences.
Before, between, and after the certificates text is allowed
which can be used e.g. for descriptions of the
certificates.</p>
<p style="margin-left:9%; margin-top: 1em">The
<b>CAfile</b> is processed on execution of the
<b>SSL_CTX_load_verify_locations()</b> function.</p>
<p style="margin-left:9%; margin-top: 1em">If <b>CApath</b>
is not NULL, it points to a directory containing CA
certificates in PEM format. The files each contain one CA
certificate. The files are looked up by the CA subject name
hash value, which must hence be available. If more than one
CA certificate with the same name hash value exist, the
extension must be different (e.g. 9d66eef0.0, 9d66eef0.1
etc). The search is performed in the ordering of the
extension number, regardless of other properties of the
certificates. Use the <b>c_rehash</b> utility to create the
necessary links.</p>
<p style="margin-left:9%; margin-top: 1em">The certificates
in <b>CApath</b> are only looked up when required, e.g. when
building the certificate chain or when actually performing
the verification of a peer certificate.</p>
<p style="margin-left:9%; margin-top: 1em">When looking up
CA certificates for chain building, the OpenSSL library will
search for suitable certificates first in <b>CAfile</b>,
then in <b>CApath</b>. Details of the chain building process
are described in "Certification Path Building" in
<b>openssl−verification−options</b>(1).</p>
<p style="margin-left:9%; margin-top: 1em">If
<b>CAstore</b> is not NULL, it's a URI for to a store, which
may represent a single container or a whole catalogue of
containers. Apart from the <b>CAstore</b> not necessarily
being a local file or directory, it's generally treated the
same way as a <b>CApath</b>.</p>
<p style="margin-left:9%; margin-top: 1em">In server mode,
when requesting a client certificate, the server must send
the list of CAs of which it will accept client certificates.
This list is not influenced by the contents of <b>CAfile</b>
or <b>CApath</b> and must explicitly be set using the
<b>SSL_CTX_set_client_CA_list</b>(3) family of
functions.</p>
<p style="margin-left:9%; margin-top: 1em">When building
its own certificate chain, an OpenSSL client/server will try
to fill in missing certificates from
<b>CAfile</b>/<b>CApath</b>, if the certificate chain was
not explicitly specified (see
<b>SSL_CTX_add_extra_chain_cert</b>(3),
<b>SSL_CTX_use_certificate</b>(3).</p>
<h2>WARNINGS
<a name="WARNINGS"></a>
</h2>
<p style="margin-left:9%; margin-top: 1em">If several CA
certificates matching the name, key identifier, and serial
number condition are available, only the first one will be
examined. This may lead to unexpected results if the same CA
certificate is available with different expiration dates. If
a "certificate expired" verification error occurs,
no other certificate will be searched. Make sure to not have
expired certificates mixed with valid ones.</p>
<h2>RETURN VALUES
<a name="RETURN VALUES"></a>
</h2>
<p style="margin-left:9%; margin-top: 1em">For
SSL_CTX_load_verify_locations the following return values
can occur:</p>
<table border="0" cellpadding="0" cellspacing="0" frame="void" rules="none" width="100%">
<tr align="left" valign="top">
<td width="9%"></td>
<td width="1%">
<p>0</p></td>
<td width="4%"></td>
<td width="80%">
<p>The operation failed because <b>CAfile</b> and
<b>CApath</b> are NULL or the processing at one of the
locations specified failed. Check the error stack to find
out the reason.</p></td>
<td width="6%">
</td></tr>
<tr align="left" valign="top">
<td width="9%"></td>
<td width="1%">
<p>1</p></td>
<td width="4%"></td>
<td width="80%">
<p>The operation succeeded.</p></td>
<td width="6%">
</td></tr>
</table>
<p style="margin-left:9%; margin-top: 1em"><b>SSL_CTX_set_default_verify_paths()</b>,
<b>SSL_CTX_set_default_verify_dir()</b> and
<b>SSL_CTX_set_default_verify_file()</b> all return 1 on
success or 0 on failure. A missing default location is still
treated as a success.</p>
<h2>EXAMPLES
<a name="EXAMPLES"></a>
</h2>
<p style="margin-left:9%; margin-top: 1em">Generate a CA
certificate file with descriptive text from the CA
certificates ca1.pem ca2.pem ca3.pem:</p>
<p style="margin-left:9%; margin-top: 1em">#!/bin/sh <br/>
rm CAfile.pem <br/>
for i in ca1.pem ca2.pem ca3.pem ; do <br/>
openssl x509 −in $i −text &gt;&gt; CAfile.pem
<br/>
done</p>
<p style="margin-left:9%; margin-top: 1em">Prepare the
directory /some/where/certs containing several CA
certificates for use as <b>CApath</b>:</p>
<p style="margin-left:9%; margin-top: 1em">cd
/some/where/certs <br/>
c_rehash .</p>
<h2>SEE ALSO
<a name="SEE ALSO"></a>
</h2>
<p style="margin-left:9%; margin-top: 1em"><b>ssl</b>(7),
<b>SSL_CTX_set_client_CA_list</b>(3),
<b>SSL_get_client_CA_list</b>(3),
<b>SSL_CTX_use_certificate</b>(3),
<b>SSL_CTX_add_extra_chain_cert</b>(3),
<b>SSL_CTX_set_cert_store</b>(3),
<b>SSL_CTX_set_client_CA_list</b>(3)</p>
<h2>COPYRIGHT
<a name="COPYRIGHT"></a>
</h2>
<p style="margin-left:9%; margin-top: 1em">Copyright
2000−2021 The OpenSSL Project Authors. All Rights
Reserved.</p>
<p style="margin-left:9%; margin-top: 1em">Licensed under
the Apache License 2.0 (the "License"). You may
not use this file except in compliance with the License. You
can obtain a copy in the file LICENSE in the source
distribution or at
&lt;https://www.openssl.org/source/license.html&gt;.</p>
<hr/>
</body>
</html>
