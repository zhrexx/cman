<!-- Creator     : groff version 1.23.0 -->
<!-- CreationDate: Sat Apr  5 19:41:31 2025 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">

<html>
<head>
<meta content="groff -Thtml, see www.gnu.org" name="generator"/>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<meta content="text/css" name="Content-Style"/>
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title>avc_cache_stats</title>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/><style>
            :root {
                --primary-color: #3498db;
                --background-color: #f9f9f9;
                --text-color: #333;
                --code-bg: #f0f0f0;
                --header-color: #2c3e50;
                --link-color: #2980b9;
            }
            body {
                font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
                line-height: 1.6;
                color: var(--text-color);
                background-color: var(--background-color);
                max-width: 900px;
                margin: 0 auto;
                padding: 2rem;
            }
            h1, h2, h3, h4 {
                color: var(--header-color);
            }
            h1 {
                border-bottom: 2px solid var(--primary-color);
                padding-bottom: 0.5rem;
            }
            pre {
                background-color: var(--code-bg);
                padding: 1rem;
                border-radius: 4px;
                overflow-x: auto;
            }
            a {
                color: var(--link-color);
                text-decoration: none;
            }
            a:hover {
                text-decoration: underline;
            }
            .man-navigation {
                background-color: #fff;
                border-bottom: 1px solid #ddd;
                padding: 0.5rem 0;
                position: sticky;
                top: 0;
                z-index: 100;
            }
            .section {
                margin-top: 2rem;
            }
            @media (prefers-color-scheme: dark) {
                :root {
                    --primary-color: #3498db;
                    --background-color: #222;
                    --text-color: #f0f0f0;
                    --code-bg: #333;
                    --header-color: #3498db;
                    --link-color: #5dade2;
                }
            }
            .back-to-index {
                display: inline-block;
                margin: 1rem 0;
                padding: 0.5rem 1rem;
                background-color: var(--primary-color);
                color: white;
                border-radius: 4px;
                text-decoration: none;
            }
            .back-to-index:hover {
                background-color: var(--link-color);
                text-decoration: none;
            }
        </style></head>
<body><div><a class="back-to-index" href="../index.html">← Back to Index</a></div>
<h1 align="center">avc_cache_stats</h1>
<a href="#NAME">NAME</a><br/>
<a href="#SYNOPSIS">SYNOPSIS</a><br/>
<a href="#DESCRIPTION">DESCRIPTION</a><br/>
<a href="#NOTES">NOTES</a><br/>
<a href="#AUTHOR">AUTHOR</a><br/>
<a href="#SEE ALSO">SEE ALSO</a><br/>
<hr/>
<h2>NAME
<a name="NAME"></a>
</h2>
<p style="margin-left:9%; margin-top: 1em">avc_cache_stats,
avc_av_stats, avc_sid_stats − obtain userspace SELinux
AVC statistics</p>
<h2>SYNOPSIS
<a name="SYNOPSIS"></a>
</h2>
<p style="margin-left:9%; margin-top: 1em"><b>#include
&lt;selinux/selinux.h&gt; <br/>
#include &lt;selinux/avc.h&gt;</b></p>
<p style="margin-left:9%; margin-top: 1em"><b>void
avc_av_stats(void);</b></p>
<p style="margin-left:9%; margin-top: 1em"><b>void
avc_sid_stats(void);</b></p>
<p style="margin-left:9%; margin-top: 1em"><b>void
avc_cache_stats(struct avc_cache_stats
*</b><i>stats</i><b>);</b></p>
<h2>DESCRIPTION
<a name="DESCRIPTION"></a>
</h2>
<p style="margin-left:9%; margin-top: 1em">The userspace
AVC maintains two internal hash tables, one to store
security ID’s and one to cache access decisions.</p>
<p style="margin-left:9%; margin-top: 1em"><b>avc_av_stats</b>()
and <b>avc_sid_stats</b>() produce log messages indicating
the status of the access decision and SID tables,
respectively. The messages contain the number of entries in
the table, number of hash buckets and number of buckets
used, and maximum number of entries in a single bucket.</p>
<p style="margin-left:9%; margin-top: 1em"><b>avc_cache_stats</b>()
populates a structure whose fields reflect cache
activity:</p>
<p style="margin-left:18%; margin-top: 1em">struct
avc_cache_stats {</p>
<table border="0" cellpadding="0" cellspacing="0" frame="void" rules="none" width="100%">
<tr align="left" valign="top">
<td width="5%"></td>
<td width="13%"></td>
<td width="82%">
</td></tr>
<tr align="left" valign="top">
<td width="5%"></td>
<td width="13%"></td>
<td width="82%">
<p>unsigned</p></td></tr>
<tr align="left" valign="top">
<td width="5%"></td>
<td width="13%"></td>
<td width="82%">
<p>entry_lookups;</p></td></tr>
<tr align="left" valign="top">
<td width="5%"></td>
<td width="13%"></td>
<td width="82%">
</td></tr>
<tr align="left" valign="top">
<td width="5%"></td>
<td width="13%"></td>
<td width="82%">
<p>unsigned</p></td></tr>
<tr align="left" valign="top">
<td width="5%"></td>
<td width="13%"></td>
<td width="82%">
<p>entry_hits;</p></td></tr>
<tr align="left" valign="top">
<td width="5%"></td>
<td width="13%"></td>
<td width="82%">
</td></tr>
<tr align="left" valign="top">
<td width="5%"></td>
<td width="13%"></td>
<td width="82%">
<p>unsigned</p></td></tr>
<tr align="left" valign="top">
<td width="5%"></td>
<td width="13%"></td>
<td width="82%">
<p>entry_misses;</p></td></tr>
<tr align="left" valign="top">
<td width="5%"></td>
<td width="13%"></td>
<td width="82%">
</td></tr>
<tr align="left" valign="top">
<td width="5%"></td>
<td width="13%"></td>
<td width="82%">
<p>unsigned</p></td></tr>
<tr align="left" valign="top">
<td width="5%"></td>
<td width="13%"></td>
<td width="82%">
<p>entry_discards;</p></td></tr>
<tr align="left" valign="top">
<td width="5%"></td>
<td width="13%"></td>
<td width="82%">
</td></tr>
<tr align="left" valign="top">
<td width="5%"></td>
<td width="13%"></td>
<td width="82%">
<p>unsigned</p></td></tr>
<tr align="left" valign="top">
<td width="5%"></td>
<td width="13%"></td>
<td width="82%">
<p>cav_lookups;</p></td></tr>
<tr align="left" valign="top">
<td width="5%"></td>
<td width="13%"></td>
<td width="82%">
</td></tr>
<tr align="left" valign="top">
<td width="5%"></td>
<td width="13%"></td>
<td width="82%">
<p>unsigned</p></td></tr>
<tr align="left" valign="top">
<td width="5%"></td>
<td width="13%"></td>
<td width="82%">
<p>cav_hits;</p></td></tr>
<tr align="left" valign="top">
<td width="5%"></td>
<td width="13%"></td>
<td width="82%">
</td></tr>
<tr align="left" valign="top">
<td width="5%"></td>
<td width="13%"></td>
<td width="82%">
<p>unsigned</p></td></tr>
<tr align="left" valign="top">
<td width="5%"></td>
<td width="13%"></td>
<td width="82%">
<p>cav_probes;</p></td></tr>
<tr align="left" valign="top">
<td width="5%"></td>
<td width="13%"></td>
<td width="82%">
</td></tr>
<tr align="left" valign="top">
<td width="5%"></td>
<td width="13%"></td>
<td width="82%">
<p>unsigned</p></td></tr>
<tr align="left" valign="top">
<td width="5%"></td>
<td width="13%"></td>
<td width="82%">
<p>cav_misses;</p></td></tr>
</table>
<p style="margin-left:18%;">};</p>
<p style="margin-left:9%;"><i>entry_lookups</i></p>
<p style="margin-left:18%;">Number of queries made.</p>
<p style="margin-left:9%;"><i>entry_hits</i></p>
<p style="margin-left:18%;">Number of times a decision was
found in the <i>aeref</i> argument.</p>
<p style="margin-left:9%;"><i>entry_misses</i></p>
<p style="margin-left:18%;">Number of times a decision was
not found in the <i>aeref</i> argument.</p>
<p style="margin-left:9%;"><i>entry_discards</i></p>
<p style="margin-left:18%;">Number of times a decision was
not found in the <i>aeref</i> argument and the <i>aeref</i>
argument was non-NULL.</p>
<p style="margin-left:9%;"><i>cav_lookups</i></p>
<p style="margin-left:18%;">Number of cache lookups.</p>
<p style="margin-left:9%;"><i>cav_hits</i></p>
<p style="margin-left:18%;">Number of cache hits.</p>
<p style="margin-left:9%;"><i>cav_misses</i></p>
<p style="margin-left:18%;">Number of cache misses.</p>
<p style="margin-left:9%;"><i>cav_probes</i></p>
<p style="margin-left:18%;">Number of entries examined
while searching the cache.</p>
<h2>NOTES
<a name="NOTES"></a>
</h2>
<p style="margin-left:9%; margin-top: 1em">When the cache
is flushed as a result of a call to <b>avc_reset</b>() or a
policy change notification, the statistics returned by
<b>avc_cache_stats</b>() are reset to zero. The SID table,
however, is left unchanged.</p>
<p style="margin-left:9%; margin-top: 1em">When a policy
change notification is received, a call to
<b>avc_av_stats</b>() is made before the cache is
flushed.</p>
<h2>AUTHOR
<a name="AUTHOR"></a>
</h2>
<p style="margin-left:9%; margin-top: 1em">Eamon Walsh
&lt;ewalsh@tycho.nsa.gov&gt;</p>
<h2>SEE ALSO
<a name="SEE ALSO"></a>
</h2>
<p style="margin-left:9%; margin-top: 1em"><b>avc_init</b>(3),
<b>avc_has_perm</b>(3), <b>avc_context_to_sid</b>(3),
<b>avc_add_callback</b>(3), <b>selinux</b>(8)</p>
<hr/>
</body>
</html>
