<!-- Creator     : groff version 1.23.0 -->
<!-- CreationDate: Sat Apr  5 19:42:11 2025 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">

<html>
<head>
<meta content="groff -Thtml, see www.gnu.org" name="generator"/>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<meta content="text/css" name="Content-Style"/>
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title>CMS_SIGNED_GET_ATTR</title>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/><style>
            :root {
                --primary-color: #3498db;
                --background-color: #f9f9f9;
                --text-color: #333;
                --code-bg: #f0f0f0;
                --header-color: #2c3e50;
                --link-color: #2980b9;
            }
            body {
                font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
                line-height: 1.6;
                color: var(--text-color);
                background-color: var(--background-color);
                max-width: 900px;
                margin: 0 auto;
                padding: 2rem;
            }
            h1, h2, h3, h4 {
                color: var(--header-color);
            }
            h1 {
                border-bottom: 2px solid var(--primary-color);
                padding-bottom: 0.5rem;
            }
            pre {
                background-color: var(--code-bg);
                padding: 1rem;
                border-radius: 4px;
                overflow-x: auto;
            }
            a {
                color: var(--link-color);
                text-decoration: none;
            }
            a:hover {
                text-decoration: underline;
            }
            .man-navigation {
                background-color: #fff;
                border-bottom: 1px solid #ddd;
                padding: 0.5rem 0;
                position: sticky;
                top: 0;
                z-index: 100;
            }
            .section {
                margin-top: 2rem;
            }
            @media (prefers-color-scheme: dark) {
                :root {
                    --primary-color: #3498db;
                    --background-color: #222;
                    --text-color: #f0f0f0;
                    --code-bg: #333;
                    --header-color: #3498db;
                    --link-color: #5dade2;
                }
            }
            .back-to-index {
                display: inline-block;
                margin: 1rem 0;
                padding: 0.5rem 1rem;
                background-color: var(--primary-color);
                color: white;
                border-radius: 4px;
                text-decoration: none;
            }
            .back-to-index:hover {
                background-color: var(--link-color);
                text-decoration: none;
            }
        </style></head>
<body><div><a class="back-to-index" href="../index.html">← Back to Index</a></div>
<h1 align="center">CMS_SIGNED_GET_ATTR</h1>
<a href="#NAME">NAME</a><br/>
<a href="#SYNOPSIS">SYNOPSIS</a><br/>
<a href="#DESCRIPTION">DESCRIPTION</a><br/>
<a href="#RETURN VALUES">RETURN VALUES</a><br/>
<a href="#NOTES">NOTES</a><br/>
<a href="#SEE ALSO">SEE ALSO</a><br/>
<a href="#COPYRIGHT">COPYRIGHT</a><br/>
<hr/>
<h2>NAME
<a name="NAME"></a>
</h2>
<p style="margin-left:9%; margin-top: 1em">CMS_signed_get_attr_count,
CMS_signed_get_attr_by_NID, CMS_signed_get_attr_by_OBJ,
CMS_signed_get_attr, CMS_signed_delete_attr,
CMS_signed_add1_attr, CMS_signed_add1_attr_by_OBJ,
CMS_signed_add1_attr_by_NID, CMS_signed_add1_attr_by_txt,
CMS_signed_get0_data_by_OBJ, CMS_unsigned_get_attr_count,
CMS_unsigned_get_attr_by_NID, CMS_unsigned_get_attr_by_OBJ,
CMS_unsigned_get_attr, CMS_unsigned_delete_attr,
CMS_unsigned_add1_attr, CMS_unsigned_add1_attr_by_OBJ,
CMS_unsigned_add1_attr_by_NID,
CMS_unsigned_add1_attr_by_txt, CMS_unsigned_get0_data_by_OBJ
− CMS signed and unsigned attribute functions</p>
<h2>SYNOPSIS
<a name="SYNOPSIS"></a>
</h2>
<p style="margin-left:9%; margin-top: 1em">#include
&lt;openssl/cms.h&gt; <br/>
int CMS_signed_get_attr_count(const CMS_SignerInfo *si);
<br/>
int CMS_signed_get_attr_by_NID(const CMS_SignerInfo *si, int
nid, <br/>
int lastpos); <br/>
int CMS_signed_get_attr_by_OBJ(const CMS_SignerInfo *si,
const ASN1_OBJECT *obj, <br/>
int lastpos); <br/>
X509_ATTRIBUTE *CMS_signed_get_attr(const CMS_SignerInfo
*si, int loc); <br/>
X509_ATTRIBUTE *CMS_signed_delete_attr(CMS_SignerInfo *si,
int loc); <br/>
int CMS_signed_add1_attr(CMS_SignerInfo *si, X509_ATTRIBUTE
*attr); <br/>
int CMS_signed_add1_attr_by_OBJ(CMS_SignerInfo *si, <br/>
const ASN1_OBJECT *obj, int type, <br/>
const void *bytes, int len); <br/>
int CMS_signed_add1_attr_by_NID(CMS_SignerInfo *si, <br/>
int nid, int type, <br/>
const void *bytes, int len); <br/>
int CMS_signed_add1_attr_by_txt(CMS_SignerInfo *si, <br/>
const char *attrname, int type, <br/>
const void *bytes, int len); <br/>
void *CMS_signed_get0_data_by_OBJ(const CMS_SignerInfo *si,
<br/>
const ASN1_OBJECT *oid, <br/>
int lastpos, int type); <br/>
int CMS_unsigned_get_attr_count(const CMS_SignerInfo *si);
<br/>
int CMS_unsigned_get_attr_by_NID(const CMS_SignerInfo *si,
int nid, <br/>
int lastpos); <br/>
int CMS_unsigned_get_attr_by_OBJ(const CMS_SignerInfo *si,
<br/>
const ASN1_OBJECT *obj, int lastpos); <br/>
X509_ATTRIBUTE *CMS_unsigned_get_attr(const CMS_SignerInfo
*si, int loc); <br/>
X509_ATTRIBUTE *CMS_unsigned_delete_attr(CMS_SignerInfo *si,
int loc); <br/>
int CMS_unsigned_add1_attr(CMS_SignerInfo *si,
X509_ATTRIBUTE *attr); <br/>
int CMS_unsigned_add1_attr_by_OBJ(CMS_SignerInfo *si, <br/>
const ASN1_OBJECT *obj, int type, <br/>
const void *bytes, int len); <br/>
int CMS_unsigned_add1_attr_by_NID(CMS_SignerInfo *si, <br/>
int nid, int type, <br/>
const void *bytes, int len); <br/>
int CMS_unsigned_add1_attr_by_txt(CMS_SignerInfo *si, <br/>
const char *attrname, int type, <br/>
const void *bytes, int len); <br/>
void *CMS_unsigned_get0_data_by_OBJ(CMS_SignerInfo *si,
ASN1_OBJECT *oid, <br/>
int lastpos, int type);</p>
<h2>DESCRIPTION
<a name="DESCRIPTION"></a>
</h2>
<p style="margin-left:9%; margin-top: 1em">CMS_signerInfo
contains separate attribute lists for signed and unsigned
attributes. Each <b>CMS_signed_XXX()</b> function is used
for signed attributes, and each <b>CMS_unsigned_XXX()</b>
function is used for unsigned attributes. Since the
<b>CMS_unsigned_XXX()</b> functions work in the same way as
the <b>CMS_signed_XXX()</b> equivalents, only the
<b>CMS_signed_XXX()</b> functions are described below.</p>
<p style="margin-left:9%; margin-top: 1em"><b>CMS_signed_get_attr_by_OBJ()</b>
finds the location of the first matching object <i>obj</i>
in the SignerInfo's <i>si</i> signed attribute list. The
search starts at the position after <i>lastpos</i>. If the
returned value is positive then it can be used on the next
call to <b>CMS_signed_get_attr_by_OBJ()</b> as the value of
<i>lastpos</i> in order to iterate through the remaining
attributes. <i>lastpos</i> can be set to any negative value
on the first call, in order to start searching from the
start of the signed attribute list.</p>
<p style="margin-left:9%; margin-top: 1em"><b>CMS_signed_get_attr_by_NID()</b>
is similar to <b>CMS_signed_get_attr_by_OBJ()</b> except
that it passes the numerical identifier (NID) <i>nid</i>
associated with the object. See &lt;openssl/obj_mac.h&gt;
for a list of NID_*.</p>
<p style="margin-left:9%; margin-top: 1em"><b>CMS_signed_get_attr()</b>
returns the <b>X509_ATTRIBUTE</b> object at index <i>loc</i>
in the <i>si</i> signed attribute list. <i>loc</i> should be
in the range from 0 to <b>CMS_signed_get_attr_count()</b>
− 1.</p>
<p style="margin-left:9%; margin-top: 1em"><b>CMS_signed_delete_attr()</b>
removes the <b>X509_ATTRIBUTE</b> object at index <i>loc</i>
in the <i>si</i> signed attribute list. An error occurs if
the <i>si</i> attribute list is NULL.</p>
<p style="margin-left:9%; margin-top: 1em"><b>CMS_signed_add1_attr()</b>
pushes a copy of the passed in <b>X509_ATTRIBUTE</b> object
to the <i>si</i> signed attribute list. A new signed
attribute list is created if required. An error occurs if
<i>attr</i> is NULL.</p>
<p style="margin-left:9%; margin-top: 1em"><b>CMS_signed_add1_attr_by_OBJ()</b>
creates a new signed <b>X509_ATTRIBUTE</b> using
<b>X509_ATTRIBUTE_set1_object()</b> and
<b>X509_ATTRIBUTE_set1_data()</b> to assign a new <i>obj</i>
with type <i>type</i> and data <i>bytes</i> of length
<i>len</i> and then pushes it to the <i>key</i> object's
attribute list.</p>
<p style="margin-left:9%; margin-top: 1em"><b>CMS_signed_add1_attr_by_NID()</b>
is similar to <b>CMS_signed_add1_attr_by_OBJ()</b> except
that it passes the numerical identifier (NID) <i>nid</i>
associated with the object. See &lt;openssl/obj_mac.h&gt;
for a list of NID_*.</p>
<p style="margin-left:9%; margin-top: 1em"><b>CMS_signed_add1_attr_by_txt()</b>
is similar to <b>CMS_signed_add1_attr_by_OBJ()</b> except
that it passes a name <i>attrname</i> associated with the
object. See &lt;openssl/obj_mac.h&gt; for a list of SN_*
names.</p>
<p style="margin-left:9%; margin-top: 1em"><b>CMS_signed_get0_data_by_OBJ()</b>
finds the first attribute in a <i>si</i> signed attributes
list that matches the <i>obj</i> starting at index
<i>lastpos</i> and returns the data retrieved from the found
attributes first <b>ASN1_TYPE</b> object. An error will
occur if the attribute type <i>type</i> does not match the
type of the <b>ASN1_TYPE</b> object OR if <i>type</i> is
either <b>V_ASN1_BOOLEAN</b> or <b>V_ASN1_NULL</b> OR the
attribute is not found. If <i>lastpos</i> is less than
−1 then an error will occur if there are multiple
objects in the signed attribute list that match <i>obj</i>.
If <i>lastpos</i> is less than −2 then an error will
occur if there is more than one <b>ASN1_TYPE</b> object in
the found signed attribute.</p>
<p style="margin-left:9%; margin-top: 1em">Refer to
<b>X509_ATTRIBUTE</b>(3) for information related to
attributes.</p>
<h2>RETURN VALUES
<a name="RETURN VALUES"></a>
</h2>
<p style="margin-left:9%; margin-top: 1em">The
<b>CMS_unsigned_XXX()</b> functions return values are
similar to those of the equivalent <b>CMS_signed_XXX()</b>
functions.</p>
<p style="margin-left:9%; margin-top: 1em"><b>CMS_signed_get_attr_count()</b>
returns the number of signed attributes in the SignerInfo
<i>si</i>, or −1 if the signed attribute list is
NULL.</p>
<p style="margin-left:9%; margin-top: 1em"><b>CMS_signed_get_attr_by_OBJ()</b>
returns −1 if either the signed attribute list of
<i>si</i> is empty OR if <i>obj</i> is not found, otherwise
it returns the location of the <i>obj</i> in the
SignerInfo's <i>si</i> signed attribute list.</p>
<p style="margin-left:9%; margin-top: 1em"><b>CMS_signed_get_attr_by_NID()</b>
is similar to <b>CMS_signed_get_attr_by_OBJ()</b> except
that it returns −2 if the <i>nid</i> is not known by
OpenSSL.</p>
<p style="margin-left:9%; margin-top: 1em"><b>CMS_signed_get_attr()</b>
returns either a signed <b>X509_ATTRIBUTE</b> or NULL on
error.</p>
<p style="margin-left:9%; margin-top: 1em"><b>CMS_signed_delete_attr()</b>
returns either the removed signed <b>X509_ATTRIBUTE</b> or
NULL if there is a error.</p>
<p style="margin-left:9%; margin-top: 1em"><b>CMS_signed_add1_attr()</b>,
<b>CMS_signed_add1_attr_by_OBJ()</b>,
<b>CMS_signed_add1_attr_by_NID()</b>,
<b>CMS_signed_add1_attr_by_txt()</b>, return 1 on success or
0 on error.</p>
<p style="margin-left:9%; margin-top: 1em"><b>CMS_signed_get0_data_by_OBJ()</b>
returns the data retrieved from the found signed attributes
first <b>ASN1_TYPE</b> object, or NULL if an error
occurs.</p>
<h2>NOTES
<a name="NOTES"></a>
</h2>
<p style="margin-left:9%; margin-top: 1em">Some attributes
are added automatically during the signing process.</p>
<p style="margin-left:9%; margin-top: 1em">Calling
<b>CMS_SignerInfo_sign()</b> adds the NID_pkcs9_signingTime
signed attribute.</p>
<p style="margin-left:9%; margin-top: 1em">Calling
<b>CMS_final()</b>, <b>CMS_final_digest()</b> or
<b>CMS_dataFinal()</b> adds the NID_pkcs9_messageDigest
signed attribute.</p>
<p style="margin-left:9%; margin-top: 1em">The
NID_pkcs9_contentType signed attribute is always added if
the NID_pkcs9_signingTime attribute is added.</p>
<p style="margin-left:9%; margin-top: 1em">Calling
<b>CMS_sign_ex()</b>, <b>CMS_sign_receipt()</b> or
<b>CMS_add1_signer()</b> may add attributes depending on the
flags parameter. See <b>CMS_add1_signer</b>(3) for more
information.</p>
<p style="margin-left:9%; margin-top: 1em">OpenSSL applies
special rules for the following attribute NIDs: <br/>
CMS Signed Attributes</p>
<p style="margin-left:14%;">NID_pkcs9_contentType
NID_pkcs9_messageDigest NID_pkcs9_signingTime</p>
<p style="margin-left:9%;">ESS Signed Attributes</p>
<p style="margin-left:14%;">NID_id_smime_aa_signingCertificate
NID_id_smime_aa_signingCertificateV2
NID_id_smime_aa_receiptRequest</p>
<p style="margin-left:9%;">CMS Unsigned Attributes</p>
<p style="margin-left:14%;">NID_pkcs9_countersignature</p>
<p style="margin-left:9%; margin-top: 1em"><b>CMS_signed_add1_attr()</b>,
<b>CMS_signed_add1_attr_by_OBJ()</b>,
<b>CMS_signed_add1_attr_by_NID()</b>,
<b>CMS_signed_add1_attr_by_txt()</b> and the equivalent
<b>CMS_unsigned_add1_attrXXX()</b> functions allow duplicate
attributes to be added. The attribute rules are not checked
during these function calls, and are deferred until the sign
or verify process (i.e. during calls to any of
<b>CMS_sign_ex()</b>, <b>CMS_sign()</b>,
<b>CMS_sign_receipt()</b>, <b>CMS_add1_signer()</b>,
<b>CMS_Final()</b>, <b>CMS_dataFinal()</b>,
<b>CMS_final_digest()</b>, <b>CMS_verify()</b>,
<b>CMS_verify_receipt()</b> or
<b>CMS_SignedData_verify()</b>).</p>
<p style="margin-left:9%; margin-top: 1em">For CMS
attribute rules see RFC 5652 Section 11. For ESS attribute
rules see RFC 2634 Section 1.3.4 and RFC 5035 Section
5.4.</p>
<h2>SEE ALSO
<a name="SEE ALSO"></a>
</h2>
<p style="margin-left:9%; margin-top: 1em"><b>X509_ATTRIBUTE</b>(3)</p>
<h2>COPYRIGHT
<a name="COPYRIGHT"></a>
</h2>
<p style="margin-left:9%; margin-top: 1em">Copyright
2023−2024 The OpenSSL Project Authors. All Rights
Reserved.</p>
<p style="margin-left:9%; margin-top: 1em">Licensed under
the Apache License 2.0 (the "License"). You may
not use this file except in compliance with the License. You
can obtain a copy in the file LICENSE in the source
distribution or at
&lt;https://www.openssl.org/source/license.html&gt;.</p>
<hr/>
</body>
</html>
