<!-- Creator     : groff version 1.23.0 -->
<!-- CreationDate: Sat Apr  5 19:50:44 2025 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">

<html>
<head>
<meta content="groff -Thtml, see www.gnu.org" name="generator"/>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<meta content="text/css" name="Content-Style"/>
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title>SD_BUS_CREDS_NEW_FROM_PID</title>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/><style>
            :root {
                --primary-color: #3498db;
                --background-color: #f9f9f9;
                --text-color: #333;
                --code-bg: #f0f0f0;
                --header-color: #2c3e50;
                --link-color: #2980b9;
            }
            body {
                font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
                line-height: 1.6;
                color: var(--text-color);
                background-color: var(--background-color);
                max-width: 900px;
                margin: 0 auto;
                padding: 2rem;
            }
            h1, h2, h3, h4 {
                color: var(--header-color);
            }
            h1 {
                border-bottom: 2px solid var(--primary-color);
                padding-bottom: 0.5rem;
            }
            pre {
                background-color: var(--code-bg);
                padding: 1rem;
                border-radius: 4px;
                overflow-x: auto;
            }
            a {
                color: var(--link-color);
                text-decoration: none;
            }
            a:hover {
                text-decoration: underline;
            }
            .man-navigation {
                background-color: #fff;
                border-bottom: 1px solid #ddd;
                padding: 0.5rem 0;
                position: sticky;
                top: 0;
                z-index: 100;
            }
            .section {
                margin-top: 2rem;
            }
            @media (prefers-color-scheme: dark) {
                :root {
                    --primary-color: #3498db;
                    --background-color: #222;
                    --text-color: #f0f0f0;
                    --code-bg: #333;
                    --header-color: #3498db;
                    --link-color: #5dade2;
                }
            }
            .back-to-index {
                display: inline-block;
                margin: 1rem 0;
                padding: 0.5rem 1rem;
                background-color: var(--primary-color);
                color: white;
                border-radius: 4px;
                text-decoration: none;
            }
            .back-to-index:hover {
                background-color: var(--link-color);
                text-decoration: none;
            }
        </style></head>
<body><div><a class="back-to-index" href="../index.html">← Back to Index</a></div>
<h1 align="center">SD_BUS_CREDS_NEW_FROM_PID</h1>
<a href="#NAME">NAME</a><br/>
<a href="#SYNOPSIS">SYNOPSIS</a><br/>
<a href="#DESCRIPTION">DESCRIPTION</a><br/>
<a href="#RETURN VALUE">RETURN VALUE</a><br/>
<a href="#REFERENCE OWNERSHIP">REFERENCE OWNERSHIP</a><br/>
<a href="#Errors">Errors</a><br/>
<a href="#NOTES">NOTES</a><br/>
<a href="#HISTORY">HISTORY</a><br/>
<a href="#SEE ALSO">SEE ALSO</a><br/>
<a href="#NOTES">NOTES</a><br/>
<hr/>
<h2>NAME
<a name="NAME"></a>
</h2>
<p style="margin-left:9%; margin-top: 1em">sd_bus_creds_new_from_pid,
sd_bus_creds_new_from_pidfd, sd_bus_creds_get_mask,
sd_bus_creds_get_augmented_mask, sd_bus_creds_ref,
sd_bus_creds_unref, sd_bus_creds_unrefp − Retrieve
credentials object for the specified PID</p>
<h2>SYNOPSIS
<a name="SYNOPSIS"></a>
</h2>
<p style="margin-left:9%; margin-top: 1em"><b>#include
&lt;systemd/sd−bus.h&gt;</b></p>
<table border="0" cellpadding="0" cellspacing="0" frame="void" rules="none" width="100%">
<tr align="left" valign="top">
<td width="9%"></td>
<td width="81%">
<p style="margin-top: 1em"><b>int
sd_bus_creds_new_from_pid(pid_t </b><i>pid</i><b>,
uint64_t </b><i>creds_mask</i><b>,
sd_bus_creds **</b><i>ret</i><b>);</b></p> </td>
<td width="10%">
</td></tr>
<tr align="left" valign="top">
<td width="9%"></td>
<td width="81%">
<p style="margin-top: 1em"><b>int
sd_bus_creds_new_from_pidfd(int </b><i>pidfd</i><b>,
uint64_t </b><i>creds_mask</i><b>,
sd_bus_creds **</b><i>ret</i><b>);</b></p> </td>
<td width="10%">
</td></tr>
<tr align="left" valign="top">
<td width="9%"></td>
<td width="81%">
<p style="margin-top: 1em"><b>uint64_t
sd_bus_creds_get_mask(sd_bus_creds *</b><i>c</i><b>);</b></p> </td>
<td width="10%">
</td></tr>
<tr align="left" valign="top">
<td width="9%"></td>
<td width="81%">
<p style="margin-top: 1em"><b>uint64_t
sd_bus_creds_get_augmented_mask(sd_bus_creds *</b><i>c</i><b>);</b></p> </td>
<td width="10%">
</td></tr>
<tr align="left" valign="top">
<td width="9%"></td>
<td width="81%">
<p style="margin-top: 1em"><b>sd_bus_creds
*sd_bus_creds_ref(sd_bus_creds *</b><i>c</i><b>);</b></p> </td>
<td width="10%">
</td></tr>
<tr align="left" valign="top">
<td width="9%"></td>
<td width="81%">
<p style="margin-top: 1em"><b>sd_bus_creds
*sd_bus_creds_unref(sd_bus_creds *</b><i>c</i><b>);</b></p> </td>
<td width="10%">
</td></tr>
<tr align="left" valign="top">
<td width="9%"></td>
<td width="81%">
<p style="margin-top: 1em"><b>void
sd_bus_creds_unrefp(sd_bus_creds **</b><i>c</i><b>);</b></p> </td>
<td width="10%">
</td></tr>
</table>
<p style="margin-left:9%; margin-top: 1em"><b>SD_BUS_CREDS_PID</b>,
<b>SD_BUS_CREDS_PPID</b>, <b>SD_BUS_CREDS_TID</b>,
<b>SD_BUS_CREDS_UID</b>, <b>SD_BUS_CREDS_EUID</b>,
<b>SD_BUS_CREDS_SUID</b>, <b>SD_BUS_CREDS_FSUID</b>,
<b>SD_BUS_CREDS_GID</b>, <b>SD_BUS_CREDS_EGID</b>,
<b>SD_BUS_CREDS_SGID</b>, <b>SD_BUS_CREDS_FSGID</b>,
<b>SD_BUS_CREDS_SUPPLEMENTARY_GIDS</b>,
<b>SD_BUS_CREDS_COMM</b>, <b>SD_BUS_CREDS_TID_COMM</b>,
<b>SD_BUS_CREDS_EXE</b>, <b>SD_BUS_CREDS_CMDLINE</b>,
<b>SD_BUS_CREDS_CGROUP</b>, <b>SD_BUS_CREDS_UNIT</b>,
<b>SD_BUS_CREDS_SLICE</b>, <b>SD_BUS_CREDS_USER_UNIT</b>,
<b>SD_BUS_CREDS_USER_SLICE</b>, <b>SD_BUS_CREDS_SESSION</b>,
<b>SD_BUS_CREDS_OWNER_UID</b>,
<b>SD_BUS_CREDS_EFFECTIVE_CAPS</b>,
<b>SD_BUS_CREDS_PERMITTED_CAPS</b>,
<b>SD_BUS_CREDS_INHERITABLE_CAPS</b>,
<b>SD_BUS_CREDS_BOUNDING_CAPS</b>,
<b>SD_BUS_CREDS_SELINUX_CONTEXT</b>,
<b>SD_BUS_CREDS_AUDIT_SESSION_ID</b>,
<b>SD_BUS_CREDS_AUDIT_LOGIN_UID</b>,
<b>SD_BUS_CREDS_TTY</b>, <b>SD_BUS_CREDS_UNIQUE_NAME</b>,
<b>SD_BUS_CREDS_WELL_KNOWN_NAMES</b>,
<b>SD_BUS_CREDS_DESCRIPTION</b>, <b>SD_BUS_CREDS_PIDFD</b>,
<b>SD_BUS_CREDS_AUGMENT</b>, <b>_SD_BUS_CREDS_ALL</b></p>
<h2>DESCRIPTION
<a name="DESCRIPTION"></a>
</h2>
<p style="margin-left:9%; margin-top: 1em"><b>sd_bus_creds_new_from_pid()</b>
creates a new credentials object and fills it with
information about the process <i>pid</i>. The pointer to
this object will be stored in the <i>ret</i> pointer. Note
that credential objects may also be created and retrieved
via <b>sd_bus_get_name_creds</b>(3),
<b>sd_bus_get_owner_creds</b>(3) and
<b>sd_bus_message_get_creds</b>(3).</p>
<p style="margin-left:9%; margin-top: 1em"><b>sd_bus_creds_new_from_pidfd()</b>
is identical to <b>sd_bus_creds_new_from_pid()</b>, but
takes a PID file descriptor rather than a numeric PID as
reference to the process. See <b>pidfd_open</b>(2).</p>
<p style="margin-left:9%; margin-top: 1em">The information
that will be stored is determined by <i>creds_mask</i>. It
may contain a subset of ORed constants
<b>SD_BUS_CREDS_PID</b>, <b>SD_BUS_CREDS_PPID</b>,
<b>SD_BUS_CREDS_TID</b>, <b>SD_BUS_CREDS_UID</b>,
<b>SD_BUS_CREDS_EUID</b>, <b>SD_BUS_CREDS_SUID</b>,
<b>SD_BUS_CREDS_FSUID</b>, <b>SD_BUS_CREDS_GID</b>,
<b>SD_BUS_CREDS_EGID</b>, <b>SD_BUS_CREDS_SGID</b>,
<b>SD_BUS_CREDS_FSGID</b>,
<b>SD_BUS_CREDS_SUPPLEMENTARY_GIDS</b>,
<b>SD_BUS_CREDS_COMM</b>, <b>SD_BUS_CREDS_TID_COMM</b>,
<b>SD_BUS_CREDS_EXE</b>, <b>SD_BUS_CREDS_CMDLINE</b>,
<b>SD_BUS_CREDS_CGROUP</b>, <b>SD_BUS_CREDS_UNIT</b>,
<b>SD_BUS_CREDS_SLICE</b>, <b>SD_BUS_CREDS_USER_UNIT</b>,
<b>SD_BUS_CREDS_USER_SLICE</b>, <b>SD_BUS_CREDS_SESSION</b>,
<b>SD_BUS_CREDS_OWNER_UID</b>,
<b>SD_BUS_CREDS_EFFECTIVE_CAPS</b>,
<b>SD_BUS_CREDS_PERMITTED_CAPS</b>,
<b>SD_BUS_CREDS_INHERITABLE_CAPS</b>,
<b>SD_BUS_CREDS_BOUNDING_CAPS</b>,
<b>SD_BUS_CREDS_SELINUX_CONTEXT</b>,
<b>SD_BUS_CREDS_AUDIT_SESSION_ID</b>,
<b>SD_BUS_CREDS_AUDIT_LOGIN_UID</b>,
<b>SD_BUS_CREDS_TTY</b>, <b>SD_BUS_CREDS_UNIQUE_NAME</b>,
<b>SD_BUS_CREDS_WELL_KNOWN_NAMES</b>,
<b>SD_BUS_CREDS_DESCRIPTION</b>, and
<b>SD_BUS_CREDS_PIDFD</b>. Use the special value
<b>_SD_BUS_CREDS_ALL</b> to request all supported fields.
The <b>SD_BUS_CREDS_AUGMENT</b> constant may not be ORed
into the mask for invocations of
<b>sd_bus_creds_new_from_pid()</b> or
<b>sd_bus_creds_new_from_pidfd()</b>.</p>
<p style="margin-left:9%; margin-top: 1em">Fields can be
retrieved from the credentials object using
<b>sd_bus_creds_get_pid</b>(3) and other functions which
correspond directly to the constants listed above.</p>
<p style="margin-left:9%; margin-top: 1em">A mask of fields
which were actually successfully retrieved can be retrieved
with <b>sd_bus_creds_get_mask()</b>. If the credentials
object was created with <b>sd_bus_creds_new_from_pid()</b>
or <b>sd_bus_creds_new_from_pidfd()</b>, this will be a
subset of fields requested in <i>creds_mask</i>.</p>
<p style="margin-left:9%; margin-top: 1em">Similar to
<b>sd_bus_creds_get_mask()</b>, the function
<b>sd_bus_creds_get_augmented_mask()</b> returns a bitmask
of field constants. The mask indicates which credential
fields have been retrieved in a non−atomic fashion.
For credential objects created via
<b>sd_bus_creds_new_from_pid()</b> or
<b>sd_bus_creds_new_from_pidfd()</b>, this mask will be
identical to the mask returned by
<b>sd_bus_creds_get_mask()</b>. However, for credential
objects retrieved via <b>sd_bus_get_name_creds()</b>, this
mask will be set for the credential fields that could not be
determined atomically at peer connection time, and which
were later added by reading augmenting credential data from
/proc/. Similarly, for credential objects retrieved via
<b>sd_bus_get_owner_creds()</b>, the mask is set for the
fields that could not be determined atomically at bus
creation time, but have been augmented. Similarly, for
credential objects retrieved via
<b>sd_bus_message_get_creds()</b>, the mask is set for the
fields that could not be determined atomically at message
sending time, but have been augmented. The mask returned by
<b>sd_bus_creds_get_augmented_mask()</b> is always a subset
of (or identical to) the mask returned by
<b>sd_bus_creds_get_mask()</b> for the same object. The
latter call hence returns all credential fields available in
the credential object, the former then marks the subset of
those that have been augmented. Note that augmented fields
are unsuitable for authorization decisions, as they may be
retrieved at different times, thus being subject to races.
Hence, augmented fields should be used exclusively for
informational purposes.</p>
<p style="margin-left:9%; margin-top: 1em"><b>sd_bus_creds_ref()</b>
creates a new reference to the credentials object <i>c</i>.
This object will not be destroyed until
<b>sd_bus_creds_unref()</b> has been called as many times
plus once more. Once the reference count has dropped to
zero, <i>c</i> cannot be used anymore, so further calls to
<b>sd_bus_creds_ref(c)</b> or <b>sd_bus_creds_unref(c)</b>
are illegal.</p>
<p style="margin-left:9%; margin-top: 1em"><b>sd_bus_creds_unref()</b>
destroys a reference to <i>c</i>.</p>
<p style="margin-left:9%; margin-top: 1em"><b>sd_bus_creds_unrefp()</b>
is similar to <b>sd_bus_creds_unref()</b> but takes a
pointer to a pointer to an <b>sd_bus_creds</b> object. This
call is useful in conjunction with GCC's and LLVM's
<b><font color="#0000FF">Clean−up Variable
Attribute</font></b>
<small><font color="#000000">[1]</font></small>
<font color="#000000">. Note that this function is defined
as inline function.</font></p>
<p style="margin-left:9%; margin-top: 1em"><font color="#000000"><b>sd_bus_creds_ref()</b>,
<b>sd_bus_creds_unref()</b> and <b>sd_bus_creds_unrefp()</b>
execute no operation if the passed in bus credentials object
is <b>NULL</b>.</font></p>
<h2>RETURN VALUE
<a name="RETURN VALUE"></a>
</h2>
<p style="margin-left:9%; margin-top: 1em"><font color="#000000">On
success, <b>sd_bus_creds_new_from_pid()</b> and
<b>sd_bus_creds_new_from_pidfd()</b> return 0 or a positive
integer. On failure, they return a negative
errno−style error code.</font></p>
<p style="margin-left:9%; margin-top: 1em"><font color="#000000"><b>sd_bus_creds_get_mask()</b>
returns the mask of successfully acquired fields.</font></p>
<p style="margin-left:9%; margin-top: 1em"><font color="#000000"><b>sd_bus_creds_get_augmented_mask()</b>
returns the mask of fields that have been augmented from
data in /proc/, and are thus not suitable for authorization
decisions.</font></p>
<p style="margin-left:9%; margin-top: 1em"><font color="#000000"><b>sd_bus_creds_ref()</b>
always returns the argument.</font></p>
<p style="margin-left:9%; margin-top: 1em"><font color="#000000"><b>sd_bus_creds_unref()</b>
always returns <b>NULL</b>.</font></p>
<h2>REFERENCE OWNERSHIP
<a name="REFERENCE OWNERSHIP"></a>
</h2>
<p style="margin-left:9%; margin-top: 1em"><font color="#000000">The
functions <b>sd_bus_creds_new_from_pid()</b> and
<b>sd_bus_creds_new_from_pidfd()</b> create a new object and
the caller owns the sole reference. When not needed anymore,
this reference should be destroyed with
<b>sd_bus_creds_unref</b>(3).</font></p>
<h3>Errors
<a name="Errors"></a>
</h3>
<p style="margin-left:9%; margin-top: 1em"><font color="#000000">Returned
errors may indicate the following problems:</font></p>
<p style="margin-left:9%; margin-top: 1em"><font color="#000000"><b>−ESRCH</b></font></p>
<p style="margin-left:14%;"><font color="#000000">Specified
<i>pid</i> could not be found.</font></p>
<p style="margin-left:9%; margin-top: 1em"><font color="#000000"><b>−EINVAL</b></font></p>
<p style="margin-left:14%;"><font color="#000000">Specified
parameter is invalid (<b>NULL</b> in case of output
parameters).</font></p>
<p style="margin-left:9%; margin-top: 1em"><font color="#000000"><b>−ENOMEM</b></font></p>
<p style="margin-left:14%;"><font color="#000000">Memory
allocation failed.</font></p>
<p style="margin-left:9%; margin-top: 1em"><font color="#000000"><b>−EOPNOTSUPP</b></font></p>
<p style="margin-left:14%;"><font color="#000000">One of
the requested fields is unknown to the local
system.</font></p>
<h2>NOTES
<a name="NOTES"></a>
</h2>
<p style="margin-left:9%; margin-top: 1em"><font color="#000000">Functions
described here are available as a shared library, which can
be compiled against and linked to with the
<b>libsystemd pkg-config</b>(1) file.</font></p>
<p style="margin-left:9%; margin-top: 1em"><font color="#000000">The
code described here uses <b>getenv</b>(3), which is declared
to be not multi−thread−safe. This means that the
code calling the functions described here must not call
<b>setenv</b>(3) from a parallel thread. It is recommended
to only do calls to <b>setenv()</b> from an early phase of
the program when no other threads have been
started.</font></p>
<h2>HISTORY
<a name="HISTORY"></a>
</h2>
<p style="margin-left:9%; margin-top: 1em"><font color="#000000"><b>sd_bus_creds_new_from_pid()</b>,
<b>sd_bus_creds_get_mask()</b>, <b>sd_bus_creds_ref()</b>,
<b>sd_bus_creds_unref()</b>, and
<b>sd_bus_creds_get_augmented_mask()</b> were added in
version 221.</font></p>
<p style="margin-left:9%; margin-top: 1em"><font color="#000000"><b>sd_bus_creds_unrefp()</b>
was added in version 229.</font></p>
<p style="margin-left:9%; margin-top: 1em"><font color="#000000"><b>sd_bus_creds_new_from_pidfd()</b>
was added in version 256.</font></p>
<h2>SEE ALSO
<a name="SEE ALSO"></a>
</h2>
<p style="margin-left:9%; margin-top: 1em"><font color="#000000"><b>systemd</b>(1),
<b>sd-bus</b>(3), <b>sd_bus_creds_get_pid</b>(3),
<b>sd_bus_get_name_creds</b>(3),
<b>sd_bus_get_owner_creds</b>(3),
<b>sd_bus_message_get_creds</b>(3)</font></p>
<h2>NOTES
<a name="NOTES"></a>
</h2>
<table border="0" cellpadding="0" cellspacing="0" frame="void" rules="none" width="100%">
<tr align="left" valign="top">
<td width="10%"></td>
<td width="3%">
<p style="margin-top: 1em"><font color="#000000">1.</font></p> </td>
<td width="1%"></td>
<td width="35%">
<p style="margin-top: 1em"><font color="#000000">Clean-up
Variable Attribute</font></p></td>
<td width="51%">
</td></tr>
</table>
<p style="margin-left:14%;"><font color="#000000">https://gcc.gnu.org/onlinedocs/gcc/Common-Variable-Attributes.html</font></p>
<hr/>
</body>
</html>
