<!-- Creator     : groff version 1.23.0 -->
<!-- CreationDate: Sat Apr  5 20:40:13 2025 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">

<html>
<head>
<meta content="groff -Thtml, see www.gnu.org" name="generator"/>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<meta content="text/css" name="Content-Style"/>
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title>CMS_GET0_RECIPIENTINFOS</title>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/><style>
            :root {
                --primary-color: #3498db;
                --background-color: #f9f9f9;
                --text-color: #333;
                --code-bg: #f0f0f0;
                --header-color: #2c3e50;
                --link-color: #2980b9;
            }
            body {
                font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
                line-height: 1.6;
                color: var(--text-color);
                background-color: var(--background-color);
                max-width: 900px;
                margin: 0 auto;
                padding: 2rem;
            }
            h1, h2, h3, h4 {
                color: var(--header-color);
            }
            h1 {
                border-bottom: 2px solid var(--primary-color);
                padding-bottom: 0.5rem;
            }
            pre {
                background-color: var(--code-bg);
                padding: 1rem;
                border-radius: 4px;
                overflow-x: auto;
            }
            a {
                color: var(--link-color);
                text-decoration: none;
            }
            a:hover {
                text-decoration: underline;
            }
            .man-navigation {
                background-color: #fff;
                border-bottom: 1px solid #ddd;
                padding: 0.5rem 0;
                position: sticky;
                top: 0;
                z-index: 100;
            }
            .section {
                margin-top: 2rem;
            }
            @media (prefers-color-scheme: dark) {
                :root {
                    --primary-color: #3498db;
                    --background-color: #222;
                    --text-color: #f0f0f0;
                    --code-bg: #333;
                    --header-color: #3498db;
                    --link-color: #5dade2;
                }
            }
            .back-to-index {
                display: inline-block;
                margin: 1rem 0;
                padding: 0.5rem 1rem;
                background-color: var(--primary-color);
                color: white;
                border-radius: 4px;
                text-decoration: none;
            }
            .back-to-index:hover {
                background-color: var(--link-color);
                text-decoration: none;
            }
        </style></head>
<body><div><a class="back-to-index" href="../index.html">← Back to Index</a></div>
<h1 align="center">CMS_GET0_RECIPIENTINFOS</h1>
<a href="#NAME">NAME</a><br/>
<a href="#SYNOPSIS">SYNOPSIS</a><br/>
<a href="#DESCRIPTION">DESCRIPTION</a><br/>
<a href="#NOTES">NOTES</a><br/>
<a href="#RETURN VALUES">RETURN VALUES</a><br/>
<a href="#SEE ALSO">SEE ALSO</a><br/>
<a href="#HISTORY">HISTORY</a><br/>
<a href="#COPYRIGHT">COPYRIGHT</a><br/>
<hr/>
<h2>NAME
<a name="NAME"></a>
</h2>
<p style="margin-left:9%; margin-top: 1em">CMS_get0_RecipientInfos,
CMS_RecipientInfo_type,
CMS_RecipientInfo_ktri_get0_signer_id,
CMS_RecipientInfo_ktri_cert_cmp,
CMS_RecipientInfo_set0_pkey,
CMS_RecipientInfo_kekri_get0_id,
CMS_RecipientInfo_kari_set0_pkey_and_peer,
CMS_RecipientInfo_kari_set0_pkey,
CMS_RecipientInfo_kekri_id_cmp, CMS_RecipientInfo_set0_key,
CMS_RecipientInfo_decrypt, CMS_RecipientInfo_encrypt −
CMS envelopedData RecipientInfo routines</p>
<h2>SYNOPSIS
<a name="SYNOPSIS"></a>
</h2>
<p style="margin-left:9%; margin-top: 1em">#include
&lt;openssl/cms.h&gt; <br/>
STACK_OF(CMS_RecipientInfo)
*CMS_get0_RecipientInfos(CMS_ContentInfo *cms); <br/>
int CMS_RecipientInfo_type(CMS_RecipientInfo *ri); <br/>
int CMS_RecipientInfo_ktri_get0_signer_id(CMS_RecipientInfo
*ri, <br/>
ASN1_OCTET_STRING **keyid, <br/>
X509_NAME **issuer, <br/>
ASN1_INTEGER **sno); <br/>
int CMS_RecipientInfo_ktri_cert_cmp(CMS_RecipientInfo *ri,
X509 *cert); <br/>
int CMS_RecipientInfo_set0_pkey(CMS_RecipientInfo *ri,
EVP_PKEY *pkey); <br/>
int
CMS_RecipientInfo_kari_set0_pkey_and_peer(CMS_RecipientInfo
*ri, <br/>
EVP_PKEY *pk, X509 *peer); <br/>
int CMS_RecipientInfo_kari_set0_pkey(CMS_RecipientInfo *ri,
EVP_PKEY *pk); <br/>
int CMS_RecipientInfo_kekri_get0_id(CMS_RecipientInfo *ri,
X509_ALGOR **palg, <br/>
ASN1_OCTET_STRING **pid, <br/>
ASN1_GENERALIZEDTIME **pdate, <br/>
ASN1_OBJECT **potherid, <br/>
ASN1_TYPE **pothertype); <br/>
int CMS_RecipientInfo_kekri_id_cmp(CMS_RecipientInfo *ri,
<br/>
const unsigned char *id, size_t idlen); <br/>
int CMS_RecipientInfo_set0_key(CMS_RecipientInfo *ri, <br/>
unsigned char *key, size_t keylen); <br/>
int CMS_RecipientInfo_decrypt(CMS_ContentInfo *cms,
CMS_RecipientInfo *ri); <br/>
int CMS_RecipientInfo_encrypt(CMS_ContentInfo *cms,
CMS_RecipientInfo *ri);</p>
<h2>DESCRIPTION
<a name="DESCRIPTION"></a>
</h2>
<p style="margin-left:9%; margin-top: 1em">The function
<b>CMS_get0_RecipientInfos()</b> returns all the
CMS_RecipientInfo structures associated with a CMS
EnvelopedData structure.</p>
<p style="margin-left:9%; margin-top: 1em"><b>CMS_RecipientInfo_type()</b>
returns the type of CMS_RecipientInfo structure <b>ri</b>.
It will currently return CMS_RECIPINFO_TRANS,
CMS_RECIPINFO_AGREE, CMS_RECIPINFO_KEK, CMS_RECIPINFO_PASS,
or CMS_RECIPINFO_OTHER.</p>
<p style="margin-left:9%; margin-top: 1em"><b>CMS_RecipientInfo_ktri_get0_signer_id()</b>
retrieves the certificate recipient identifier associated
with a specific CMS_RecipientInfo structure <b>ri</b>, which
must be of type CMS_RECIPINFO_TRANS. Either the
keyidentifier will be set in <b>keyid</b> or <b>both</b>
issuer name and serial number in <b>issuer</b> and
<b>sno</b>.</p>
<p style="margin-left:9%; margin-top: 1em"><b>CMS_RecipientInfo_ktri_cert_cmp()</b>
compares the certificate <b>cert</b> against the
CMS_RecipientInfo structure <b>ri</b>, which must be of type
CMS_RECIPINFO_TRANS. It returns zero if the comparison is
successful and non zero if not.</p>
<p style="margin-left:9%; margin-top: 1em"><b>CMS_RecipientInfo_set0_pkey()</b>
associates the private key <b>pkey</b> with the
CMS_RecipientInfo structure <b>ri</b>, which must be of type
CMS_RECIPINFO_TRANS.</p>
<p style="margin-left:9%; margin-top: 1em"><b>CMS_RecipientInfo_kari_set0_pkey_and_peer()</b>
associates the private key <b>pkey</b> and peer certificate
<b>peer</b> with the CMS_RecipientInfo structure <b>ri</b>,
which must be of type CMS_RECIPINFO_AGREE.</p>
<p style="margin-left:9%; margin-top: 1em"><b>CMS_RecipientInfo_kari_set0_pkey()</b>
associates the private key <b>pkey</b> with the
CMS_RecipientInfo structure <b>ri</b>, which must be of type
CMS_RECIPINFO_AGREE.</p>
<p style="margin-left:9%; margin-top: 1em"><b>CMS_RecipientInfo_kekri_get0_id()</b>
retrieves the key information from the CMS_RecipientInfo
structure <b>ri</b> which must be of type CMS_RECIPINFO_KEK.
Any of the remaining parameters can be NULL if the
application is not interested in the value of a field. Where
a field is optional and absent NULL will be written to the
corresponding parameter. The keyEncryptionAlgorithm field is
written to <b>palg</b>, the <b>keyIdentifier</b> field is
written to <b>pid</b>, the <b>date</b> field if present is
written to <b>pdate</b>, if the <b>other</b> field is
present the components <b>keyAttrId</b> and <b>keyAttr</b>
are written to parameters <b>potherid</b> and
<b>pothertype</b>.</p>
<p style="margin-left:9%; margin-top: 1em"><b>CMS_RecipientInfo_kekri_id_cmp()</b>
compares the ID in the <b>id</b> and <b>idlen</b> parameters
against the <b>keyIdentifier</b> CMS_RecipientInfo structure
<b>ri</b>, which must be of type CMS_RECIPINFO_KEK. It
returns zero if the comparison is successful and non zero if
not.</p>
<p style="margin-left:9%; margin-top: 1em"><b>CMS_RecipientInfo_set0_key()</b>
associates the symmetric key <b>key</b> of length
<b>keylen</b> with the CMS_RecipientInfo structure
<b>ri</b>, which must be of type CMS_RECIPINFO_KEK.</p>
<p style="margin-left:9%; margin-top: 1em"><b>CMS_RecipientInfo_decrypt()</b>
attempts to decrypt CMS_RecipientInfo structure <b>ri</b> in
structure <b>cms</b>. A key must have been associated with
the structure first.</p>
<p style="margin-left:9%; margin-top: 1em"><b>CMS_RecipientInfo_encrypt()</b>
attempts to encrypt CMS_RecipientInfo structure <b>ri</b> in
structure <b>cms</b>. A key must have been associated with
the structure first and the content encryption key must be
available: for example by a previous call to
<b>CMS_RecipientInfo_decrypt()</b>.</p>
<h2>NOTES
<a name="NOTES"></a>
</h2>
<p style="margin-left:9%; margin-top: 1em">The main purpose
of these functions is to enable an application to lookup
recipient keys using any appropriate technique when the
simpler method of <b>CMS_decrypt()</b> is not
appropriate.</p>
<p style="margin-left:9%; margin-top: 1em">In typical usage
and application will retrieve all CMS_RecipientInfo
structures using <b>CMS_get0_RecipientInfos()</b> and check
the type of each using <b>CMS_RecipientInfo_type()</b>.
Depending on the type the CMS_RecipientInfo structure can be
ignored or its key identifier data retrieved using an
appropriate function. Then if the corresponding secret or
private key can be obtained by any appropriate means it can
then associated with the structure and
<b>CMS_RecipientInfo_decrypt()</b> called. If successful
<b>CMS_decrypt()</b> can be called with a NULL key to
decrypt the enveloped content.</p>
<p style="margin-left:9%; margin-top: 1em">The
<b>CMS_RecipientInfo_encrypt()</b> can be used to add a new
recipient to an existing enveloped data structure. Typically
an application will first decrypt an appropriate
CMS_RecipientInfo structure to make the content encrypt key
available, it will then add a new recipient using a function
such as <b>CMS_add1_recipient_cert()</b> and finally encrypt
the content encryption key using
<b>CMS_RecipientInfo_encrypt()</b>.</p>
<h2>RETURN VALUES
<a name="RETURN VALUES"></a>
</h2>
<p style="margin-left:9%; margin-top: 1em"><b>CMS_get0_RecipientInfos()</b>
returns all CMS_RecipientInfo structures, or NULL if an
error occurs.</p>
<p style="margin-left:9%; margin-top: 1em"><b>CMS_RecipientInfo_ktri_get0_signer_id()</b>,
<b>CMS_RecipientInfo_set0_pkey()</b>,
<b>CMS_RecipientInfo_kekri_get0_id()</b>,
<b>CMS_RecipientInfo_set0_key()</b> and
<b>CMS_RecipientInfo_decrypt()</b> return 1 for success or 0
if an error occurs. <b>CMS_RecipientInfo_encrypt()</b>
return 1 for success or 0 if an error occurs.</p>
<p style="margin-left:9%; margin-top: 1em"><b>CMS_RecipientInfo_ktri_cert_cmp()</b>
and <b>CMS_RecipientInfo_kekri_cmp()</b> return 0 for a
successful comparison and non zero otherwise.</p>
<p style="margin-left:9%; margin-top: 1em">Any error can be
obtained from <b>ERR_get_error</b>(3).</p>
<h2>SEE ALSO
<a name="SEE ALSO"></a>
</h2>
<p style="margin-left:9%; margin-top: 1em"><b>ERR_get_error</b>(3),
<b>CMS_decrypt</b>(3)</p>
<h2>HISTORY
<a name="HISTORY"></a>
</h2>
<p style="margin-left:9%; margin-top: 1em"><b>CMS_RecipientInfo_kari_set0_pkey_and_peer</b>
and <b>CMS_RecipientInfo_kari_set0_pkey</b> were added in
OpenSSL 3.0.</p>
<h2>COPYRIGHT
<a name="COPYRIGHT"></a>
</h2>
<p style="margin-left:9%; margin-top: 1em">Copyright
2008−2020 The OpenSSL Project Authors. All Rights
Reserved.</p>
<p style="margin-left:9%; margin-top: 1em">Licensed under
the Apache License 2.0 (the "License"). You may
not use this file except in compliance with the License. You
can obtain a copy in the file LICENSE in the source
distribution or at
&lt;https://www.openssl.org/source/license.html&gt;.</p>
<hr/>
</body>
</html>
