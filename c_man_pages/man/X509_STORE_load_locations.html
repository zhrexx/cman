<!-- Creator     : groff version 1.23.0 -->
<!-- CreationDate: Sat Apr  5 20:53:05 2025 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">

<html>
<head>
<meta content="groff -Thtml, see www.gnu.org" name="generator"/>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<meta content="text/css" name="Content-Style"/>
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title>X509_STORE_ADD_CERT</title>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/><style>
            :root {
                --primary-color: #3498db;
                --background-color: #f9f9f9;
                --text-color: #333;
                --code-bg: #f0f0f0;
                --header-color: #2c3e50;
                --link-color: #2980b9;
            }
            body {
                font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
                line-height: 1.6;
                color: var(--text-color);
                background-color: var(--background-color);
                max-width: 900px;
                margin: 0 auto;
                padding: 2rem;
            }
            h1, h2, h3, h4 {
                color: var(--header-color);
            }
            h1 {
                border-bottom: 2px solid var(--primary-color);
                padding-bottom: 0.5rem;
            }
            pre {
                background-color: var(--code-bg);
                padding: 1rem;
                border-radius: 4px;
                overflow-x: auto;
            }
            a {
                color: var(--link-color);
                text-decoration: none;
            }
            a:hover {
                text-decoration: underline;
            }
            .man-navigation {
                background-color: #fff;
                border-bottom: 1px solid #ddd;
                padding: 0.5rem 0;
                position: sticky;
                top: 0;
                z-index: 100;
            }
            .section {
                margin-top: 2rem;
            }
            @media (prefers-color-scheme: dark) {
                :root {
                    --primary-color: #3498db;
                    --background-color: #222;
                    --text-color: #f0f0f0;
                    --code-bg: #333;
                    --header-color: #3498db;
                    --link-color: #5dade2;
                }
            }
            .back-to-index {
                display: inline-block;
                margin: 1rem 0;
                padding: 0.5rem 1rem;
                background-color: var(--primary-color);
                color: white;
                border-radius: 4px;
                text-decoration: none;
            }
            .back-to-index:hover {
                background-color: var(--link-color);
                text-decoration: none;
            }
        </style></head>
<body><div><a class="back-to-index" href="../index.html">← Back to Index</a></div>
<h1 align="center">X509_STORE_ADD_CERT</h1>
<a href="#NAME">NAME</a><br/>
<a href="#SYNOPSIS">SYNOPSIS</a><br/>
<a href="#DESCRIPTION">DESCRIPTION</a><br/>
<a href="#RETURN VALUES">RETURN VALUES</a><br/>
<a href="#SEE ALSO">SEE ALSO</a><br/>
<a href="#HISTORY">HISTORY</a><br/>
<a href="#COPYRIGHT">COPYRIGHT</a><br/>
<hr/>
<h2>NAME
<a name="NAME"></a>
</h2>
<p style="margin-left:9%; margin-top: 1em">X509_STORE,
X509_STORE_add_cert, X509_STORE_add_crl,
X509_STORE_set_depth, X509_STORE_set_flags,
X509_STORE_set_purpose, X509_STORE_set_trust,
X509_STORE_add_lookup, X509_STORE_load_file_ex,
X509_STORE_load_file, X509_STORE_load_path,
X509_STORE_load_store_ex, X509_STORE_load_store,
X509_STORE_set_default_paths_ex,
X509_STORE_set_default_paths, X509_STORE_load_locations_ex,
X509_STORE_load_locations − X509_STORE
manipulation</p>
<h2>SYNOPSIS
<a name="SYNOPSIS"></a>
</h2>
<p style="margin-left:9%; margin-top: 1em">#include
&lt;openssl/x509_vfy.h&gt; <br/>
typedef x509_store_st X509_STORE; <br/>
int X509_STORE_add_cert(X509_STORE *xs, X509 *x); <br/>
int X509_STORE_add_crl(X509_STORE *xs, X509_CRL *x); <br/>
int X509_STORE_set_depth(X509_STORE *store, int depth); <br/>
int X509_STORE_set_flags(X509_STORE *xs, unsigned long
flags); <br/>
int X509_STORE_set_purpose(X509_STORE *xs, int purpose);
<br/>
int X509_STORE_set_trust(X509_STORE *xs, int trust); <br/>
X509_LOOKUP *X509_STORE_add_lookup(X509_STORE *store, <br/>
X509_LOOKUP_METHOD *meth); <br/>
int X509_STORE_set_default_paths_ex(X509_STORE *xs,
OSSL_LIB_CTX *libctx, <br/>
const char *propq); <br/>
int X509_STORE_set_default_paths(X509_STORE *xs); <br/>
int X509_STORE_load_file_ex(X509_STORE *xs, const char
*file, <br/>
OSSL_LIB_CTX *libctx, const char *propq); <br/>
int X509_STORE_load_file(X509_STORE *xs, const char *file);
<br/>
int X509_STORE_load_path(X509_STORE *xs, const char *dir);
<br/>
int X509_STORE_load_store_ex(X509_STORE *xs, const char
*uri, <br/>
OSSL_LIB_CTX *libctx, const char *propq); <br/>
int X509_STORE_load_store(X509_STORE *xs, const char *uri);
<br/>
int X509_STORE_load_locations_ex(X509_STORE *xs, const char
*file, <br/>
const char *dir, OSSL_LIB_CTX *libctx, <br/>
const char *propq); <br/>
int X509_STORE_load_locations(X509_STORE *xs, <br/>
const char *file, const char *dir);</p>
<h2>DESCRIPTION
<a name="DESCRIPTION"></a>
</h2>
<p style="margin-left:9%; margin-top: 1em">The
<b>X509_STORE</b> structure is intended to be a consolidated
mechanism for holding information about X.509 certificates
and CRLs, and constructing and validating chains of
certificates terminating in trusted roots. It admits
multiple lookup mechanisms and efficient scaling performance
with large numbers of certificates, and a great deal of
flexibility in how validation and policy checks are
performed.</p>
<p style="margin-left:9%; margin-top: 1em">Details of the
chain building and checking process are described in
"Certification Path Building" in
<b>openssl−verification−options</b>(1) and
"Certification Path Validation" in
<b>openssl−verification−options</b>(1).</p>
<p style="margin-left:9%; margin-top: 1em"><b>X509_STORE_new</b>(3)
creates an empty <b>X509_STORE</b> structure, which contains
no information about trusted certificates or where such
certificates are located on disk, and is generally not
usable. Normally, trusted certificates will be added to the
<b>X509_STORE</b> to prepare it for use, via mechanisms such
as <b>X509_STORE_add_lookup()</b> and
<b>X509_LOOKUP_file()</b>, or <b>PEM_read_bio_X509_AUX()</b>
and <b>X509_STORE_add_cert()</b>. CRLs can also be added,
and many behaviors configured as desired.</p>
<p style="margin-left:9%; margin-top: 1em">Once the
<b>X509_STORE</b> is suitably configured,
<b>X509_STORE_CTX_new()</b> is used to instantiate a
single−use <b>X509_STORE_CTX</b> for each
chain−building and verification operation. That
process includes providing the end−entity certificate
to be verified and an additional set of untrusted
certificates that may be used in chain−building. As
such, it is expected that the certificates included in the
<b>X509_STORE</b> are certificates that represent trusted
entities such as root certificate authorities (CAs). OpenSSL
represents these trusted certificates internally as
<b>X509</b> objects with an associated <b>X509_CERT_AUX</b>,
as are produced by <b>PEM_read_bio_X509_AUX()</b> and
similar routines that refer to X509_AUX. The public
interfaces that operate on such trusted certificates still
operate on pointers to <b>X509</b> objects, though.</p>
<p style="margin-left:9%; margin-top: 1em"><b>X509_STORE_add_cert()</b>
and <b>X509_STORE_add_crl()</b> add the respective object to
the <b>X509_STORE</b>'s local storage. Untrusted objects
should not be added in this way. The added object's
reference count is incremented by one, hence the caller
retains ownership of the object and needs to free it when it
is no longer needed.</p>
<p style="margin-left:9%; margin-top: 1em"><b>X509_STORE_set_depth()</b>,
<b>X509_STORE_set_flags()</b>,
<b>X509_STORE_set_purpose()</b>,
<b>X509_STORE_set_trust()</b>, and
<b>X509_STORE_set1_param()</b> set the default values for
the corresponding values used in certificate chain
validation. Their behavior is documented in the
corresponding <b>X509_VERIFY_PARAM</b> manual pages, e.g.,
<b>X509_VERIFY_PARAM_set_depth</b>(3).</p>
<p style="margin-left:9%; margin-top: 1em"><b>X509_STORE_add_lookup()</b>
finds or creates a <b>X509_LOOKUP</b>(3) with the
<b>X509_LOOKUP_METHOD</b>(3) <i>meth</i> and adds it to the
<b>X509_STORE</b> <i>store</i>. This also associates the
<b>X509_STORE</b> with the lookup, so <b>X509_LOOKUP</b>
functions can look up objects in that store.</p>
<p style="margin-left:9%; margin-top: 1em"><b>X509_STORE_load_file_ex()</b>
loads trusted certificate(s) into an <b>X509_STORE</b> from
a given file. The library context <i>libctx</i> and property
query <i>propq</i> are used when fetching algorithms from
providers.</p>
<p style="margin-left:9%; margin-top: 1em"><b>X509_STORE_load_file()</b>
is similar to <b>X509_STORE_load_file_ex()</b> but uses NULL
for the library context <i>libctx</i> and property query
<i>propq</i>.</p>
<p style="margin-left:9%; margin-top: 1em"><b>X509_STORE_load_path()</b>
loads trusted certificate(s) into an <b>X509_STORE</b> from
a given directory path. The certificates in the directory
must be in hashed form, as documented in
<b>X509_LOOKUP_hash_dir</b>(3).</p>
<p style="margin-left:9%; margin-top: 1em"><b>X509_STORE_load_store_ex()</b>
loads trusted certificate(s) into an <b>X509_STORE</b> from
a store at a given URI. The library context <i>libctx</i>
and property query <i>propq</i> are used when fetching
algorithms from providers.</p>
<p style="margin-left:9%; margin-top: 1em"><b>X509_STORE_load_store()</b>
is similar to <b>X509_STORE_load_store_ex()</b> but uses
NULL for the library context <i>libctx</i> and property
query <i>propq</i>.</p>
<p style="margin-left:9%; margin-top: 1em"><b>X509_STORE_load_locations_ex()</b>
combines <b>X509_STORE_load_file_ex()</b> and
<b>X509_STORE_load_path()</b> for a given file and/or
directory path. It is permitted to specify just a file, just
a directory, or both paths.</p>
<p style="margin-left:9%; margin-top: 1em"><b>X509_STORE_load_locations()</b>
is similar to <b>X509_STORE_load_locations_ex()</b> but uses
NULL for the library context <i>libctx</i> and property
query <i>propq</i>.</p>
<p style="margin-left:9%; margin-top: 1em"><b>X509_STORE_set_default_paths_ex()</b>
is somewhat misnamed, in that it does not set what default
paths should be used for loading certificates. Instead, it
loads certificates into the <b>X509_STORE</b> from the
hardcoded default paths. The library context <i>libctx</i>
and property query <i>propq</i> are used when fetching
algorithms from providers.</p>
<p style="margin-left:9%; margin-top: 1em"><b>X509_STORE_set_default_paths()</b>
is similar to <b>X509_STORE_set_default_paths_ex()</b> but
uses NULL for the library context <i>libctx</i> and property
query <i>propq</i>.</p>
<h2>RETURN VALUES
<a name="RETURN VALUES"></a>
</h2>
<p style="margin-left:9%; margin-top: 1em"><b>X509_STORE_add_cert()</b>,
<b>X509_STORE_add_crl()</b>, <b>X509_STORE_set_depth()</b>,
<b>X509_STORE_set_flags()</b>,
<b>X509_STORE_set_purpose()</b>,
<b>X509_STORE_set_trust()</b>,
<b>X509_STORE_load_file_ex()</b>,
<b>X509_STORE_load_file()</b>,
<b>X509_STORE_load_path()</b>,
<b>X509_STORE_load_store_ex()</b>,
<b>X509_STORE_load_store()</b>,
<b>X509_STORE_load_locations_ex()</b>,
<b>X509_STORE_load_locations()</b>,
<b>X509_STORE_set_default_paths_ex()</b> and
<b>X509_STORE_set_default_paths()</b> return 1 on success or
0 on failure.</p>
<p style="margin-left:9%; margin-top: 1em"><b>X509_STORE_add_lookup()</b>
returns the found or created <b>X509_LOOKUP</b>(3), or NULL
on error.</p>
<h2>SEE ALSO
<a name="SEE ALSO"></a>
</h2>
<p style="margin-left:9%; margin-top: 1em"><b>X509_LOOKUP_hash_dir</b>(3).
<b>X509_VERIFY_PARAM_set_depth</b>(3).
<b>X509_STORE_new</b>(3),
<b>X509_STORE_get0_param</b>(3)</p>
<h2>HISTORY
<a name="HISTORY"></a>
</h2>
<p style="margin-left:9%; margin-top: 1em">The functions
<b>X509_STORE_set_default_paths_ex()</b>,
<b>X509_STORE_load_file_ex()</b>,
<b>X509_STORE_load_store_ex()</b> and
<b>X509_STORE_load_locations_ex()</b> were added in OpenSSL
3.0.</p>
<h2>COPYRIGHT
<a name="COPYRIGHT"></a>
</h2>
<p style="margin-left:9%; margin-top: 1em">Copyright
2017−2021 The OpenSSL Project Authors. All Rights
Reserved.</p>
<p style="margin-left:9%; margin-top: 1em">Licensed under
the Apache License 2.0 (the "License"). You may
not use this file except in compliance with the License. You
can obtain a copy in the file LICENSE in the source
distribution or at
&lt;https://www.openssl.org/source/license.html&gt;.</p>
<hr/>
</body>
</html>
