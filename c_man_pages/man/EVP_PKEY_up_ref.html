<!-- Creator     : groff version 1.23.0 -->
<!-- CreationDate: Sat Apr  5 20:42:53 2025 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">

<html>
<head>
<meta content="groff -Thtml, see www.gnu.org" name="generator"/>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<meta content="text/css" name="Content-Style"/>
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title>EVP_PKEY_NEW</title>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/><style>
            :root {
                --primary-color: #3498db;
                --background-color: #f9f9f9;
                --text-color: #333;
                --code-bg: #f0f0f0;
                --header-color: #2c3e50;
                --link-color: #2980b9;
            }
            body {
                font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
                line-height: 1.6;
                color: var(--text-color);
                background-color: var(--background-color);
                max-width: 900px;
                margin: 0 auto;
                padding: 2rem;
            }
            h1, h2, h3, h4 {
                color: var(--header-color);
            }
            h1 {
                border-bottom: 2px solid var(--primary-color);
                padding-bottom: 0.5rem;
            }
            pre {
                background-color: var(--code-bg);
                padding: 1rem;
                border-radius: 4px;
                overflow-x: auto;
            }
            a {
                color: var(--link-color);
                text-decoration: none;
            }
            a:hover {
                text-decoration: underline;
            }
            .man-navigation {
                background-color: #fff;
                border-bottom: 1px solid #ddd;
                padding: 0.5rem 0;
                position: sticky;
                top: 0;
                z-index: 100;
            }
            .section {
                margin-top: 2rem;
            }
            @media (prefers-color-scheme: dark) {
                :root {
                    --primary-color: #3498db;
                    --background-color: #222;
                    --text-color: #f0f0f0;
                    --code-bg: #333;
                    --header-color: #3498db;
                    --link-color: #5dade2;
                }
            }
            .back-to-index {
                display: inline-block;
                margin: 1rem 0;
                padding: 0.5rem 1rem;
                background-color: var(--primary-color);
                color: white;
                border-radius: 4px;
                text-decoration: none;
            }
            .back-to-index:hover {
                background-color: var(--link-color);
                text-decoration: none;
            }
        </style></head>
<body><div><a class="back-to-index" href="../index.html">← Back to Index</a></div>
<h1 align="center">EVP_PKEY_NEW</h1>
<a href="#NAME">NAME</a><br/>
<a href="#SYNOPSIS">SYNOPSIS</a><br/>
<a href="#DESCRIPTION">DESCRIPTION</a><br/>
<a href="#NOTES">NOTES</a><br/>
<a href="#RETURN VALUES">RETURN VALUES</a><br/>
<a href="#SEE ALSO">SEE ALSO</a><br/>
<a href="#HISTORY">HISTORY</a><br/>
<a href="#COPYRIGHT">COPYRIGHT</a><br/>
<hr/>
<h2>NAME
<a name="NAME"></a>
</h2>
<p style="margin-left:9%; margin-top: 1em">EVP_PKEY,
EVP_PKEY_new, EVP_PKEY_up_ref, EVP_PKEY_dup, EVP_PKEY_free,
EVP_PKEY_new_raw_private_key_ex,
EVP_PKEY_new_raw_private_key,
EVP_PKEY_new_raw_public_key_ex, EVP_PKEY_new_raw_public_key,
EVP_PKEY_new_CMAC_key, EVP_PKEY_new_mac_key,
EVP_PKEY_get_raw_private_key, EVP_PKEY_get_raw_public_key
− public/private key allocation and raw key handling
functions</p>
<h2>SYNOPSIS
<a name="SYNOPSIS"></a>
</h2>
<p style="margin-left:9%; margin-top: 1em">#include
&lt;openssl/evp.h&gt; <br/>
typedef evp_pkey_st EVP_PKEY; <br/>
EVP_PKEY *EVP_PKEY_new(void); <br/>
int EVP_PKEY_up_ref(EVP_PKEY *key); <br/>
EVP_PKEY *EVP_PKEY_dup(EVP_PKEY *key); <br/>
void EVP_PKEY_free(EVP_PKEY *key); <br/>
EVP_PKEY *EVP_PKEY_new_raw_private_key_ex(OSSL_LIB_CTX
*libctx, <br/>
const char *keytype, <br/>
const char *propq, <br/>
const unsigned char *key, <br/>
size_t keylen); <br/>
EVP_PKEY *EVP_PKEY_new_raw_private_key(int type, ENGINE *e,
<br/>
const unsigned char *key, size_t keylen); <br/>
EVP_PKEY *EVP_PKEY_new_raw_public_key_ex(OSSL_LIB_CTX
*libctx, <br/>
const char *keytype, <br/>
const char *propq, <br/>
const unsigned char *key, <br/>
size_t keylen); <br/>
EVP_PKEY *EVP_PKEY_new_raw_public_key(int type, ENGINE *e,
<br/>
const unsigned char *key, size_t keylen); <br/>
EVP_PKEY *EVP_PKEY_new_mac_key(int type, ENGINE *e, const
unsigned char *key, <br/>
int keylen); <br/>
int EVP_PKEY_get_raw_private_key(const EVP_PKEY *pkey,
unsigned char *priv, <br/>
size_t *len); <br/>
int EVP_PKEY_get_raw_public_key(const EVP_PKEY *pkey,
unsigned char *pub, <br/>
size_t *len);</p>
<p style="margin-left:9%; margin-top: 1em">The following
function has been deprecated since OpenSSL 3.0, and can be
hidden entirely by defining <b>OPENSSL_API_COMPAT</b> with a
suitable version value, see
<b>openssl_user_macros</b>(7):</p>
<p style="margin-left:9%; margin-top: 1em">EVP_PKEY
*EVP_PKEY_new_CMAC_key(ENGINE *e, const unsigned char *priv,
<br/>
size_t len, const EVP_CIPHER *cipher);</p>
<h2>DESCRIPTION
<a name="DESCRIPTION"></a>
</h2>
<p style="margin-left:9%; margin-top: 1em"><b>EVP_PKEY</b>
is a generic structure to hold diverse types of asymmetric
keys (also known as "key pairs"), and can be used
for diverse operations, like signing, verifying signatures,
key derivation, etc. The asymmetric keys themselves are
often referred to as the "internal key", and are
handled by backends, such as providers (through
<b>EVP_KEYMGMT</b>(3)) or <b>ENGINE</b>s.</p>
<p style="margin-left:9%; margin-top: 1em">Conceptually, an
<b>EVP_PKEY</b> internal key may hold a private key, a
public key, or both (a keypair), and along with those, key
parameters if the key type requires them. The presence of
these components determine what operations can be made; for
example, signing normally requires the presence of a private
key, and verifying normally requires the presence of a
public key.</p>
<p style="margin-left:9%; margin-top: 1em"><b>EVP_PKEY</b>
has also been used for MAC algorithm that were conceived as
producing signatures, although not being public key
algorithms; "POLY1305", "SIPHASH",
"HMAC", "CMAC". This usage is considered
legacy and is discouraged in favor of the <b>EVP_MAC</b>(3)
API.</p>
<p style="margin-left:9%; margin-top: 1em">The
<b>EVP_PKEY_new()</b> function allocates an empty
<b>EVP_PKEY</b> structure which is used by OpenSSL to store
public and private keys. The reference count is set to
<b>1</b>.</p>
<p style="margin-left:9%; margin-top: 1em"><b>EVP_PKEY_up_ref()</b>
increments the reference count of <i>key</i>.</p>
<p style="margin-left:9%; margin-top: 1em"><b>EVP_PKEY_dup()</b>
duplicates the <i>key</i>. The <i>key</i> must not be ENGINE
based or a raw key, otherwise the duplication will fail.</p>
<p style="margin-left:9%; margin-top: 1em"><b>EVP_PKEY_free()</b>
decrements the reference count of <i>key</i> and, if the
reference count is zero, frees it up. If <i>key</i> is NULL,
nothing is done.</p>
<p style="margin-left:9%; margin-top: 1em"><b>EVP_PKEY_new_raw_private_key_ex()</b>
allocates a new <b>EVP_PKEY</b>. Unless an engine should be
used for the key type, a provider for the key is found using
the library context <i>libctx</i> and the property query
string <i>propq</i>. The <i>keytype</i> argument indicates
what kind of key this is. The value should be a string for a
public key algorithm that supports raw private keys, i.e one
of "X25519", "ED25519", "X448"
or "ED448". <i>key</i> points to the raw private
key data for this <b>EVP_PKEY</b> which should be of length
<i>keylen</i>. The length should be appropriate for the type
of the key. The public key data will be automatically
derived from the given private key data (if appropriate for
the algorithm type).</p>
<p style="margin-left:9%; margin-top: 1em"><b>EVP_PKEY_new_raw_private_key()</b>
does the same as <b>EVP_PKEY_new_raw_private_key_ex()</b>
except that the default library context and default property
query are used instead. If <i>e</i> is non−NULL then
the new <b>EVP_PKEY</b> structure is associated with the
engine <i>e</i>. The <i>type</i> argument indicates what
kind of key this is. The value should be a NID for a public
key algorithm that supports raw private keys, i.e. one of
<b>EVP_PKEY_X25519</b>, <b>EVP_PKEY_ED25519</b>,
<b>EVP_PKEY_X448</b> or <b>EVP_PKEY_ED448</b>.</p>
<p style="margin-left:9%; margin-top: 1em"><b>EVP_PKEY_new_raw_private_key_ex()</b>
and <b>EVP_PKEY_new_raw_private_key()</b> may also be used
with most MACs implemented as public key algorithms, so key
types such as "HMAC", "POLY1305",
"SIPHASH", or their NID form
<b>EVP_PKEY_POLY1305</b>, <b>EVP_PKEY_SIPHASH</b>,
<b>EVP_PKEY_HMAC</b> are also accepted. This usage is, as
mentioned above, discouraged in favor of the
<b>EVP_MAC</b>(3) API.</p>
<p style="margin-left:9%; margin-top: 1em"><b>EVP_PKEY_new_raw_public_key_ex()</b>
works in the same way as
<b>EVP_PKEY_new_raw_private_key_ex()</b> except that
<i>key</i> points to the raw public key data. The
<b>EVP_PKEY</b> structure will be initialised without any
private key information. Algorithm types that support raw
public keys are "X25519", "ED25519",
"X448" or "ED448".</p>
<p style="margin-left:9%; margin-top: 1em"><b>EVP_PKEY_new_raw_public_key()</b>
works in the same way as
<b>EVP_PKEY_new_raw_private_key()</b> except that <i>key</i>
points to the raw public key data. The <b>EVP_PKEY</b>
structure will be initialised without any private key
information. Algorithm types that support raw public keys
are <b>EVP_PKEY_X25519</b>, <b>EVP_PKEY_ED25519</b>,
<b>EVP_PKEY_X448</b> or <b>EVP_PKEY_ED448</b>.</p>
<p style="margin-left:9%; margin-top: 1em"><b>EVP_PKEY_new_mac_key()</b>
works in the same way as
<b>EVP_PKEY_new_raw_private_key()</b>. New applications
should use <b>EVP_PKEY_new_raw_private_key()</b>
instead.</p>
<p style="margin-left:9%; margin-top: 1em"><b>EVP_PKEY_get_raw_private_key()</b>
fills the buffer provided by <i>priv</i> with raw private
key data. The size of the <i>priv</i> buffer should be in
<i>*len</i> on entry to the function, and on exit
<i>*len</i> is updated with the number of bytes actually
written. If the buffer <i>priv</i> is NULL then <i>*len</i>
is populated with the number of bytes required to hold the
key. The calling application is responsible for ensuring
that the buffer is large enough to receive the private key
data. This function only works for algorithms that support
raw private keys. Currently this is: <b>EVP_PKEY_HMAC</b>,
<b>EVP_PKEY_POLY1305</b>, <b>EVP_PKEY_SIPHASH</b>,
<b>EVP_PKEY_X25519</b>, <b>EVP_PKEY_ED25519</b>,
<b>EVP_PKEY_X448</b> or <b>EVP_PKEY_ED448</b>.</p>
<p style="margin-left:9%; margin-top: 1em"><b>EVP_PKEY_get_raw_public_key()</b>
fills the buffer provided by <i>pub</i> with raw public key
data. The size of the <i>pub</i> buffer should be in
<i>*len</i> on entry to the function, and on exit
<i>*len</i> is updated with the number of bytes actually
written. If the buffer <i>pub</i> is NULL then <i>*len</i>
is populated with the number of bytes required to hold the
key. The calling application is responsible for ensuring
that the buffer is large enough to receive the public key
data. This function only works for algorithms that support
raw public keys. Currently this is: <b>EVP_PKEY_X25519</b>,
<b>EVP_PKEY_ED25519</b>, <b>EVP_PKEY_X448</b> or
<b>EVP_PKEY_ED448</b>.</p>
<p style="margin-left:9%; margin-top: 1em"><b>EVP_PKEY_new_CMAC_key()</b>
works in the same way as
<b>EVP_PKEY_new_raw_private_key()</b> except it is only for
the <b>EVP_PKEY_CMAC</b> algorithm type. In addition to the
raw private key data, it also takes a cipher algorithm to be
used during creation of a CMAC in the <b>cipher</b>
argument. The cipher should be a standard
encryption−only cipher. For example AEAD and XTS
ciphers should not be used.</p>
<p style="margin-left:9%; margin-top: 1em">Applications
should use the <b>EVP_MAC</b>(3) API instead and set the
<b>OSSL_MAC_PARAM_CIPHER</b> parameter on the
<b>EVP_MAC_CTX</b> object with the name of the cipher being
used.</p>
<h2>NOTES
<a name="NOTES"></a>
</h2>
<p style="margin-left:9%; margin-top: 1em">The
<b>EVP_PKEY</b> structure is used by various OpenSSL
functions which require a general private key without
reference to any particular algorithm.</p>
<p style="margin-left:9%; margin-top: 1em">The structure
returned by <b>EVP_PKEY_new()</b> is empty. To add a private
or public key to this empty structure use the appropriate
functions described in <b>EVP_PKEY_set1_RSA</b>(3),
<b>EVP_PKEY_set1_DSA</b>(3), <b>EVP_PKEY_set1_DH</b>(3) or
<b>EVP_PKEY_set1_EC_KEY</b>(3).</p>
<h2>RETURN VALUES
<a name="RETURN VALUES"></a>
</h2>
<p style="margin-left:9%; margin-top: 1em"><b>EVP_PKEY_new()</b>,
<b>EVP_PKEY_new_raw_private_key()</b>,
<b>EVP_PKEY_new_raw_public_key()</b>,
<b>EVP_PKEY_new_CMAC_key()</b> and
<b>EVP_PKEY_new_mac_key()</b> return either the newly
allocated <b>EVP_PKEY</b> structure or NULL if an error
occurred.</p>
<p style="margin-left:9%; margin-top: 1em"><b>EVP_PKEY_dup()</b>
returns the key duplicate or NULL if an error occurred.</p>
<p style="margin-left:9%; margin-top: 1em"><b>EVP_PKEY_up_ref()</b>,
<b>EVP_PKEY_get_raw_private_key()</b> and
<b>EVP_PKEY_get_raw_public_key()</b> return 1 for success
and 0 for failure.</p>
<h2>SEE ALSO
<a name="SEE ALSO"></a>
</h2>
<p style="margin-left:9%; margin-top: 1em"><b>EVP_PKEY_set1_RSA</b>(3),
<b>EVP_PKEY_set1_DSA</b>(3), <b>EVP_PKEY_set1_DH</b>(3) or
<b>EVP_PKEY_set1_EC_KEY</b>(3)</p>
<h2>HISTORY
<a name="HISTORY"></a>
</h2>
<p style="margin-left:9%; margin-top: 1em">The
<b>EVP_PKEY_new()</b> and <b>EVP_PKEY_free()</b> functions
exist in all versions of OpenSSL.</p>
<p style="margin-left:9%; margin-top: 1em">The
<b>EVP_PKEY_up_ref()</b> function was added in OpenSSL
1.1.0.</p>
<p style="margin-left:9%; margin-top: 1em">The
<b>EVP_PKEY_new_raw_private_key()</b>,
<b>EVP_PKEY_new_raw_public_key()</b>,
<b>EVP_PKEY_new_CMAC_key()</b>,
<b>EVP_PKEY_new_raw_private_key()</b> and
<b>EVP_PKEY_get_raw_public_key()</b> functions were added in
OpenSSL 1.1.1.</p>
<p style="margin-left:9%; margin-top: 1em">The
<b>EVP_PKEY_dup()</b>,
<b>EVP_PKEY_new_raw_private_key_ex()</b>, and
<b>EVP_PKEY_new_raw_public_key_ex()</b> functions were added
in OpenSSL 3.0.</p>
<p style="margin-left:9%; margin-top: 1em">The
<b>EVP_PKEY_new_CMAC_key()</b> was deprecated in OpenSSL
3.0.</p>
<p style="margin-left:9%; margin-top: 1em">The
documentation of <b>EVP_PKEY</b> was amended in OpenSSL 3.0
to allow there to be the private part of the keypair without
the public part, where this was previously implied to be
disallowed.</p>
<h2>COPYRIGHT
<a name="COPYRIGHT"></a>
</h2>
<p style="margin-left:9%; margin-top: 1em">Copyright
2002−2022 The OpenSSL Project Authors. All Rights
Reserved.</p>
<p style="margin-left:9%; margin-top: 1em">Licensed under
the Apache License 2.0 (the "License"). You may
not use this file except in compliance with the License. You
can obtain a copy in the file LICENSE in the source
distribution or at
&lt;https://www.openssl.org/source/license.html&gt;.</p>
<hr/>
</body>
</html>
