<!-- Creator     : groff version 1.23.0 -->
<!-- CreationDate: Sat Apr  5 20:54:37 2025 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">

<html>
<head>
<meta content="groff -Thtml, see www.gnu.org" name="generator"/>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<meta content="text/css" name="Content-Style"/>
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title>XkbGetControlsChanges</title>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/><style>
            :root {
                --primary-color: #3498db;
                --background-color: #f9f9f9;
                --text-color: #333;
                --code-bg: #f0f0f0;
                --header-color: #2c3e50;
                --link-color: #2980b9;
            }
            body {
                font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
                line-height: 1.6;
                color: var(--text-color);
                background-color: var(--background-color);
                max-width: 900px;
                margin: 0 auto;
                padding: 2rem;
            }
            h1, h2, h3, h4 {
                color: var(--header-color);
            }
            h1 {
                border-bottom: 2px solid var(--primary-color);
                padding-bottom: 0.5rem;
            }
            pre {
                background-color: var(--code-bg);
                padding: 1rem;
                border-radius: 4px;
                overflow-x: auto;
            }
            a {
                color: var(--link-color);
                text-decoration: none;
            }
            a:hover {
                text-decoration: underline;
            }
            .man-navigation {
                background-color: #fff;
                border-bottom: 1px solid #ddd;
                padding: 0.5rem 0;
                position: sticky;
                top: 0;
                z-index: 100;
            }
            .section {
                margin-top: 2rem;
            }
            @media (prefers-color-scheme: dark) {
                :root {
                    --primary-color: #3498db;
                    --background-color: #222;
                    --text-color: #f0f0f0;
                    --code-bg: #333;
                    --header-color: #3498db;
                    --link-color: #5dade2;
                }
            }
            .back-to-index {
                display: inline-block;
                margin: 1rem 0;
                padding: 0.5rem 1rem;
                background-color: var(--primary-color);
                color: white;
                border-radius: 4px;
                text-decoration: none;
            }
            .back-to-index:hover {
                background-color: var(--link-color);
                text-decoration: none;
            }
        </style></head>
<body><div><a class="back-to-index" href="../index.html">← Back to Index</a></div>
<h1 align="center">XkbGetControlsChanges</h1>
<a href="#NAME">NAME</a><br/>
<a href="#SYNOPSIS">SYNOPSIS</a><br/>
<a href="#ARGUMENTS">ARGUMENTS</a><br/>
<a href="#DESCRIPTION">DESCRIPTION</a><br/>
<a href="#RETURN VALUES">RETURN VALUES</a><br/>
<a href="#STRUCTURES">STRUCTURES</a><br/>
<a href="#DIAGNOSTICS">DIAGNOSTICS</a><br/>
<a href="#SEE ALSO">SEE ALSO</a><br/>
<hr/>
<h2>NAME
<a name="NAME"></a>
</h2>
<p style="margin-left:9%; margin-top: 1em">XkbGetControlsChanges
− Updates a local copy of a keyboard description with
the changes previously noted by one or more calls to
XkbNoteControlsChanges</p>
<h2>SYNOPSIS
<a name="SYNOPSIS"></a>
</h2>
<table border="0" cellpadding="0" cellspacing="0" frame="void" rules="none" width="100%">
<tr align="left" valign="top">
<td width="9%"></td>
<td width="91%">
<p style="margin-top: 1em">XkbGetControlsChanges
<b>(Display *</b><i>dpy</i><b>, XkbDescPtr</b>
<i>xkb</i><b>, XkbNameChangesPtr</b>
<i>changes</i><b>);</b></p> </td></tr>
</table>
<table border="0" cellpadding="0" cellspacing="0" frame="void" rules="none" width="100%">
<tr align="left" valign="top">
<h2>ARGUMENTS
<a name="ARGUMENTS"></a>
</h2>
<td width="9%"></td>
<td width="4%"></td>
<td width="5%"></td>
<td width="33%">
</td>
<td width="49%">
</td></tr>
<tr align="left" valign="top">
<td width="9%"></td>
<td width="4%">
<p><b><i>dpy</i></b></p></td>
<td width="5%"></td>
<td width="33%">
<p>connection to X server</p></td>
<td width="49%">
</td></tr>
<tr align="left" valign="top">
<td width="9%"></td>
<td width="4%">
<p><i>xkb</i></p></td>
<td width="5%"></td>
<td width="33%">
<p>xkb-&gt;ctrls will be updated</p></td>
<td width="49%">
</td></tr>
</table>
<p style="margin-left:9%;"><i>changes</i></p>
<p style="margin-left:18%;">indicates which parts of
xkb-&gt;ctrls to update</p>
<h2>DESCRIPTION
<a name="DESCRIPTION"></a>
</h2>
<p style="margin-left:9%; margin-top: 1em">Whenever a field
in the controls structure changes in the server’s
keyboard description, the server sends an XkbControlsNotify
event to all interested clients.To receive XkbControlsNotify
events under all possible conditions, use
<i>XkbSelectEvents</i> and pass XkbControlsNotifyMask in
both <i>bits_to_change</i> and <i>values_for_bits.</i></p>
<p style="margin-left:9%; margin-top: 1em">To receive
XkbControlsNotify events only under certain conditions, use
<i>XkbSelectEventDetails</i> using XkbControlsNotify as the
<i>event_type</i> and specifying the desired state changes
in <i>bits_to_change</i> and <i>values_for_bits</i> using
mask bits from Table 1.</p>
<p style="margin-left:9%; margin-top: 1em">Table 1 shows
the actual values for the individual mask bits used to
select controls for modification and to enable and disable
the control. Note that the same mask bit is used to specify
general modifications to the parameters used to configure
the control (which), and to enable and disable the control
(enabled_ctrls). The anomalies in the table (no
"ok" in column) are for controls that have no
configurable attributes; and for controls that are not
boolean controls and therefore cannot be enabled or
disabled.</p>
<p style="margin-left:9%; margin-top: 1em">The
<i>changed_ctrls</i> field specifies the controls components
that have changed and consists of bits taken from the masks
defined in Table 10.7 with "ok" in the
<i>changed_ctrls</i> column.</p>
<p style="margin-left:9%; margin-top: 1em">The controls
currently enabled in the server are reported in the
<i>enabled_ctrls</i> field. If any controls were just
enabled or disabled (that is, the contents of the
<i>enabled_ctrls</i> field changed), they are flagged in the
<i>enabled_ctrl_changes</i> field. The valid bits for these
fields are the masks listed in Table 10.7 with
"ok" in the <i>enabled_ctrls</i> column. The
<i>num_groups</i> field reports the number of groups bound
to the key belonging to the most number of groups and is
automatically updated when the keyboard mapping changes.</p>
<p style="margin-left:9%; margin-top: 1em">If the change
was caused by a request from a client, the <i>keycode</i>
and <i>event_type</i> fields are set to zero and the
<i>req_major</i> and <i>req_minor</i> fields identify the
request. The <i>req_major value is the same as the major
extension opcode. Otherwise, event_type</i> is set to the
type of event that caused the change (one of KeyPress,
KeyRelease, DeviceKeyPress, DeviceKeyRelease, ButtonPress or
ButtonRelease), and <i>req_major</i> and <i>req_minor</i>
are undefined. If <i>event_type</i> is KeyPress, KeyRelease,
DeviceKeyPress, or DeviceKeyRelease, the <i>keycode</i>
field is set to the key that caused the change. If
<i>event_type</i> is ButtonPress or ButtonRelease,
<i>keycode</i> contains the button number.</p>
<p style="margin-left:9%; margin-top: 1em">When a client
receives an XkbControlsNotify event, it can note the changes
in a changes structure using
<i>XkbNoteControlsChanges.</i></p>
<p style="margin-left:9%; margin-top: 1em"><i>XkbGetControlsChanges</i>
examines the <i>changes</i> parameter, queries the server
for the necessary information, and copies the results into
the <i>xkb-&gt;ctrls</i> keyboard description. If the
<i>ctrls</i> field of <i>xkb</i> is NULL,
<i>XkbGetControlsChanges</i> allocates and initializes it.
To free the <i>ctrls</i> field, use XkbFreeControls.</p>
<p style="margin-left:9%; margin-top: 1em"><i>XkbGetControlsChanges</i>
returns Success if successful and can generate BadAlloc,
BadImplementation, and BadMatch errors.</p>
<h2>RETURN VALUES
<a name="RETURN VALUES"></a>
</h2>
<table border="0" cellpadding="0" cellspacing="0" frame="void" rules="none" width="100%">
<tr align="left" valign="top">
<td width="9%"></td>
<td width="9%">
<p style="margin-top: 1em">Success</p></td>
<td width="10%"></td>
<td width="72%">
<p style="margin-top: 1em">The <i>XkbGetControlsChanges</i>
function returns Success if the query of the server was
successful.</p> </td></tr>
</table>
<h2>STRUCTURES
<a name="STRUCTURES"></a>
</h2>
<p style="margin-left:9%; margin-top: 1em">The structure
for the XkbControlsNotify event is defined as follows:</p>
<p style="margin-left:9%; margin-top: 1em">typedef struct {
<br/>
int type; /* Xkb extension base event code */ <br/>
unsigned long serial; /* X server serial number for event */
<br/>
Bool send_event; /* True =&gt; synthetically generated */
<br/>
Display * display; /* server connection where event
generated */ <br/>
Time time; /* server time when event generated */ <br/>
int xkb_type; /* XkbCompatMapNotify */ <br/>
int device; /* Xkb device ID, will not be XkbUseCoreKbd */
<br/>
unsigned int changed_ctrls; /* bits indicating which
controls data have changed*/ <br/>
unsigned int enabled_ctrls; /* controls currently enabled in
server */ <br/>
unsigned int enabled_ctrl_changes; /* bits indicating
enabled/disabled controls */ <br/>
int num_groups; /* current number of keyboard groups */ <br/>
KeyCode keycode; /* != 0 =&gt; keycode of key causing change
*/ <br/>
char event_type; /* Type of event causing change */ <br/>
char req_major; /* major event code of event causing change
*/ <br/>
char req_minor; /* minor event code of event causing change
*/ <br/>
} XkbControlsNotifyEvent;</p>
<h2>DIAGNOSTICS
<a name="DIAGNOSTICS"></a>
</h2>
<table border="0" cellpadding="0" cellspacing="0" frame="void" rules="none" width="100%">
<tr align="left" valign="top">
<td width="9%"></td>
<td width="10%">
<p style="margin-top: 1em"><b>BadAlloc</b></p></td>
<td width="9%"></td>
<td width="34%">
<p style="margin-top: 1em">Unable to allocate storage</p></td>
<td width="38%">
</td></tr>
</table>
<p style="margin-left:9%;"><b>BadImplementation</b></p>
<p style="margin-left:28%;">Invalid reply from server</p>
<table border="0" cellpadding="0" cellspacing="0" frame="void" rules="none" width="100%">
<tr align="left" valign="top">
<td width="9%"></td>
<td width="10%">
<p><b>BadMatch</b></p></td>
<td width="9%"></td>
<td width="72%">
<p>A compatible version of Xkb was not available in the
server or an argument has correct type and range, but is
otherwise invalid</p></td></tr>
</table>
<h2>SEE ALSO
<a name="SEE ALSO"></a>
</h2>
<p style="margin-left:9%; margin-top: 1em"><b>XkbFreeControls</b>(3),
<b>XkbNoteControlsChanges</b>(3),
<b>XkbSelectEventDetails</b>(3),
<b>XkbSelectEvents</b>(3)</p>
<hr/>
</body>
</html>
