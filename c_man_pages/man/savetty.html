<!-- Creator     : groff version 1.23.0 -->
<!-- CreationDate: Sat Apr  5 19:50:35 2025 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">

<html>
<head>
<meta content="groff -Thtml, see www.gnu.org" name="generator"/>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<meta content="text/css" name="Content-Style"/>
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title>curs_kernel</title>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/><style>
            :root {
                --primary-color: #3498db;
                --background-color: #f9f9f9;
                --text-color: #333;
                --code-bg: #f0f0f0;
                --header-color: #2c3e50;
                --link-color: #2980b9;
            }
            body {
                font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
                line-height: 1.6;
                color: var(--text-color);
                background-color: var(--background-color);
                max-width: 900px;
                margin: 0 auto;
                padding: 2rem;
            }
            h1, h2, h3, h4 {
                color: var(--header-color);
            }
            h1 {
                border-bottom: 2px solid var(--primary-color);
                padding-bottom: 0.5rem;
            }
            pre {
                background-color: var(--code-bg);
                padding: 1rem;
                border-radius: 4px;
                overflow-x: auto;
            }
            a {
                color: var(--link-color);
                text-decoration: none;
            }
            a:hover {
                text-decoration: underline;
            }
            .man-navigation {
                background-color: #fff;
                border-bottom: 1px solid #ddd;
                padding: 0.5rem 0;
                position: sticky;
                top: 0;
                z-index: 100;
            }
            .section {
                margin-top: 2rem;
            }
            @media (prefers-color-scheme: dark) {
                :root {
                    --primary-color: #3498db;
                    --background-color: #222;
                    --text-color: #f0f0f0;
                    --code-bg: #333;
                    --header-color: #3498db;
                    --link-color: #5dade2;
                }
            }
            .back-to-index {
                display: inline-block;
                margin: 1rem 0;
                padding: 0.5rem 1rem;
                background-color: var(--primary-color);
                color: white;
                border-radius: 4px;
                text-decoration: none;
            }
            .back-to-index:hover {
                background-color: var(--link-color);
                text-decoration: none;
            }
        </style></head>
<body><div><a class="back-to-index" href="../index.html">← Back to Index</a></div>
<h1 align="center">curs_kernel</h1>
<a href="#NAME">NAME</a><br/>
<a href="#SYNOPSIS">SYNOPSIS</a><br/>
<a href="#DESCRIPTION">DESCRIPTION</a><br/>
<a href="#def_prog_mode, def_shell_mode">def_prog_mode, def_shell_mode</a><br/>
<a href="#reset_prog_mode, reset_shell_mode">reset_prog_mode, reset_shell_mode</a><br/>
<a href="#resetty, savetty">resetty, savetty</a><br/>
<a href="#getsyx">getsyx</a><br/>
<a href="#setsyx">setsyx</a><br/>
<a href="#curs_set">curs_set</a><br/>
<a href="#mvcur">mvcur</a><br/>
<a href="#napms">napms</a><br/>
<a href="#ripoffline">ripoffline</a><br/>
<a href="#RETURN VALUE">RETURN VALUE</a><br/>
<a href="#NOTES">NOTES</a><br/>
<a href="#EXTENSIONS">EXTENSIONS</a><br/>
<a href="#PORTABILITY">PORTABILITY</a><br/>
<a href="#SEE ALSO">SEE ALSO</a><br/>
<hr/>
<h2>NAME
<a name="NAME"></a>
</h2>
<p style="margin-left:9%; margin-top: 1em"><b>def_prog_mode</b>,
<b>def_shell_mode</b>, <b>reset_prog_mode</b>,
<b>reset_shell_mode</b>, <b>resetty</b>, <b>savetty</b>,
<b>getsyx</b>, <b>setsyx</b>, <b>curs_set</b>, <b>mvcur</b>,
<b>napms</b>, <b>ripoffline</b> − low-level
<i>curses</i> routines</p>
<h2>SYNOPSIS
<a name="SYNOPSIS"></a>
</h2>
<p style="margin-left:9%; margin-top: 1em"><b>#include
&lt;curses.h&gt;</b></p>
<p style="margin-left:9%; margin-top: 1em"><b>int
def_prog_mode(void); <br/>
int def_shell_mode(void);</b></p>
<p style="margin-left:9%; margin-top: 1em"><b>int
reset_prog_mode(void); <br/>
int reset_shell_mode(void);</b></p>
<p style="margin-left:9%; margin-top: 1em"><b>int
resetty(void); <br/>
int savetty(void);</b></p>
<p style="margin-left:9%; margin-top: 1em"><b>void
getsyx(int</b> <i>y</i><b>, int</b> <i>x</i><b>); <br/>
void setsyx(int</b> <i>y</i><b>, int</b>
<i>x</i><b>);</b></p>
<p style="margin-left:9%; margin-top: 1em"><b>int
curs_set(int</b> <i>visibility</i><b>); <br/>
int mvcur(int</b> <i>oldrow</i><b>, int</b>
<i>oldcol</i><b>, int</b> <i>newrow</i><b>, int</b>
<i>newcol</i><b>); <br/>
int napms(int</b> <i>ms</i><b>); <br/>
int ripoffline(int</b> <i>line</i><b>, int
(*</b><i>init</i><b>)(WINDOW *, int));</b></p>
<h2>DESCRIPTION
<a name="DESCRIPTION"></a>
</h2>
<p style="margin-left:9%; margin-top: 1em">The following
routines give low-level access to various <b>curses</b>
capabilities. These routines typically are used inside
library routines.</p>
<h3>def_prog_mode, def_shell_mode
<a name="def_prog_mode, def_shell_mode"></a>
</h3>
<p style="margin-left:9%; margin-top: 1em">The
<b>def_prog_mode</b> and <b>def_shell_mode</b> routines save
the current terminal modes as the “program” (in
<b>curses</b>) or “shell” (not in <b>curses</b>)
state for use by the <b>reset_prog_mode</b> and
<b>reset_shell_mode</b> routines. This is done automatically
by <b>initscr</b>. There is one such save area for each
screen context allocated by <b>newterm</b>.</p>
<h3>reset_prog_mode, reset_shell_mode
<a name="reset_prog_mode, reset_shell_mode"></a>
</h3>
<p style="margin-left:9%; margin-top: 1em">The
<b>reset_prog_mode</b> and <b>reset_shell_mode</b> routines
restore the terminal to “program” (in
<b>curses</b>) or “shell” (out of <b>curses</b>)
state. These are done automatically by <b>endwin</b>(3X)
and, after an <b>endwin</b>, by <b>doupdate</b>, so they
normally are not called.</p>
<h3>resetty, savetty
<a name="resetty, savetty"></a>
</h3>
<p style="margin-left:9%; margin-top: 1em">The
<b>resetty</b> and <b>savetty</b> routines save and restore
the state of the terminal modes. <b>savetty</b> saves the
current state in a buffer and <b>resetty</b> restores the
state to what it was at the last call to <b>savetty</b>.</p>
<h3>getsyx
<a name="getsyx"></a>
</h3>
<p style="margin-left:9%; margin-top: 1em"><b>getsyx</b>
stores the coordinates of virtual screen (<b>newscr</b>)
cursor in <i>y</i> and <i>x</i>. If <b>newscr</b>’s
<b>leaveok</b>(3X) output option is <b>TRUE</b>,
<b>getsyx</b> stores <b>−1</b> in both <i>y</i> and
<i>x</i>. If lines have been removed from the top of the
screen using <b>ripoffline</b>, <i>y</i> includes these
lines; therefore, <i>y</i> and <i>x</i> populated by
<b>getsyx</b> should be used only as arguments for
<b>setsyx</b>.</p>
<p style="margin-left:9%; margin-top: 1em">Few applications
use this feature; most call <b>getyx</b>(3X) instead.</p>
<h3>setsyx
<a name="setsyx"></a>
</h3>
<p style="margin-left:9%; margin-top: 1em"><b>setsyx</b>
sets the virtual screen (<b>newscr</b>) cursor location to
(<i>y</i>, <i>x</i>). <b>setsyx(−1, −1)</b> is
equivalent to <b>leaveok(newscr, TRUE)</b>.</p>
<p style="margin-left:9%; margin-top: 1em"><b>getsyx</b>
and <b>setsyx</b> are designed to be used by a function that
manipulates <i>curses</i> windows but seeks to avoid
changing the cursor position. Such a function would first
call <b>getsyx</b>, modify its windows’ content, call
<b>wnoutrefresh</b>(3X) on them, call <b>setsyx</b>, then
call <b>doupdate</b>(3X).</p>
<p style="margin-left:9%; margin-top: 1em">Few applications
use this feature; most call <b>wmove</b>(3X) instead.</p>
<h3>curs_set
<a name="curs_set"></a>
</h3>
<p style="margin-left:9%; margin-top: 1em">The
<b>curs_set</b> routine sets the cursor state to invisible,
normal, or very visible for <b>visibility</b> equal to
<b>0</b>, <b>1</b>, or <b>2</b> respectively. If the
terminal supports the <i>visibility</i> requested, the
previous <i>cursor</i> state is returned; otherwise,
<b>ERR</b> is returned.</p>
<h3>mvcur
<a name="mvcur"></a>
</h3>
<p style="margin-left:9%; margin-top: 1em"><b>mvcur</b>
provides low-level cursor motion. It takes effect
immediately, rather than at the next refresh. Unlike the
other low-level output functions, which either write to the
standard output stream or are passed a function pointer to
perform output, <b>mvcur</b> uses a file descriptor derived
from the output stream parameter of <b>newterm</b>(3X).</p>
<p style="margin-left:9%; margin-top: 1em">One application
of <b>mvcur</b> accompanies the temporary use of another
program to write to the terminal screen. For example, first
call <b>refresh</b>(3X) to ensure that the screen and the
library’s model of it is up to date; then call
<b>reset_shell_mode</b>; write to the screen with the
external application; call <b>reset_prog_mode</b>; and
finally call <b>mvcur(</b>...<b>,</b> ...<b>, −1,
−1)</b> to move the terminal cursor to where
<i>curses</i> thinks it is, since the library has no
knowledge of how the external application moved it.</p>
<h3>napms
<a name="napms"></a>
</h3>
<p style="margin-left:9%; margin-top: 1em"><b>napms</b>
sleeps for <i>ms</i> milliseconds. If <i>ms</i> exceeds
30,000 (thirty seconds), it is capped at that value.</p>
<h3>ripoffline
<a name="ripoffline"></a>
</h3>
<p style="margin-left:9%; margin-top: 1em"><b>ripoffline</b>
provides access to the same facility that
<b>slk_init</b>(3X) uses to reduce the size of the screen.
<b>ripoffline</b> must be called before <b>initscr</b> or
<b>newterm</b> is called, to prepare these initial
actions:</p>
<table border="0" cellpadding="0" cellspacing="0" frame="void" rules="none" width="100%">
<tr align="left" valign="top">
<td width="9%"></td>
<td width="1%">
<p>•</p></td>
<td width="4%"></td>
<td width="80%">
<p>If <i>line</i> is positive, a line is removed from the
top of <b>stdscr</b>.</p></td>
<td width="6%">
</td></tr>
<tr align="left" valign="top">
<td width="9%"></td>
<td width="1%">
<p>•</p></td>
<td width="4%"></td>
<td width="80%">
<p>if <i>line</i> is negative, a line is removed from the
bottom.</p> </td>
<td width="6%">
</td></tr>
</table>
<p style="margin-left:9%; margin-top: 1em">When the
resulting initialization is done inside <b>initscr</b>, the
routine <b>init</b> (supplied by the user) is called with
two arguments:</p>
<table border="0" cellpadding="0" cellspacing="0" frame="void" rules="none" width="100%">
<tr align="left" valign="top">
<td width="9%"></td>
<td width="1%">
<p style="margin-top: 1em">•</p></td>
<td width="4%"></td>
<td width="86%">
<p style="margin-top: 1em">a window pointer to the one-line
window that has been allocated and</p></td></tr>
<tr align="left" valign="top">
<td width="9%"></td>
<td width="1%">
<p>•</p></td>
<td width="4%"></td>
<td width="86%">
<p>an integer with the number of columns in the window.</p></td></tr>
</table>
<p style="margin-left:9%; margin-top: 1em">Inside this
initialization routine, the integer variables <b>LINES</b>
and <b>COLS</b> (defined in <b>&lt;curses.h&gt;</b>) are not
guaranteed to be accurate and <b>wrefresh</b> or
<b>doupdate</b> must not be called. It is allowable to call
<b>wnoutrefresh</b> during the initialization routine.</p>
<p style="margin-left:9%; margin-top: 1em"><b>ripoffline</b>
can be called up to five times before calling <b>initscr</b>
or <b>newterm</b>.</p>
<h2>RETURN VALUE
<a name="RETURN VALUE"></a>
</h2>
<p style="margin-left:9%; margin-top: 1em">Except for
<b>curs_set</b>, these routines always return <b>OK</b>.</p>
<p style="margin-left:9%; margin-top: 1em"><b>curs_set</b>
returns the previous cursor state, or <b>ERR</b> if the
requested <i>visibility</i> is not supported.</p>
<p style="margin-left:9%; margin-top: 1em">X/Open defines
no error conditions. In this implementation <b><br/>
def_prog_mode</b>, <b>def_shell_mode</b>,
<b>reset_prog_mode</b>, <b>reset_shell_mode</b></p>
<p style="margin-left:15%;">return <b>ERR</b> if the
terminal was not initialized, or if the I/O call to obtain
the terminal settings fails.</p>
<p style="margin-left:9%;"><b>ripoffline</b></p>
<p style="margin-left:15%;">returns <b>ERR</b> if the
maximum number of ripped-off lines exceeds the maximum
(5).</p>
<h2>NOTES
<a name="NOTES"></a>
</h2>
<p style="margin-left:9%; margin-top: 1em">Note that
<b>getsyx</b> is a macro, so <b>&amp;</b> is not necessary
before the variables <i>y</i> and <i>x</i>.</p>
<p style="margin-left:9%; margin-top: 1em">Older SVr4 man
pages warn that the return value of <b>curs_set</b>
“is currently incorrect”. This implementation
gets it right, but it may be unwise to count on the
correctness of the return value anywhere else.</p>
<p style="margin-left:9%; margin-top: 1em">Both
<i>ncurses</i> and SVr4 will call <b>curs_set</b> in
<b>endwin</b> if <b>curs_set</b> has been called to make the
cursor other than normal, i.e., either invisible or very
visible. There is no way for <i>ncurses</i> to determine the
initial cursor state to restore that.</p>
<h2>EXTENSIONS
<a name="EXTENSIONS"></a>
</h2>
<p style="margin-left:9%; margin-top: 1em">In
<i>ncurses</i>, <b>mvcur</b> accepts <b>−1</b> for
either or both old coordinates. This value tells
<i>ncurses</i> that the old location is unknown, and that it
must use only absolute motion, as with the
<b>cursor_address</b> (<b>cup</b>) capability, rather than
the least costly combination of absolute and relative
motion.</p>
<h2>PORTABILITY
<a name="PORTABILITY"></a>
</h2>
<p style="margin-left:9%; margin-top: 1em">Applications
employing <i>ncurses</i> extensions should condition their
use on the visibility of the <b>NCURSES_VERSION</b>
preprocessor macro.</p>
<p style="margin-left:9%; margin-top: 1em">The <i>virtual
screen</i> functions <b>setsyx</b> and <b>getsyx</b> are not
described in X/Open Curses, Issue 4. All other functions are
as described in X/Open Curses.</p>
<p style="margin-left:9%; margin-top: 1em">The SVr4
documentation describes <b>setsyx</b> and <b>getsyx</b> as
having return type int. This is misleading, as they are
macros with no documented semantics for the return
value.</p>
<p style="margin-left:9%; margin-top: 1em">X/Open Curses
notes:</p>
<p style="margin-left:18%; margin-top: 1em">“After
use of <i>mvcur</i>(), the model Curses maintains of the
state of the terminal might not match the actual state of
the terminal. An application should touch and refresh the
window before resuming conventional use of
Curses.”</p>
<p style="margin-left:9%; margin-top: 1em">Both
<i>ncurses</i> and SVr4 <i>curses</i> implement <b>mvcur</b>
using the <i>SCREEN</i> data allocated in either
<b>initscr</b>(3X) or <b>newterm</b>(3X). X/Open Curses
states that the old location must be given for <b>mvcur</b>
to accommodate terminals that lack absolute cursor
positioning.</p>
<p style="margin-left:9%; margin-top: 1em">If interrupted,
<i>ncurses</i> restarts <b>napms</b>. That, and the
limitation to 30 seconds, are different from other
implementations.</p>
<h2>SEE ALSO
<a name="SEE ALSO"></a>
</h2>
<p style="margin-left:9%; margin-top: 1em"><b>curses</b>(3X),
<b>curs_initscr</b>(3X), <b>curs_outopts</b>(3X),
<b>curs_refresh</b>(3X), <b>curs_scr_dump</b>(3X),
<b>curs_slk</b>(3X), <b>curs_variables</b>(3X)</p>
<hr/>
</body>
</html>
