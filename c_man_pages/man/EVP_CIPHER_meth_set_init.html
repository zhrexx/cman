<!-- Creator     : groff version 1.23.0 -->
<!-- CreationDate: Sat Apr  5 19:44:12 2025 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">

<html>
<head>
<meta content="groff -Thtml, see www.gnu.org" name="generator"/>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<meta content="text/css" name="Content-Style"/>
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title>EVP_CIPHER_METH_NEW</title>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/><style>
            :root {
                --primary-color: #3498db;
                --background-color: #f9f9f9;
                --text-color: #333;
                --code-bg: #f0f0f0;
                --header-color: #2c3e50;
                --link-color: #2980b9;
            }
            body {
                font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
                line-height: 1.6;
                color: var(--text-color);
                background-color: var(--background-color);
                max-width: 900px;
                margin: 0 auto;
                padding: 2rem;
            }
            h1, h2, h3, h4 {
                color: var(--header-color);
            }
            h1 {
                border-bottom: 2px solid var(--primary-color);
                padding-bottom: 0.5rem;
            }
            pre {
                background-color: var(--code-bg);
                padding: 1rem;
                border-radius: 4px;
                overflow-x: auto;
            }
            a {
                color: var(--link-color);
                text-decoration: none;
            }
            a:hover {
                text-decoration: underline;
            }
            .man-navigation {
                background-color: #fff;
                border-bottom: 1px solid #ddd;
                padding: 0.5rem 0;
                position: sticky;
                top: 0;
                z-index: 100;
            }
            .section {
                margin-top: 2rem;
            }
            @media (prefers-color-scheme: dark) {
                :root {
                    --primary-color: #3498db;
                    --background-color: #222;
                    --text-color: #f0f0f0;
                    --code-bg: #333;
                    --header-color: #3498db;
                    --link-color: #5dade2;
                }
            }
            .back-to-index {
                display: inline-block;
                margin: 1rem 0;
                padding: 0.5rem 1rem;
                background-color: var(--primary-color);
                color: white;
                border-radius: 4px;
                text-decoration: none;
            }
            .back-to-index:hover {
                background-color: var(--link-color);
                text-decoration: none;
            }
        </style></head>
<body><div><a class="back-to-index" href="../index.html">← Back to Index</a></div>
<h1 align="center">EVP_CIPHER_METH_NEW</h1>
<a href="#NAME">NAME</a><br/>
<a href="#SYNOPSIS">SYNOPSIS</a><br/>
<a href="#DESCRIPTION">DESCRIPTION</a><br/>
<a href="#RETURN VALUES">RETURN VALUES</a><br/>
<a href="#SEE ALSO">SEE ALSO</a><br/>
<a href="#HISTORY">HISTORY</a><br/>
<a href="#COPYRIGHT">COPYRIGHT</a><br/>
<hr/>
<h2>NAME
<a name="NAME"></a>
</h2>
<p style="margin-left:9%; margin-top: 1em">EVP_CIPHER_meth_new,
EVP_CIPHER_meth_dup, EVP_CIPHER_meth_free,
EVP_CIPHER_meth_set_iv_length, EVP_CIPHER_meth_set_flags,
EVP_CIPHER_meth_set_impl_ctx_size, EVP_CIPHER_meth_set_init,
EVP_CIPHER_meth_set_do_cipher, EVP_CIPHER_meth_set_cleanup,
EVP_CIPHER_meth_set_set_asn1_params,
EVP_CIPHER_meth_set_get_asn1_params,
EVP_CIPHER_meth_set_ctrl, EVP_CIPHER_meth_get_init,
EVP_CIPHER_meth_get_do_cipher, EVP_CIPHER_meth_get_cleanup,
EVP_CIPHER_meth_get_set_asn1_params,
EVP_CIPHER_meth_get_get_asn1_params,
EVP_CIPHER_meth_get_ctrl − Routines to build up
EVP_CIPHER methods</p>
<h2>SYNOPSIS
<a name="SYNOPSIS"></a>
</h2>
<p style="margin-left:9%; margin-top: 1em">#include
&lt;openssl/evp.h&gt;</p>
<p style="margin-left:9%; margin-top: 1em">The following
functions have been deprecated since OpenSSL 3.0, and can be
hidden entirely by defining <b>OPENSSL_API_COMPAT</b> with a
suitable version value, see
<b>openssl_user_macros</b>(7):</p>
<p style="margin-left:9%; margin-top: 1em">EVP_CIPHER
*EVP_CIPHER_meth_new(int cipher_type, int block_size, int
key_len); <br/>
EVP_CIPHER *EVP_CIPHER_meth_dup(const EVP_CIPHER *cipher);
<br/>
void EVP_CIPHER_meth_free(EVP_CIPHER *cipher); <br/>
int EVP_CIPHER_meth_set_iv_length(EVP_CIPHER *cipher, int
iv_len); <br/>
int EVP_CIPHER_meth_set_flags(EVP_CIPHER *cipher, unsigned
long flags); <br/>
int EVP_CIPHER_meth_set_impl_ctx_size(EVP_CIPHER *cipher,
int ctx_size); <br/>
int EVP_CIPHER_meth_set_init(EVP_CIPHER *cipher, <br/>
int (*init)(EVP_CIPHER_CTX *ctx, <br/>
const unsigned char *key, <br/>
const unsigned char *iv, <br/>
int enc)); <br/>
int EVP_CIPHER_meth_set_do_cipher(EVP_CIPHER *cipher, <br/>
int (*do_cipher)(EVP_CIPHER_CTX *ctx, <br/>
unsigned char *out, <br/>
const unsigned char *in, <br/>
size_t inl)); <br/>
int EVP_CIPHER_meth_set_cleanup(EVP_CIPHER *cipher, <br/>
int (*cleanup)(EVP_CIPHER_CTX *)); <br/>
int EVP_CIPHER_meth_set_set_asn1_params(EVP_CIPHER *cipher,
<br/>
int (*set_asn1_parameters)(EVP_CIPHER_CTX *, <br/>
ASN1_TYPE *)); <br/>
int EVP_CIPHER_meth_set_get_asn1_params(EVP_CIPHER *cipher,
<br/>
int (*get_asn1_parameters)(EVP_CIPHER_CTX *, <br/>
ASN1_TYPE *)); <br/>
int EVP_CIPHER_meth_set_ctrl(EVP_CIPHER *cipher, <br/>
int (*ctrl)(EVP_CIPHER_CTX *, int type, <br/>
int arg, void *ptr)); <br/>
int (*EVP_CIPHER_meth_get_init(const EVP_CIPHER
*cipher))(EVP_CIPHER_CTX *ctx, <br/>
const unsigned char *key, <br/>
const unsigned char *iv, <br/>
int enc); <br/>
int (*EVP_CIPHER_meth_get_do_cipher(const EVP_CIPHER
*cipher))(EVP_CIPHER_CTX *ctx, <br/>
unsigned char *out, <br/>
const unsigned char *in, <br/>
size_t inl); <br/>
int (*EVP_CIPHER_meth_get_cleanup(const EVP_CIPHER
*cipher))(EVP_CIPHER_CTX *); <br/>
int (*EVP_CIPHER_meth_get_set_asn1_params(const EVP_CIPHER
*cipher))(EVP_CIPHER_CTX *, <br/>
ASN1_TYPE *); <br/>
int (*EVP_CIPHER_meth_get_get_asn1_params(const EVP_CIPHER
*cipher))(EVP_CIPHER_CTX *, <br/>
ASN1_TYPE *); <br/>
int (*EVP_CIPHER_meth_get_ctrl(const EVP_CIPHER
*cipher))(EVP_CIPHER_CTX *, <br/>
int type, int arg, <br/>
void *ptr);</p>
<h2>DESCRIPTION
<a name="DESCRIPTION"></a>
</h2>
<p style="margin-left:9%; margin-top: 1em">All of the
functions described on this page are deprecated.
Applications should instead use the OSSL_PROVIDER APIs.</p>
<p style="margin-left:9%; margin-top: 1em">The
<b>EVP_CIPHER</b> type is a structure for symmetric cipher
method implementation.</p>
<p style="margin-left:9%; margin-top: 1em"><b>EVP_CIPHER_meth_new()</b>
creates a new <b>EVP_CIPHER</b> structure.</p>
<p style="margin-left:9%; margin-top: 1em"><b>EVP_CIPHER_meth_dup()</b>
creates a copy of <b>cipher</b>.</p>
<p style="margin-left:9%; margin-top: 1em"><b>EVP_CIPHER_meth_free()</b>
destroys a <b>EVP_CIPHER</b> structure. If the argument is
NULL, nothing is done.</p>
<p style="margin-left:9%; margin-top: 1em"><b>EVP_CIPHER_meth_set_iv_length()</b>
sets the length of the IV. This is only needed when the
implemented cipher mode requires it.</p>
<p style="margin-left:9%; margin-top: 1em"><b>EVP_CIPHER_meth_set_flags()</b>
sets the flags to describe optional behaviours in the
particular <b>cipher</b>. With the exception of cipher
modes, of which only one may be present, several flags can
be or'd together. The available flags are: <br/>
EVP_CIPH_STREAM_CIPHER, EVP_CIPH_ECB_MODE EVP_CIPH_CBC_MODE,
<br/>
EVP_CIPH_CFB_MODE, EVP_CIPH_OFB_MODE, EVP_CIPH_CTR_MODE,
<br/>
EVP_CIPH_GCM_MODE, EVP_CIPH_CCM_MODE, EVP_CIPH_XTS_MODE,
<br/>
EVP_CIPH_WRAP_MODE, EVP_CIPH_OCB_MODE, EVP_CIPH_SIV_MODE</p>
<p style="margin-left:14%;">The cipher mode.</p>
<p style="margin-left:9%;">EVP_CIPH_VARIABLE_LENGTH</p>
<p style="margin-left:14%;">This cipher is of variable
length.</p>
<p style="margin-left:9%;">EVP_CIPH_CUSTOM_IV</p>
<p style="margin-left:14%;">Storing and initialising the IV
is left entirely to the implementation.</p>
<p style="margin-left:9%;">EVP_CIPH_ALWAYS_CALL_INIT</p>
<p style="margin-left:14%;">Set this if the
implementation's <b>init()</b> function should be called
even if <b>key</b> is <b>NULL</b>.</p>
<p style="margin-left:9%;">EVP_CIPH_CTRL_INIT</p>
<p style="margin-left:14%;">Set this to have the
implementation's <b>ctrl()</b> function called with command
code <b>EVP_CTRL_INIT</b> early in its setup.</p>
<p style="margin-left:9%;">EVP_CIPH_CUSTOM_KEY_LENGTH</p>
<p style="margin-left:14%;">Checking and setting the key
length after creating the <b>EVP_CIPHER</b> is left to the
implementation. Whenever someone uses
<b>EVP_CIPHER_CTX_set_key_length()</b> on a
<b>EVP_CIPHER</b> with this flag set, the implementation's
<b>ctrl()</b> function will be called with the control code
<b>EVP_CTRL_SET_KEY_LENGTH</b> and the key length in
<b>arg</b>.</p>
<p style="margin-left:9%;">EVP_CIPH_NO_PADDING</p>
<p style="margin-left:14%;">Don't use standard block
padding.</p>
<p style="margin-left:9%;">EVP_CIPH_RAND_KEY</p>
<p style="margin-left:14%;">Making a key with random
content is left to the implementation. This is done by
calling the implementation's <b>ctrl()</b> function with the
control code <b>EVP_CTRL_RAND_KEY</b> and the pointer to the
key memory storage in <b>ptr</b>.</p>
<p style="margin-left:9%;">EVP_CIPH_CUSTOM_COPY</p>
<p style="margin-left:14%;">Set this to have the
implementation's <b>ctrl()</b> function called with command
code <b>EVP_CTRL_COPY</b> at the end of
<b>EVP_CIPHER_CTX_copy()</b>. The intended use is for
further things to deal with after the implementation
specific data block has been copied. The destination
<b>EVP_CIPHER_CTX</b> is passed to the control with the
<b>ptr</b> parameter. The implementation specific data block
is reached with <b>EVP_CIPHER_CTX_get_cipher_data()</b>.</p>
<p style="margin-left:9%;">EVP_CIPH_FLAG_DEFAULT_ASN1</p>
<p style="margin-left:14%;">Use the default EVP routines to
pass IV to and from ASN.1.</p>
<p style="margin-left:9%;">EVP_CIPH_FLAG_LENGTH_BITS</p>
<p style="margin-left:14%;">Signals that the length of the
input buffer for encryption / decryption is to be understood
as the number of bits instead of bytes for this
implementation. This is only useful for CFB1 ciphers.</p>
<p style="margin-left:9%;">EVP_CIPH_FLAG_CTS</p>
<p style="margin-left:14%;">Indicates that the cipher uses
ciphertext stealing. This is currently used to indicate that
the cipher is a one shot that only allows a single call to
<b>EVP_CipherUpdate()</b>.</p>
<p style="margin-left:9%;">EVP_CIPH_FLAG_CUSTOM_CIPHER</p>
<p style="margin-left:14%;">This indicates that the
implementation takes care of everything, including padding,
buffering and finalization. The EVP routines will simply
give them control and do nothing more.</p>
<p style="margin-left:9%;">EVP_CIPH_FLAG_AEAD_CIPHER</p>
<p style="margin-left:14%;">This indicates that this is an
AEAD cipher implementation.</p>
<p style="margin-left:9%;">EVP_CIPH_FLAG_TLS1_1_MULTIBLOCK</p>
<p style="margin-left:14%;">Allow interleaving of crypto
blocks, a particular optimization only applicable to certain
TLS ciphers.</p>
<p style="margin-left:9%; margin-top: 1em"><b>EVP_CIPHER_meth_set_impl_ctx_size()</b>
sets the size of the EVP_CIPHER's implementation context so
that it can be automatically allocated.</p>
<p style="margin-left:9%; margin-top: 1em"><b>EVP_CIPHER_meth_set_init()</b>
sets the cipher init function for <b>cipher</b>. The cipher
init function is called by <b>EVP_CipherInit()</b>,
<b>EVP_CipherInit_ex()</b>, <b>EVP_EncryptInit()</b>,
<b>EVP_EncryptInit_ex()</b>, <b>EVP_DecryptInit()</b>,
<b>EVP_DecryptInit_ex()</b>.</p>
<p style="margin-left:9%; margin-top: 1em"><b>EVP_CIPHER_meth_set_do_cipher()</b>
sets the cipher function for <b>cipher</b>. The cipher
function is called by <b>EVP_CipherUpdate()</b>,
<b>EVP_EncryptUpdate()</b>, <b>EVP_DecryptUpdate()</b>,
<b>EVP_CipherFinal()</b>, <b>EVP_EncryptFinal()</b>,
<b>EVP_EncryptFinal_ex()</b>, <b>EVP_DecryptFinal()</b> and
<b>EVP_DecryptFinal_ex()</b>.</p>
<p style="margin-left:9%; margin-top: 1em"><b>EVP_CIPHER_meth_set_cleanup()</b>
sets the function for <b>cipher</b> to do extra cleanup
before the method's private data structure is cleaned out
and freed. Note that the cleanup function is passed a
<b>EVP_CIPHER_CTX *</b>, the private data structure is then
available with <b>EVP_CIPHER_CTX_get_cipher_data()</b>. This
cleanup function is called by <b>EVP_CIPHER_CTX_reset()</b>
and <b>EVP_CIPHER_CTX_free()</b>.</p>
<p style="margin-left:9%; margin-top: 1em"><b>EVP_CIPHER_meth_set_set_asn1_params()</b>
sets the function for <b>cipher</b> to set the
AlgorithmIdentifier "parameter" based on the
passed cipher. This function is called by
<b>EVP_CIPHER_param_to_asn1()</b>.
<b>EVP_CIPHER_meth_set_get_asn1_params()</b> sets the
function for <b>cipher</b> that sets the cipher parameters
based on an ASN.1 AlgorithmIdentifier "parameter".
Both these functions are needed when there is a need for
custom data (more or other than the cipher IV). They are
called by <b>EVP_CIPHER_param_to_asn1()</b> and
<b>EVP_CIPHER_asn1_to_param()</b> respectively if
defined.</p>
<p style="margin-left:9%; margin-top: 1em"><b>EVP_CIPHER_meth_set_ctrl()</b>
sets the control function for <b>cipher</b>.</p>
<p style="margin-left:9%; margin-top: 1em"><b>EVP_CIPHER_meth_get_init()</b>,
<b>EVP_CIPHER_meth_get_do_cipher()</b>,
<b>EVP_CIPHER_meth_get_cleanup()</b>,
<b>EVP_CIPHER_meth_get_set_asn1_params()</b>,
<b>EVP_CIPHER_meth_get_get_asn1_params()</b> and
<b>EVP_CIPHER_meth_get_ctrl()</b> are all used to retrieve
the method data given with the EVP_CIPHER_meth_set_*()
functions above.</p>
<h2>RETURN VALUES
<a name="RETURN VALUES"></a>
</h2>
<p style="margin-left:9%; margin-top: 1em"><b>EVP_CIPHER_meth_new()</b>
and <b>EVP_CIPHER_meth_dup()</b> return a pointer to a newly
created <b>EVP_CIPHER</b>, or NULL on failure. All
EVP_CIPHER_meth_set_*() functions return 1. All
EVP_CIPHER_meth_get_*() functions return pointers to their
respective <b>cipher</b> function.</p>
<h2>SEE ALSO
<a name="SEE ALSO"></a>
</h2>
<p style="margin-left:9%; margin-top: 1em"><b>EVP_EncryptInit</b>(3)</p>
<h2>HISTORY
<a name="HISTORY"></a>
</h2>
<p style="margin-left:9%; margin-top: 1em">All of these
functions were deprecated in OpenSSL 3.0.</p>
<p style="margin-left:9%; margin-top: 1em">The functions
described here were added in OpenSSL 1.1.0. The
<b>EVP_CIPHER</b> structure created with these functions
became reference counted in OpenSSL 3.0.</p>
<h2>COPYRIGHT
<a name="COPYRIGHT"></a>
</h2>
<p style="margin-left:9%; margin-top: 1em">Copyright
2016−2024 The OpenSSL Project Authors. All Rights
Reserved.</p>
<p style="margin-left:9%; margin-top: 1em">Licensed under
the Apache License 2.0 (the "License"). You may
not use this file except in compliance with the License. You
can obtain a copy in the file LICENSE in the source
distribution or at
&lt;https://www.openssl.org/source/license.html&gt;.</p>
<hr/>
</body>
</html>
