<!-- Creator     : groff version 1.23.0 -->
<!-- CreationDate: Sat Apr  5 19:51:13 2025 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">

<html>
<head>
<meta content="groff -Thtml, see www.gnu.org" name="generator"/>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<meta content="text/css" name="Content-Style"/>
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title>SD_UID_GET_STATE</title>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/><style>
            :root {
                --primary-color: #3498db;
                --background-color: #f9f9f9;
                --text-color: #333;
                --code-bg: #f0f0f0;
                --header-color: #2c3e50;
                --link-color: #2980b9;
            }
            body {
                font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
                line-height: 1.6;
                color: var(--text-color);
                background-color: var(--background-color);
                max-width: 900px;
                margin: 0 auto;
                padding: 2rem;
            }
            h1, h2, h3, h4 {
                color: var(--header-color);
            }
            h1 {
                border-bottom: 2px solid var(--primary-color);
                padding-bottom: 0.5rem;
            }
            pre {
                background-color: var(--code-bg);
                padding: 1rem;
                border-radius: 4px;
                overflow-x: auto;
            }
            a {
                color: var(--link-color);
                text-decoration: none;
            }
            a:hover {
                text-decoration: underline;
            }
            .man-navigation {
                background-color: #fff;
                border-bottom: 1px solid #ddd;
                padding: 0.5rem 0;
                position: sticky;
                top: 0;
                z-index: 100;
            }
            .section {
                margin-top: 2rem;
            }
            @media (prefers-color-scheme: dark) {
                :root {
                    --primary-color: #3498db;
                    --background-color: #222;
                    --text-color: #f0f0f0;
                    --code-bg: #333;
                    --header-color: #3498db;
                    --link-color: #5dade2;
                }
            }
            .back-to-index {
                display: inline-block;
                margin: 1rem 0;
                padding: 0.5rem 1rem;
                background-color: var(--primary-color);
                color: white;
                border-radius: 4px;
                text-decoration: none;
            }
            .back-to-index:hover {
                background-color: var(--link-color);
                text-decoration: none;
            }
        </style></head>
<body><div><a class="back-to-index" href="../index.html">← Back to Index</a></div>
<h1 align="center">SD_UID_GET_STATE</h1>
<a href="#NAME">NAME</a><br/>
<a href="#SYNOPSIS">SYNOPSIS</a><br/>
<a href="#DESCRIPTION">DESCRIPTION</a><br/>
<a href="#RETURN VALUE">RETURN VALUE</a><br/>
<a href="#Errors">Errors</a><br/>
<a href="#NOTES">NOTES</a><br/>
<a href="#HISTORY">HISTORY</a><br/>
<a href="#SEE ALSO">SEE ALSO</a><br/>
<hr/>
<h2>NAME
<a name="NAME"></a>
</h2>
<p style="margin-left:9%; margin-top: 1em">sd_uid_get_state,
sd_uid_is_on_seat, sd_uid_get_sessions, sd_uid_get_seats,
sd_uid_get_display, sd_uid_get_login_time − Determine
login state of a specific Unix user ID</p>
<h2>SYNOPSIS
<a name="SYNOPSIS"></a>
</h2>
<p style="margin-left:9%; margin-top: 1em"><b>#include
&lt;systemd/sd−login.h&gt;</b></p>
<table border="0" cellpadding="0" cellspacing="0" frame="void" rules="none" width="100%">
<tr align="left" valign="top">
<td width="9%"></td>
<td width="91%">
<p style="margin-top: 1em"><b>int
sd_uid_get_state(uid_t </b><i>uid</i><b>,
char **</b><i>state</i><b>);</b></p> </td></tr>
<tr align="left" valign="top">
<td width="9%"></td>
<td width="91%">
<p style="margin-top: 1em"><b>int
sd_uid_is_on_seat(uid_t </b><i>uid</i><b>,
int </b><i>require_active</i><b>,
const char *</b><i>seat</i><b>);</b></p> </td></tr>
<tr align="left" valign="top">
<td width="9%"></td>
<td width="91%">
<p style="margin-top: 1em"><b>int
sd_uid_get_sessions(uid_t </b><i>uid</i><b>,
int </b><i>require_active</i><b>,
char ***</b><i>sessions</i><b>);</b></p> </td></tr>
<tr align="left" valign="top">
<td width="9%"></td>
<td width="91%">
<p style="margin-top: 1em"><b>int
sd_uid_get_seats(uid_t </b><i>uid</i><b>,
int </b><i>require_active</i><b>,
char ***</b><i>seats</i><b>);</b></p> </td></tr>
<tr align="left" valign="top">
<td width="9%"></td>
<td width="91%">
<p style="margin-top: 1em"><b>int
sd_uid_get_display(uid_t </b><i>uid</i><b>,
char **</b><i>session</i><b>);</b></p> </td></tr>
<tr align="left" valign="top">
<td width="9%"></td>
<td width="91%">
<p style="margin-top: 1em"><b>int
sd_uid_get_login_time(uid_t </b><i>uid</i><b>,
uint64_t *</b><i>usec</i><b>);</b></p> </td></tr>
</table>
<h2>DESCRIPTION
<a name="DESCRIPTION"></a>
</h2>
<p style="margin-left:9%; margin-top: 1em"><b>sd_uid_get_state()</b>
may be used to determine the login state of a specific Unix
user identifier. The following states are currently known:
"offline" (user not logged in at all),
"lingering" (user not logged in, but some user
services running), "online" (user logged in, but
not active, i.e. has no session in the foreground),
"active" (user logged in, and has at least one
active session, i.e. one session in the foreground),
"closing" (user not logged in, and not lingering,
but some processes are still around). In the future
additional states might be defined, client code should be
written to be robust in regards to additional state strings
being returned. The returned string needs to be freed with
the libc <b>free</b>(3) call after use.</p>
<p style="margin-left:9%; margin-top: 1em"><b>sd_uid_is_on_seat()</b>
may be used to determine whether a specific user is logged
in or active on a specific seat. Accepts a Unix user
identifier and a seat identifier string as parameters. The
<i>require_active</i> parameter is a boolean value. If
non−zero (true), this function will test if the user
is active (i.e. has a session that is in the foreground and
accepting user input) on the specified seat, otherwise
(false) only if the user is logged in (and possibly
inactive) on the specified seat.</p>
<p style="margin-left:9%; margin-top: 1em"><b>sd_uid_get_sessions()</b>
may be used to determine the current sessions of the
specified user. Accepts a Unix user identifier as parameter.
The <i>require_active</i> parameter controls whether the
returned list shall consist of only those sessions where the
user is currently active (&gt; 0), where the user is
currently online but possibly inactive (= 0), or logged in
but possibly closing the session (&lt; 0). The call returns
a <b>NULL</b> terminated string array of session identifiers
in <i>sessions</i> which needs to be freed by the caller
with the libc <b>free</b>(3) call after use, including all
the strings referenced. If the string array parameter is
passed as <b>NULL</b>, the array will not be filled in, but
the return code still indicates the number of current
sessions. Note that instead of an empty array <b>NULL</b>
may be returned and should be considered equivalent to an
empty array.</p>
<p style="margin-left:9%; margin-top: 1em">Similarly,
<b>sd_uid_get_seats()</b> may be used to determine the list
of seats on which the user currently has sessions. Similar
semantics apply, however note that the user may have
multiple sessions on the same seat as well as sessions with
no attached seat and hence the number of entries in the
returned array may differ from the one returned by
<b>sd_uid_get_sessions()</b>.</p>
<p style="margin-left:9%; margin-top: 1em"><b>sd_uid_get_display()</b>
returns the name of the "primary" session of a
user. If the user has graphical sessions, it will be the
oldest graphical session. Otherwise, it will be the oldest
open session.</p>
<p style="margin-left:9%; margin-top: 1em"><b>sd_uid_get_login_time()</b>
may be used to determine the time the user's service manager
has been invoked, which is the time when the user's first
active session, since which they stayed logged in
continuously, began. The <i>usec</i> is in microseconds
since the epoch (<b>CLOCK_REALTIME</b>). This call will fail
with <b>−ENXIO</b> if the user is not currently logged
in.</p>
<h2>RETURN VALUE
<a name="RETURN VALUE"></a>
</h2>
<p style="margin-left:9%; margin-top: 1em">On success,
<b>sd_uid_get_state()</b> and <b>sd_uid_get_login_time()</b>
returns 0 or a positive integer. If the test succeeds,
<b>sd_uid_is_on_seat()</b> returns a positive integer; if it
fails, 0. <b>sd_uid_get_sessions()</b> and
<b>sd_uid_get_seats()</b> return the number of entries in
the returned arrays. <b>sd_uid_get_display()</b> returns a
non−negative code on success. On failure, these calls
return a negative errno−style error code.</p>
<h3>Errors
<a name="Errors"></a>
</h3>
<p style="margin-left:9%; margin-top: 1em">Returned errors
may indicate the following problems:</p>
<p style="margin-left:9%; margin-top: 1em"><b>−ENODATA</b></p>
<p style="margin-left:14%;">The given field is not
specified for the described user.</p>
<p style="margin-left:9%; margin-top: 1em"><b>−ENXIO</b></p>
<p style="margin-left:14%;">The specified seat is
unknown.</p>
<p style="margin-left:9%; margin-top: 1em"><b>−EINVAL</b></p>
<p style="margin-left:14%;">An input parameter was invalid
(out of range, or <b>NULL</b>, where that is not accepted).
This is also returned if the passed user ID is <b>0xFFFF</b>
or <b>0xFFFFFFFF</b>, which are undefined on Linux.</p>
<p style="margin-left:9%; margin-top: 1em"><b>−ENOMEM</b></p>
<p style="margin-left:14%;">Memory allocation failed.</p>
<h2>NOTES
<a name="NOTES"></a>
</h2>
<p style="margin-left:9%; margin-top: 1em">Functions
described here are available as a shared library, which can
be compiled against and linked to with the
<b>libsystemd pkg-config</b>(1) file.</p>
<p style="margin-left:9%; margin-top: 1em">The code
described here uses <b>getenv</b>(3), which is declared to
be not multi−thread−safe. This means that the
code calling the functions described here must not call
<b>setenv</b>(3) from a parallel thread. It is recommended
to only do calls to <b>setenv()</b> from an early phase of
the program when no other threads have been started.</p>
<h2>HISTORY
<a name="HISTORY"></a>
</h2>
<p style="margin-left:9%; margin-top: 1em"><b>sd_uid_get_display()</b>
was added in version 213.</p>
<p style="margin-left:9%; margin-top: 1em"><b>sd_uid_get_login_time()</b>
was added in version 254.</p>
<h2>SEE ALSO
<a name="SEE ALSO"></a>
</h2>
<p style="margin-left:9%; margin-top: 1em"><b>systemd</b>(1),
<b>sd-login</b>(3), <b>sd_pid_get_owner_uid</b>(3)</p>
<hr/>
</body>
</html>
