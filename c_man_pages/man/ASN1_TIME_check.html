<!-- Creator     : groff version 1.23.0 -->
<!-- CreationDate: Sat Apr  5 20:39:24 2025 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">

<html>
<head>
<meta content="groff -Thtml, see www.gnu.org" name="generator"/>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<meta content="text/css" name="Content-Style"/>
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title>ASN1_TIME_SET</title>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/><style>
            :root {
                --primary-color: #3498db;
                --background-color: #f9f9f9;
                --text-color: #333;
                --code-bg: #f0f0f0;
                --header-color: #2c3e50;
                --link-color: #2980b9;
            }
            body {
                font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
                line-height: 1.6;
                color: var(--text-color);
                background-color: var(--background-color);
                max-width: 900px;
                margin: 0 auto;
                padding: 2rem;
            }
            h1, h2, h3, h4 {
                color: var(--header-color);
            }
            h1 {
                border-bottom: 2px solid var(--primary-color);
                padding-bottom: 0.5rem;
            }
            pre {
                background-color: var(--code-bg);
                padding: 1rem;
                border-radius: 4px;
                overflow-x: auto;
            }
            a {
                color: var(--link-color);
                text-decoration: none;
            }
            a:hover {
                text-decoration: underline;
            }
            .man-navigation {
                background-color: #fff;
                border-bottom: 1px solid #ddd;
                padding: 0.5rem 0;
                position: sticky;
                top: 0;
                z-index: 100;
            }
            .section {
                margin-top: 2rem;
            }
            @media (prefers-color-scheme: dark) {
                :root {
                    --primary-color: #3498db;
                    --background-color: #222;
                    --text-color: #f0f0f0;
                    --code-bg: #333;
                    --header-color: #3498db;
                    --link-color: #5dade2;
                }
            }
            .back-to-index {
                display: inline-block;
                margin: 1rem 0;
                padding: 0.5rem 1rem;
                background-color: var(--primary-color);
                color: white;
                border-radius: 4px;
                text-decoration: none;
            }
            .back-to-index:hover {
                background-color: var(--link-color);
                text-decoration: none;
            }
        </style></head>
<body><div><a class="back-to-index" href="../index.html">← Back to Index</a></div>
<h1 align="center">ASN1_TIME_SET</h1>
<a href="#NAME">NAME</a><br/>
<a href="#SYNOPSIS">SYNOPSIS</a><br/>
<a href="#DESCRIPTION">DESCRIPTION</a><br/>
<a href="#NOTES">NOTES</a><br/>
<a href="#BUGS">BUGS</a><br/>
<a href="#RETURN VALUES">RETURN VALUES</a><br/>
<a href="#EXAMPLES">EXAMPLES</a><br/>
<a href="#HISTORY">HISTORY</a><br/>
<a href="#COPYRIGHT">COPYRIGHT</a><br/>
<hr/>
<h2>NAME
<a name="NAME"></a>
</h2>
<p style="margin-left:9%; margin-top: 1em">ASN1_TIME_set,
ASN1_UTCTIME_set, ASN1_GENERALIZEDTIME_set, ASN1_TIME_adj,
ASN1_UTCTIME_adj, ASN1_GENERALIZEDTIME_adj, ASN1_TIME_check,
ASN1_UTCTIME_check, ASN1_GENERALIZEDTIME_check,
ASN1_TIME_set_string, ASN1_UTCTIME_set_string,
ASN1_GENERALIZEDTIME_set_string, ASN1_TIME_set_string_X509,
ASN1_TIME_normalize, ASN1_TIME_to_tm, ASN1_TIME_print,
ASN1_TIME_print_ex, ASN1_UTCTIME_print,
ASN1_GENERALIZEDTIME_print, ASN1_TIME_diff,
ASN1_TIME_cmp_time_t, ASN1_UTCTIME_cmp_time_t,
ASN1_TIME_compare, ASN1_TIME_to_generalizedtime,
ASN1_TIME_dup, ASN1_UTCTIME_dup, ASN1_GENERALIZEDTIME_dup
− ASN.1 Time functions</p>
<h2>SYNOPSIS
<a name="SYNOPSIS"></a>
</h2>
<p style="margin-left:9%; margin-top: 1em">ASN1_TIME
*ASN1_TIME_set(ASN1_TIME *s, time_t t); <br/>
ASN1_UTCTIME *ASN1_UTCTIME_set(ASN1_UTCTIME *s, time_t t);
<br/>
ASN1_GENERALIZEDTIME
*ASN1_GENERALIZEDTIME_set(ASN1_GENERALIZEDTIME *s, <br/>
time_t t); <br/>
ASN1_TIME *ASN1_TIME_adj(ASN1_TIME *s, time_t t, int
offset_day, <br/>
long offset_sec); <br/>
ASN1_UTCTIME *ASN1_UTCTIME_adj(ASN1_UTCTIME *s, time_t t,
<br/>
int offset_day, long offset_sec); <br/>
ASN1_GENERALIZEDTIME
*ASN1_GENERALIZEDTIME_adj(ASN1_GENERALIZEDTIME *s, <br/>
time_t t, int offset_day, <br/>
long offset_sec); <br/>
int ASN1_TIME_set_string(ASN1_TIME *s, const char *str);
<br/>
int ASN1_TIME_set_string_X509(ASN1_TIME *s, const char
*str); <br/>
int ASN1_UTCTIME_set_string(ASN1_UTCTIME *s, const char
*str); <br/>
int ASN1_GENERALIZEDTIME_set_string(ASN1_GENERALIZEDTIME *s,
<br/>
const char *str); <br/>
int ASN1_TIME_normalize(ASN1_TIME *s); <br/>
int ASN1_TIME_check(const ASN1_TIME *t); <br/>
int ASN1_UTCTIME_check(const ASN1_UTCTIME *t); <br/>
int ASN1_GENERALIZEDTIME_check(const ASN1_GENERALIZEDTIME
*t); <br/>
int ASN1_TIME_print(BIO *b, const ASN1_TIME *s); <br/>
int ASN1_TIME_print_ex(BIO *bp, const ASN1_TIME *tm,
unsigned long flags); <br/>
int ASN1_UTCTIME_print(BIO *b, const ASN1_UTCTIME *s); <br/>
int ASN1_GENERALIZEDTIME_print(BIO *b, const
ASN1_GENERALIZEDTIME *s); <br/>
int ASN1_TIME_to_tm(const ASN1_TIME *s, struct tm *tm); <br/>
int ASN1_TIME_diff(int *pday, int *psec, const ASN1_TIME
*from, <br/>
const ASN1_TIME *to); <br/>
int ASN1_TIME_cmp_time_t(const ASN1_TIME *s, time_t t); <br/>
int ASN1_UTCTIME_cmp_time_t(const ASN1_UTCTIME *s, time_t
t); <br/>
int ASN1_TIME_compare(const ASN1_TIME *a, const ASN1_TIME
*b); <br/>
ASN1_GENERALIZEDTIME *ASN1_TIME_to_generalizedtime(ASN1_TIME
*t, <br/>
ASN1_GENERALIZEDTIME **out); <br/>
ASN1_TIME *ASN1_TIME_dup(const ASN1_TIME *t); <br/>
ASN1_UTCTIME *ASN1_UTCTIME_dup(const ASN1_UTCTIME *t); <br/>
ASN1_GENERALIZEDTIME *ASN1_GENERALIZEDTIME_dup(const
ASN1_GENERALIZEDTIME *t);</p>
<h2>DESCRIPTION
<a name="DESCRIPTION"></a>
</h2>
<p style="margin-left:9%; margin-top: 1em">The
<b>ASN1_TIME_set()</b>, <b>ASN1_UTCTIME_set()</b> and
<b>ASN1_GENERALIZEDTIME_set()</b> functions set the
structure <i>s</i> to the time represented by the time_t
value <i>t</i>. If <i>s</i> is NULL a new time structure is
allocated and returned.</p>
<p style="margin-left:9%; margin-top: 1em">The
<b>ASN1_TIME_adj()</b>, <b>ASN1_UTCTIME_adj()</b> and
<b>ASN1_GENERALIZEDTIME_adj()</b> functions set the time
structure <i>s</i> to the time represented by the time
<i>offset_day</i> and <i>offset_sec</i> after the time_t
value <i>t</i>. The values of <i>offset_day</i> or
<i>offset_sec</i> can be negative to set a time before
<i>t</i>. The <i>offset_sec</i> value can also exceed the
number of seconds in a day. If <i>s</i> is NULL a new
structure is allocated and returned.</p>
<p style="margin-left:9%; margin-top: 1em">The
<b>ASN1_TIME_set_string()</b>,
<b>ASN1_UTCTIME_set_string()</b> and
<b>ASN1_GENERALIZEDTIME_set_string()</b> functions set the
time structure <i>s</i> to the time represented by string
<i>str</i> which must be in appropriate ASN.1 time format
(for example YYMMDDHHMMSSZ or YYYYMMDDHHMMSSZ). If <i>s</i>
is NULL this function performs a format check on <i>str</i>
only. The string <i>str</i> is copied into <i>s</i>.</p>
<p style="margin-left:9%; margin-top: 1em"><b>ASN1_TIME_set_string_X509()</b>
sets <b>ASN1_TIME</b> structure <i>s</i> to the time
represented by string <i>str</i> which must be in
appropriate time format that RFC 5280 requires, which means
it only allows YYMMDDHHMMSSZ and YYYYMMDDHHMMSSZ (leap
second is rejected), all other ASN.1 time format are not
allowed. If <i>s</i> is NULL this function performs a format
check on <i>str</i> only.</p>
<p style="margin-left:9%; margin-top: 1em">The
<b>ASN1_TIME_normalize()</b> function converts an
<b>ASN1_GENERALIZEDTIME</b> or <b>ASN1_UTCTIME</b> into a
time value that can be used in a certificate. It should be
used after the <b>ASN1_TIME_set_string()</b> functions and
before <b>ASN1_TIME_print()</b> functions to get consistent
(i.e. GMT) results.</p>
<p style="margin-left:9%; margin-top: 1em">The
<b>ASN1_TIME_check()</b>, <b>ASN1_UTCTIME_check()</b> and
<b>ASN1_GENERALIZEDTIME_check()</b> functions check the
syntax of the time structure <i>s</i>.</p>
<p style="margin-left:9%; margin-top: 1em">The
<b>ASN1_TIME_print()</b>, <b>ASN1_UTCTIME_print()</b> and
<b>ASN1_GENERALIZEDTIME_print()</b> functions print the time
structure <i>s</i> to BIO <i>b</i> in human readable format.
It will be of the format MMM DD HH:MM:SS[.s*] YYYY GMT, for
example "Feb 3 00:55:52 2015 GMT", which does not
include a newline. If the time structure has invalid format
it prints out "Bad time value" and returns an
error. The output for generalized time may include a
fractional part following the second.</p>
<p style="margin-left:9%; margin-top: 1em"><b>ASN1_TIME_print_ex()</b>
provides <i>flags</i> to specify the output format of the
datetime. This can be either <b>ASN1_DTFLGS_RFC822</b> or
<b>ASN1_DTFLGS_ISO8601</b>.</p>
<p style="margin-left:9%; margin-top: 1em"><b>ASN1_TIME_to_tm()</b>
converts the time <i>s</i> to the standard <i>tm</i>
structure. If <i>s</i> is NULL, then the current time is
converted. The output time is GMT. The <i>tm_sec</i>,
<i>tm_min</i>, <i>tm_hour</i>, <i>tm_mday</i>,
<i>tm_wday</i>, <i>tm_yday</i>, <i>tm_mon</i> and
<i>tm_year</i> fields of <i>tm</i> structure are set to
proper values, whereas all other fields are set to 0. If
<i>tm</i> is NULL this function performs a format check on
<i>s</i> only. If <i>s</i> is in Generalized format with
fractional seconds, e.g. YYYYMMDDHHMMSS.SSSZ, the fractional
seconds will be lost while converting <i>s</i> to <i>tm</i>
structure.</p>
<p style="margin-left:9%; margin-top: 1em"><b>ASN1_TIME_diff()</b>
sets <i>*pday</i> and <i>*psec</i> to the time difference
between <i>from</i> and <i>to</i>. If <i>to</i> represents a
time later than <i>from</i> then one or both (depending on
the time difference) of <i>*pday</i> and <i>*psec</i> will
be positive. If <i>to</i> represents a time earlier than
<i>from</i> then one or both of <i>*pday</i> and
<i>*psec</i> will be negative. If <i>to</i> and <i>from</i>
represent the same time then <i>*pday</i> and <i>*psec</i>
will both be zero. If both <i>*pday</i> and <i>*psec</i> are
nonzero they will always have the same sign. The value of
<i>*psec</i> will always be less than the number of seconds
in a day. If <i>from</i> or <i>to</i> is NULL the current
time is used.</p>
<p style="margin-left:9%; margin-top: 1em">The
<b>ASN1_TIME_cmp_time_t()</b> and
<b>ASN1_UTCTIME_cmp_time_t()</b> functions compare the two
times represented by the time structure <i>s</i> and the
time_t <i>t</i>.</p>
<p style="margin-left:9%; margin-top: 1em">The
<b>ASN1_TIME_compare()</b> function compares the two times
represented by the time structures <i>a</i> and
<i>b</i>.</p>
<p style="margin-left:9%; margin-top: 1em">The
<b>ASN1_TIME_to_generalizedtime()</b> function converts an
<b>ASN1_TIME</b> to an <b>ASN1_GENERALIZEDTIME</b>,
regardless of year. If either <i>out</i> or <i>*out</i> are
NULL, then a new object is allocated and must be freed after
use.</p>
<p style="margin-left:9%; margin-top: 1em">The
<b>ASN1_TIME_dup()</b>, <b>ASN1_UTCTIME_dup()</b> and
<b>ASN1_GENERALIZEDTIME_dup()</b> functions duplicate the
time structure <i>t</i> and return the duplicated result
correspondingly.</p>
<h2>NOTES
<a name="NOTES"></a>
</h2>
<p style="margin-left:9%; margin-top: 1em">The
<b>ASN1_TIME</b> structure corresponds to the ASN.1
structure <b>Time</b> defined in RFC5280 et al. The time
setting functions obey the rules outlined in RFC5280: if the
date can be represented by UTCTime it is used, else
GeneralizedTime is used.</p>
<p style="margin-left:9%; margin-top: 1em">The
<b>ASN1_TIME</b>, <b>ASN1_UTCTIME</b> and
<b>ASN1_GENERALIZEDTIME</b> structures are represented as an
<b>ASN1_STRING</b> internally and can be freed up using
<b>ASN1_STRING_free()</b>.</p>
<p style="margin-left:9%; margin-top: 1em">The
<b>ASN1_TIME</b> structure can represent years from 0000 to
9999 but no attempt is made to correct ancient calendar
changes (for example from Julian to Gregorian
calendars).</p>
<p style="margin-left:9%; margin-top: 1em"><b>ASN1_UTCTIME</b>
is limited to a year range of 1950 through 2049.</p>
<p style="margin-left:9%; margin-top: 1em">Some
applications add offset times directly to a time_t value and
pass the results to <b>ASN1_TIME_set()</b> (or equivalent).
This can cause problems as the time_t value can overflow on
some systems resulting in unexpected results. New
applications should use <b>ASN1_TIME_adj()</b> instead and
pass the offset value in the <i>offset_sec</i> and
<i>offset_day</i> parameters instead of directly
manipulating a time_t value.</p>
<p style="margin-left:9%; margin-top: 1em"><b>ASN1_TIME_adj()</b>
may change the type from <b>ASN1_GENERALIZEDTIME</b> to
<b>ASN1_UTCTIME</b>, or vice versa, based on the resulting
year. <b>ASN1_GENERALIZEDTIME_adj()</b> and
<b>ASN1_UTCTIME_adj()</b> will not modify the type of the
return structure.</p>
<p style="margin-left:9%; margin-top: 1em">It is
recommended that functions starting with <b>ASN1_TIME</b> be
used instead of those starting with <b>ASN1_UTCTIME</b> or
<b>ASN1_GENERALIZEDTIME</b>. The functions starting with
<b>ASN1_UTCTIME</b> and <b>ASN1_GENERALIZEDTIME</b> act only
on that specific time format. The functions starting with
<b>ASN1_TIME</b> will operate on either format.</p>
<p style="margin-left:9%; margin-top: 1em">Users familiar
with RFC822 should note that when specifying the flag
<b>ASN1_DTFLGS_RFC822</b> the year will be formatted as
documented above, i.e., using 4 digits, not 2 as specified
in RFC822.</p>
<h2>BUGS
<a name="BUGS"></a>
</h2>
<p style="margin-left:9%; margin-top: 1em"><b>ASN1_TIME_print()</b>,
<b>ASN1_UTCTIME_print()</b> and
<b>ASN1_GENERALIZEDTIME_print()</b> do not print out the
timezone: it either prints out "GMT" or nothing.
But all certificates complying with RFC5280 et al use GMT
anyway.</p>
<p style="margin-left:9%; margin-top: 1em"><b>ASN1_TIME_print()</b>,
<b>ASN1_TIME_print_ex()</b>, <b>ASN1_UTCTIME_print()</b> and
<b>ASN1_GENERALIZEDTIME_print()</b> do not distinguish if
they fail because of an I/O error or invalid time
format.</p>
<p style="margin-left:9%; margin-top: 1em">Use the
<b>ASN1_TIME_normalize()</b> function to normalize the time
value before printing to get GMT results.</p>
<h2>RETURN VALUES
<a name="RETURN VALUES"></a>
</h2>
<p style="margin-left:9%; margin-top: 1em"><b>ASN1_TIME_set()</b>,
<b>ASN1_UTCTIME_set()</b>,
<b>ASN1_GENERALIZEDTIME_set()</b>, <b>ASN1_TIME_adj()</b>,
<b>ASN1_UTCTIME_adj()</b> and
<b>ASN1_GENERALIZEDTIME_set()</b> return a pointer to a time
structure or NULL if an error occurred.</p>
<p style="margin-left:9%; margin-top: 1em"><b>ASN1_TIME_set_string()</b>,
<b>ASN1_UTCTIME_set_string()</b>,
<b>ASN1_GENERALIZEDTIME_set_string()</b> and
<b>ASN1_TIME_set_string_X509()</b> return 1 if the time
value is successfully set and 0 otherwise.</p>
<p style="margin-left:9%; margin-top: 1em"><b>ASN1_TIME_normalize()</b>
returns 1 on success, and 0 on error.</p>
<p style="margin-left:9%; margin-top: 1em"><b>ASN1_TIME_check()</b>,
ASN1_UTCTIME_check and <b>ASN1_GENERALIZEDTIME_check()</b>
return 1 if the structure is syntactically correct and 0
otherwise.</p>
<p style="margin-left:9%; margin-top: 1em"><b>ASN1_TIME_print()</b>,
<b>ASN1_UTCTIME_print()</b> and
<b>ASN1_GENERALIZEDTIME_print()</b> return 1 if the time is
successfully printed out and 0 if an I/O error occurred an
error occurred (I/O error or invalid time format).</p>
<p style="margin-left:9%; margin-top: 1em"><b>ASN1_TIME_to_tm()</b>
returns 1 if the time is successfully parsed and 0 if an
error occurred (invalid time format).</p>
<p style="margin-left:9%; margin-top: 1em"><b>ASN1_TIME_diff()</b>
returns 1 for success and 0 for failure. It can fail if the
passed−in time structure has invalid syntax, for
example.</p>
<p style="margin-left:9%; margin-top: 1em"><b>ASN1_TIME_cmp_time_t()</b>
and <b>ASN1_UTCTIME_cmp_time_t()</b> return −1 if
<i>s</i> is before <i>t</i>, 0 if <i>s</i> equals <i>t</i>,
or 1 if <i>s</i> is after <i>t</i>. −2 is returned on
error.</p>
<p style="margin-left:9%; margin-top: 1em"><b>ASN1_TIME_compare()</b>
returns −1 if <i>a</i> is before <i>b</i>, 0 if
<i>a</i> equals <i>b</i>, or 1 if <i>a</i> is after
<i>b</i>. −2 is returned on error.</p>
<p style="margin-left:9%; margin-top: 1em"><b>ASN1_TIME_to_generalizedtime()</b>
returns a pointer to the appropriate time structure on
success or NULL if an error occurred.</p>
<p style="margin-left:9%; margin-top: 1em"><b>ASN1_TIME_dup()</b>,
<b>ASN1_UTCTIME_dup()</b> and
<b>ASN1_GENERALIZEDTIME_dup()</b> return a pointer to a time
structure or NULL if an error occurred.</p>
<h2>EXAMPLES
<a name="EXAMPLES"></a>
</h2>
<p style="margin-left:9%; margin-top: 1em">Set a time
structure to one hour after the current time and print it
out:</p>
<p style="margin-left:9%; margin-top: 1em">#include
&lt;time.h&gt; <br/>
#include &lt;openssl/asn1.h&gt; <br/>
ASN1_TIME *tm; <br/>
time_t t; <br/>
BIO *b; <br/>
t = time(NULL); <br/>
tm = ASN1_TIME_adj(NULL, t, 0, 60 * 60); <br/>
b = BIO_new_fp(stdout, BIO_NOCLOSE); <br/>
ASN1_TIME_print(b, tm); <br/>
ASN1_STRING_free(tm); <br/>
BIO_free(b);</p>
<p style="margin-left:9%; margin-top: 1em">Determine if one
time is later or sooner than the current time:</p>
<p style="margin-left:9%; margin-top: 1em">int day, sec;
<br/>
if (!ASN1_TIME_diff(&amp;day, &amp;sec, NULL, to)) <br/>
/* Invalid time format */ <br/>
if (day &gt; 0 || sec &gt; 0) <br/>
printf("Later\n"); <br/>
else if (day &lt; 0 || sec &lt; 0) <br/>
printf("Sooner\n"); <br/>
else <br/>
printf("Same\n");</p>
<h2>HISTORY
<a name="HISTORY"></a>
</h2>
<p style="margin-left:9%; margin-top: 1em">The
<b>ASN1_TIME_to_tm()</b> function was added in OpenSSL
1.1.1. The <b>ASN1_TIME_set_string_X509()</b> function was
added in OpenSSL 1.1.1. The <b>ASN1_TIME_normalize()</b>
function was added in OpenSSL 1.1.1. The
<b>ASN1_TIME_cmp_time_t()</b> function was added in OpenSSL
1.1.1. The <b>ASN1_TIME_compare()</b> function was added in
OpenSSL 1.1.1.</p>
<h2>COPYRIGHT
<a name="COPYRIGHT"></a>
</h2>
<p style="margin-left:9%; margin-top: 1em">Copyright
2015−2025 The OpenSSL Project Authors. All Rights
Reserved.</p>
<p style="margin-left:9%; margin-top: 1em">Licensed under
the Apache License 2.0 (the "License"). You may
not use this file except in compliance with the License. You
can obtain a copy in the file LICENSE in the source
distribution or at
&lt;https://www.openssl.org/source/license.html&gt;.</p>
<hr/>
</body>
</html>
